<Type Name="MessageQueue" FullName="System.Messaging.MessageQueue">
  <Metadata><Meta Name="ms.openlocfilehash" Value="750ce98d3a2cf96c76135a62518a97dbed5ff325" /><Meta Name="ms.sourcegitcommit" Value="bac13a81377b1c4ebf3990e3287a6f1700f73751" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="ru-RU" /><Meta Name="ms.lasthandoff" Value="03/19/2019" /><Meta Name="ms.locfileid" Value="57929066" /></Metadata><TypeSignature Language="C#" Value="public class MessageQueue : System.ComponentModel.Component, System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" />
  <TypeSignature Language="DocId" Value="T:System.Messaging.MessageQueue" />
  <TypeSignature Language="VB.NET" Value="Public Class MessageQueue&#xA;Inherits Component&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class MessageQueue : System::ComponentModel::Component, System::Collections::IEnumerable" />
  <TypeSignature Language="F#" Value="type MessageQueue = class&#xA;    inherit Component&#xA;    interface IEnumerable" />
  <AssemblyInfo>
    <AssemblyName>System.Messaging</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.DefaultEvent("ReceiveCompleted")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Messaging.MessageQueueInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageQueueConverter))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.MessageQueueInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
      <AttributeName>System.Messaging.MessagingDescription("MessageQueueDesc")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="37b16-101">Предоставляет доступ к очереди на сервере MSMQ.</span><span class="sxs-lookup"><span data-stu-id="37b16-101">Provides access to a queue on a Message Queuing server.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-102">Технология очереди сообщений позволяет приложениям, которые запускаются в разное время взаимодействовать через неоднородные сети и системы, которые могут быть временно недоступны.</span><span class="sxs-lookup"><span data-stu-id="37b16-102">The Message Queuing technology allows applications running at different times to communicate across heterogeneous networks and systems that might be temporarily offline.</span></span> <span data-ttu-id="37b16-103">Приложения отправки, получения или просматривать (считывать без удаления) сообщения из очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-103">Applications send, receive, or peek (read without removing) messages from queues.</span></span> <span data-ttu-id="37b16-104">Служба очереди сообщений является дополнительным компонентом [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] и Windows NT и должны устанавливаться отдельно.</span><span class="sxs-lookup"><span data-stu-id="37b16-104">Message Queuing is an optional component of [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] and Windows NT, and must be installed separately.</span></span>  
  
 <span data-ttu-id="37b16-105"><xref:System.Messaging.MessageQueue> Класс является оболочкой вокруг очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-105">The <xref:System.Messaging.MessageQueue> class is a wrapper around Message Queuing.</span></span> <span data-ttu-id="37b16-106">Существует несколько версий очереди сообщений и с использованием <xref:System.Messaging.MessageQueue> класса может привести к немного по-разному, в зависимости от операционной системы вы используете.</span><span class="sxs-lookup"><span data-stu-id="37b16-106">There are multiple versions of Message Queuing, and using the <xref:System.Messaging.MessageQueue> class can result in slightly different behavior, depending on the operating system you are using.</span></span> <span data-ttu-id="37b16-107">Дополнительные сведения о конкретных функциях каждую версию очереди сообщений см. в разделе, «Новые возможности в очередь сообщений» Platform SDK в MSDN.</span><span class="sxs-lookup"><span data-stu-id="37b16-107">For information about specific features of each version of Message Queuing, see the topic "What's New in Message Queuing" in the Platform SDK in MSDN.</span></span>  
  
 <span data-ttu-id="37b16-108"><xref:System.Messaging.MessageQueue> Класс предоставляет ссылку на очередь MSMQ.</span><span class="sxs-lookup"><span data-stu-id="37b16-108">The <xref:System.Messaging.MessageQueue> class provides a reference to a Message Queuing queue.</span></span> <span data-ttu-id="37b16-109">Можно указать путь в <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор для подключения к существующему ресурсу, или можно создать новую очередь на сервере.</span><span class="sxs-lookup"><span data-stu-id="37b16-109">You can specify a path in the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor to connect to an existing resource, or you can create a new queue on the server.</span></span> <span data-ttu-id="37b16-110">Перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, или <xref:System.Messaging.MessageQueue.Receive%2A>, необходимо связать новый экземпляр <xref:System.Messaging.MessageQueue> класса существующую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-110">Before you can call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, you must associate the new instance of the <xref:System.Messaging.MessageQueue> class with an existing queue.</span></span> <span data-ttu-id="37b16-111">На этом этапе можно изменить свойства очереди, такие как <xref:System.Messaging.MessageQueue.Category%2A> и <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-111">At that point, you can manipulate the queue properties such as <xref:System.Messaging.MessageQueue.Category%2A> and <xref:System.Messaging.MessageQueue.Label%2A>.</span></span>  
  
 <span data-ttu-id="37b16-112"><xref:System.Messaging.MessageQueue> поддерживает два типа методов извлечения сообщений: синхронные и асинхронные.</span><span class="sxs-lookup"><span data-stu-id="37b16-112"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="37b16-113">Синхронные методы, <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.Receive%2A>, поток процесса ожидания указанный интервал времени для нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-113">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-114">Асинхронные методы, <xref:System.Messaging.MessageQueue.BeginPeek%2A> и <xref:System.Messaging.MessageQueue.BeginReceive%2A>, задачи основного приложения продолжают выполняться в отдельном потоке, до получения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-114">The asynchronous methods, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A>, allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span> <span data-ttu-id="37b16-115">Эти методы работают с помощью объектов ответного вызова и состояние объектов для передачи данных между потоками.</span><span class="sxs-lookup"><span data-stu-id="37b16-115">These methods work by using callback objects and state objects to communicate information between threads.</span></span>  
  
 <span data-ttu-id="37b16-116">При создании нового экземпляра <xref:System.Messaging.MessageQueue> класс, вы не создаете новую очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-116">When you create a new instance of the <xref:System.Messaging.MessageQueue> class, you are not creating a new Message Queuing queue.</span></span> <span data-ttu-id="37b16-117">Вместо этого можно использовать <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, и <xref:System.Messaging.MessageQueue.Purge%2A> методы для управления очередями на сервере.</span><span class="sxs-lookup"><span data-stu-id="37b16-117">Instead, you can use the <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, and <xref:System.Messaging.MessageQueue.Purge%2A> methods to manage queues on the server.</span></span>  
  
 <span data-ttu-id="37b16-118">В отличие от <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> и <xref:System.Messaging.MessageQueue.Delete%28System.String%29> являются `static` членами, поэтому их можно вызывать, не создавая новый экземпляр <xref:System.Messaging.MessageQueue> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-118">Unlike <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> and <xref:System.Messaging.MessageQueue.Delete%28System.String%29> are `static` members, so you can call them without creating a new instance of the <xref:System.Messaging.MessageQueue> class.</span></span>  
  
 <span data-ttu-id="37b16-119">Можно задать <xref:System.Messaging.MessageQueue> объекта <xref:System.Messaging.MessageQueue.Path%2A> свойство с одним из трех имен: понятное имя, <xref:System.Messaging.MessageQueue.FormatName%2A>, или <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-119">You can set the <xref:System.Messaging.MessageQueue> object's <xref:System.Messaging.MessageQueue.Path%2A> property with one of three names: the friendly name, the <xref:System.Messaging.MessageQueue.FormatName%2A>, or the <xref:System.Messaging.MessageQueue.Label%2A>.</span></span> <span data-ttu-id="37b16-120">Понятное имя, которое определяется очереди <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A> свойства, является <xref:System.Messaging.MessageQueue.MachineName%2A> \\ <xref:System.Messaging.MessageQueue.QueueName%2A> для общей очереди, и <xref:System.Messaging.MessageQueue.MachineName%2A> \\ `Private$` \\ <xref:System.Messaging.MessageQueue.QueueName%2A> для частной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-120">The friendly name, which is defined by the queue's <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties, is <xref:System.Messaging.MessageQueue.MachineName%2A>\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a public queue, and <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a private queue.</span></span> <span data-ttu-id="37b16-121"><xref:System.Messaging.MessageQueue.FormatName%2A> Свойство предоставляет доступ к очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-121">The <xref:System.Messaging.MessageQueue.FormatName%2A> property allows offline access to message queues.</span></span> <span data-ttu-id="37b16-122">Наконец, вы можете использовать очередь <xref:System.Messaging.MessageQueue.Label%2A> свойство для задания в очередь <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-122">Lastly, you can use the queue's <xref:System.Messaging.MessageQueue.Label%2A> property to set the queue's <xref:System.Messaging.MessageQueue.Path%2A>.</span></span>  
  
 <span data-ttu-id="37b16-123">Список начальных значений свойств для экземпляра <xref:System.Messaging.MessageQueue>, см. в разделе <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор.</span><span class="sxs-lookup"><span data-stu-id="37b16-123">For a list of initial property values for an instance of <xref:System.Messaging.MessageQueue>, see the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="37b16-124">В следующем примере кода создает новые <xref:System.Messaging.MessageQueue> объекты с различными типами синтаксис имени пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-124">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="37b16-125">В каждом случае он отправляет сообщение в очередь, чей путь, определенный в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="37b16-125">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 <span data-ttu-id="37b16-126">В следующем примере кода отправляет сообщение в очередь и получает сообщение из очереди, с помощью конкретного приложения класс с именем `Order`.</span><span class="sxs-lookup"><span data-stu-id="37b16-126">The following code example sends a message to a queue, and receives a message from a queue, using an application-specific class called `Order`.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
    </remarks>
    <threadsafe><span data-ttu-id="37b16-127">Только <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> метод является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-127">Only the <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> method is thread safe.</span></span></threadsafe>
    <altmember cref="T:System.Messaging.Message" />
    <altmember cref="T:System.Messaging.DefaultPropertiesToSend" />
    <altmember cref="T:System.Messaging.MessageQueueException" />
    <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
    <altmember cref="M:System.Messaging.MessageQueue.Peek" />
    <altmember cref="M:System.Messaging.MessageQueue.Receive" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
    <altmember cref="P:System.Messaging.MessageQueue.Path" />
    <altmember cref="P:System.Messaging.MessageQueue.Label" />
    <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
    <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
    <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-128">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-128">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-129">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-129">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span> <span data-ttu-id="37b16-130">После того как используемый по умолчанию конструктор инициализирует новый экземпляр, необходимо задать свойство <see cref="P:System.Messaging.MessageQueue.Path" /> экземпляра, прежде чем можно будет использовать этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="37b16-130">After the default constructor initializes the new instance, you must set the instance's <see cref="P:System.Messaging.MessageQueue.Path" /> property before you can use the instance.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-131">Используйте этот перегруженный метод, чтобы создать новый экземпляр класса <xref:System.Messaging.MessageQueue> класс, который не привязан непосредственно в очередь на сервер очередей сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-131">Use this overload to create a new instance of the <xref:System.Messaging.MessageQueue> class that is not immediately tied to a queue on the Message Queuing server.</span></span> <span data-ttu-id="37b16-132">Прежде чем использовать этот экземпляр, его необходимо подключить к существующей очереди Message Queuing, задав <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-132">Before using this instance, you must connect it to an existing Message Queuing queue by setting the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="37b16-133">Кроме того, можно задать <xref:System.Messaging.MessageQueue> ссылка <xref:System.Messaging.MessageQueue.Create%28System.String%29> возвращаемое значение метода, тем самым создавая новую очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-133">Alternatively, you can set the <xref:System.Messaging.MessageQueue> reference to the <xref:System.Messaging.MessageQueue.Create%28System.String%29> method's return value, thereby creating a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="37b16-134"><xref:System.Messaging.MessageQueue.%23ctor%2A> Конструктор создает новый экземпляр класса <xref:System.Messaging.MessageQueue> класса; он не создает новую очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-134">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="37b16-135">В следующей таблице представлены исходные значения свойств для экземпляра <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-135">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span>  
  
|<span data-ttu-id="37b16-136">Свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-136">Property</span></span>|<span data-ttu-id="37b16-137">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="37b16-137">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="37b16-138">Значения, заданные с помощью конструктора по умолчанию из <xref:System.Messaging.DefaultPropertiesToSend> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-138">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="37b16-139">Значения, заданные с помощью конструктора по умолчанию из <xref:System.Messaging.MessagePropertyFilter> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-139">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span> <span data-ttu-id="37b16-140">Все значения фильтра присваиваются `true`.</span><span class="sxs-lookup"><span data-stu-id="37b16-140">All the filter values are set to `true`.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-141">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-141">The following code example creates a new <xref:System.Messaging.MessageQueue>.</span></span>  
  
 [!code-csharp[MessageQueue#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue path" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-142">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-142">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></param>
        <summary><span data-ttu-id="37b16-143">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />, который ссылается на очередь MSMQ по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-143">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-144">Используйте этот перегруженный метод, если необходимо привязать новый <xref:System.Messaging.MessageQueue> экземпляр для определенной очереди Message Queuing, о которой известно, что путь, имя формата или метка.</span><span class="sxs-lookup"><span data-stu-id="37b16-144">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> instance to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="37b16-145">Если требуется монопольный доступ к первому приложению, которое ссылается на очередь, необходимо задать <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> свойства `true` или используйте конструктор, который передает параметр ограничением доступа на чтение.</span><span class="sxs-lookup"><span data-stu-id="37b16-145">If you want to grant exclusive access to the first application that references the queue, you must set the <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property to `true` or use the constructor that passes a read-access restriction parameter.</span></span>  
  
 <span data-ttu-id="37b16-146"><xref:System.Messaging.MessageQueue.%23ctor%2A> Конструктор создает новый экземпляр класса <xref:System.Messaging.MessageQueue> класса; он не создает новую очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-146">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="37b16-147">Чтобы создать новую очередь в очереди сообщений, используйте <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-147">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="37b16-148">Синтаксис `path` параметр зависит от типа очереди он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-148">The syntax of the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-149">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-149">Queue type</span></span>|<span data-ttu-id="37b16-150">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-150">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-151">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-151">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-152">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-152">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="37b16-153">Очереди журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-153">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="37b16-154">Очереди журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-154">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="37b16-155">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-155">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="37b16-156">Транзакционная очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-156">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="37b16-157">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-157">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-158">Ссылка</span><span class="sxs-lookup"><span data-stu-id="37b16-158">Reference</span></span>|<span data-ttu-id="37b16-159">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-159">Syntax</span></span>|<span data-ttu-id="37b16-160">Пример</span><span class="sxs-lookup"><span data-stu-id="37b16-160">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="37b16-161">Название формата</span><span class="sxs-lookup"><span data-stu-id="37b16-161">Format name</span></span>|<span data-ttu-id="37b16-162">`FormatName:` [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-162">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="37b16-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="37b16-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="37b16-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="37b16-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="37b16-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="37b16-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="37b16-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="37b16-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="37b16-167">Метка</span><span class="sxs-lookup"><span data-stu-id="37b16-167">Label</span></span>|<span data-ttu-id="37b16-168">`Label:` [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-168">`Label:` [ *label* ]</span></span>|<span data-ttu-id="37b16-169">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="37b16-169">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="37b16-170">Чтобы работать в автономном режиме, необходимо использовать синтаксис имени формата, не синтаксис имени пути для конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-170">To work offline, you must use the format name syntax, not the path name syntax for the constructor.</span></span> <span data-ttu-id="37b16-171">В противном случае создается исключение, так как основной контроллер домена недоступен для разрешения пути в имя формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-171">Otherwise, an exception is thrown because the primary domain controller is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="37b16-172">В следующей таблице представлены исходные значения свойств для экземпляра <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-172">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-173">Эти значения определяются свойства очереди Message Queuing с путем, указанным `path` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-173">These values are based on the properties of the Message Queuing queue with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="37b16-174">Свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-174">Property</span></span>|<span data-ttu-id="37b16-175">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="37b16-175">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="37b16-176">0</span><span class="sxs-lookup"><span data-stu-id="37b16-176">0</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<xref:System.Guid.Empty>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="37b16-177">Значения, заданные с помощью конструктора по умолчанию из <xref:System.Messaging.DefaultPropertiesToSend> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-177">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="37b16-178">`true`, если уровень конфиденциальности очереди Message Queuing «Текст»; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-178">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<xref:System.String.Empty>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="37b16-179">Значение свойства имени компьютера очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-179">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="37b16-180">Значения, заданные с помощью конструктора по умолчанию из <xref:System.Messaging.MessagePropertyFilter> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-180">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="37b16-181"><xref:System.String.Empty>, если оно не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-181"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="37b16-182"><xref:System.String.Empty>, если оно не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-182"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="37b16-183">`true`, если объект Message Queuing журнал включен; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-183">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-184">В следующем примере кода создает новые <xref:System.Messaging.MessageQueue> объекты с различными типами синтаксис имени пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-184">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="37b16-185">В каждом случае он отправляет сообщение в очередь, чей путь, определенный в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="37b16-185">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-186">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> имеет неверное значение. Возможно, оно просто не задано.</span><span class="sxs-lookup"><span data-stu-id="37b16-186">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-187">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="37b16-187">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="37b16-188">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-188"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="37b16-189">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />, который ссылается на очередь MSMQ по указанному пути и с указанным ограничением доступа на чтение.</span><span class="sxs-lookup"><span data-stu-id="37b16-189">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path and with the specified read-access restriction.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-190">Используйте этот перегруженный метод, если необходимо привязать новый <xref:System.Messaging.MessageQueue> в определенную очередь Message Queuing, о которой известно, что путь, имя формата или метка.</span><span class="sxs-lookup"><span data-stu-id="37b16-190">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="37b16-191">Если требуется монопольный доступ к первому приложению, которое ссылается на очередь, установите `sharedModeDenyReceive` параметр `true`.</span><span class="sxs-lookup"><span data-stu-id="37b16-191">If you want to grant exclusive access to the first application that references the queue, set the `sharedModeDenyReceive` parameter to `true`.</span></span> <span data-ttu-id="37b16-192">В противном случае значение `sharedModeDenyReceive` для `false` или используйте конструктор, который имеет только `path` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-192">Otherwise, set `sharedModeDenyReceive` to `false` or use the constructor that has only a `path` parameter.</span></span>  
  
 <span data-ttu-id="37b16-193">Установка `sharedModeDenyReceive` для `true` влияет на все объекты, которые обращаются к очереди сообщений, включая другие приложения.</span><span class="sxs-lookup"><span data-stu-id="37b16-193">Setting `sharedModeDenyReceive` to `true` affects all objects that access the Message Queuing queue, including other applications.</span></span> <span data-ttu-id="37b16-194">Влияние параметра не только на это приложение.</span><span class="sxs-lookup"><span data-stu-id="37b16-194">The effects of the parameter are not restricted to this application.</span></span>  
  
 <span data-ttu-id="37b16-195"><xref:System.Messaging.MessageQueue.%23ctor%2A> Конструктор создает новый экземпляр класса <xref:System.Messaging.MessageQueue> класса; он не создает новую очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-195">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor creates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="37b16-196">Чтобы создать новую очередь в очереди сообщений, используйте <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-196">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="37b16-197">Синтаксис `path` параметр зависит от типа очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-197">The syntax of the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="37b16-198">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-198">Queue type</span></span>|<span data-ttu-id="37b16-199">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-199">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-200">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-200">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-201">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-201">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="37b16-202">Очереди журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-202">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="37b16-203">Очереди журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-203">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="37b16-204">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-204">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="37b16-205">Транзакционная очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-205">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="37b16-206">Кроме того можно использовать формат имя или метку очереди Message Queuing для описания пути к очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-206">Alternatively, you can use the format name or label of a Message Queuing queue to describe the queue path.</span></span>  
  
|<span data-ttu-id="37b16-207">Ссылка</span><span class="sxs-lookup"><span data-stu-id="37b16-207">Reference</span></span>|<span data-ttu-id="37b16-208">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-208">Syntax</span></span>|<span data-ttu-id="37b16-209">Пример</span><span class="sxs-lookup"><span data-stu-id="37b16-209">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="37b16-210">Название формата</span><span class="sxs-lookup"><span data-stu-id="37b16-210">Format name</span></span>|<span data-ttu-id="37b16-211">`FormatName:` [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-211">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="37b16-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="37b16-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="37b16-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="37b16-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="37b16-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="37b16-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="37b16-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="37b16-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="37b16-216">Метка</span><span class="sxs-lookup"><span data-stu-id="37b16-216">Label</span></span>|<span data-ttu-id="37b16-217">`Label:` [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-217">`Label:` [ *label* ]</span></span>|<span data-ttu-id="37b16-218">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="37b16-218">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="37b16-219">Чтобы работать в автономном режиме, необходимо использовать синтаксис имени формата, а не синтаксис понятного имени.</span><span class="sxs-lookup"><span data-stu-id="37b16-219">To work offline, you must use the format name syntax, rather than the friendly name syntax.</span></span> <span data-ttu-id="37b16-220">В противном случае создается исключение, поскольку основного контроллера домена (на котором установлена Active Directory) не поддерживается для разрешения пути в имя формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-220">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="37b16-221">Если <xref:System.Messaging.MessageQueue> открывает очередь `sharedModeDenyReceive` параметру присвоить `true`любые <xref:System.Messaging.MessageQueue> что в последующем попытается прочитать данные из очереди, создаст <xref:System.Messaging.MessageQueueException> из-за нарушения совместного доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-221">If a <xref:System.Messaging.MessageQueue> opens a queue with the `sharedModeDenyReceive` parameter set to `true`, any <xref:System.Messaging.MessageQueue> that subsequently tries to read from the queue generates a <xref:System.Messaging.MessageQueueException> because of a sharing violation.</span></span> <span data-ttu-id="37b16-222">Объект <xref:System.Messaging.MessageQueueException> возникает также в том случае, если <xref:System.Messaging.MessageQueue> пытается получить доступ к очереди в монопольном режиме во время выполнения другой <xref:System.Messaging.MessageQueue> уже имеет монопольного доступа к очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-222">A <xref:System.Messaging.MessageQueueException> is also thrown if a <xref:System.Messaging.MessageQueue> tries to access the queue in exclusive mode while another <xref:System.Messaging.MessageQueue> already has non-exclusive access to the queue.</span></span>  
  
 <span data-ttu-id="37b16-223">В следующей таблице представлены исходные значения свойств для экземпляра <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-223">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-224">Эти значения определяются свойства очереди сообщений, с путем, указанным `path` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-224">These values are based on the properties of the Message Queuing queue, with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="37b16-225">Свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-225">Property</span></span>|<span data-ttu-id="37b16-226">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="37b16-226">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|<span data-ttu-id="37b16-227">`false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-227">`false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="37b16-228">0.</span><span class="sxs-lookup"><span data-stu-id="37b16-228">0.</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<span data-ttu-id="37b16-229"><xref:System.Guid.Empty>.</span><span class="sxs-lookup"><span data-stu-id="37b16-229"><xref:System.Guid.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="37b16-230">Значения, заданные с помощью конструктора по умолчанию из <xref:System.Messaging.DefaultPropertiesToSend> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-230">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="37b16-231">`true`, если уровень конфиденциальности очереди Message Queuing «Текст»; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-231">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<span data-ttu-id="37b16-232"><xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-232"><xref:System.Messaging.XmlMessageFormatter>.</span></span>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<span data-ttu-id="37b16-233"><xref:System.String.Empty>.</span><span class="sxs-lookup"><span data-stu-id="37b16-233"><xref:System.String.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="37b16-234">Значение свойства имени компьютера очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-234">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<span data-ttu-id="37b16-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="37b16-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<span data-ttu-id="37b16-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="37b16-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="37b16-237">Значения, заданные с помощью конструктора по умолчанию из <xref:System.Messaging.MessagePropertyFilter> класса.</span><span class="sxs-lookup"><span data-stu-id="37b16-237">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="37b16-238"><xref:System.String.Empty>, если оно не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-238"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="37b16-239"><xref:System.String.Empty>, если оно не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-239"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|<span data-ttu-id="37b16-240">Значение параметра `sharedModeDenyReceive`.</span><span class="sxs-lookup"><span data-stu-id="37b16-240">The value of the `sharedModeDenyReceive` parameter.</span></span>|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="37b16-241">`true`, если объект Message Queuing журнал включен; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-241">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-242">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> с монопольным доступом задает путь к нему и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-242">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive access, sets its path, and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CPP/mqctor_denysharedreceive.cpp#1)]
 [!code-csharp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CS/mqctor_denysharedreceive.cs#1)]
 [!code-vb[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/VB/mqctor_denysharedreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-243">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> имеет неверное значение. Возможно, оно просто не задано.</span><span class="sxs-lookup"><span data-stu-id="37b16-243">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8;xamarinmac-3.0" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-244">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="37b16-244">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="accessMode"><span data-ttu-id="37b16-245">Одно из значений <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-245">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="37b16-246">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-246">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="enableCache" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-247">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="37b16-247">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="37b16-248">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-248"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache"><span data-ttu-id="37b16-249">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-249"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="37b16-250">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-250">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="37b16-251">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> с монопольным доступом для чтения и с включенным кэшированием подключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-251">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive read access and with connection caching enabled.</span></span>  
  
 [!code-cpp[MessageQueue4#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue4/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue4#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue4/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache, System::Messaging::QueueAccessMode accessMode);" />
      <MemberSignature Language="F#" Value="new System.Messaging.MessageQueue : string * bool * bool * System.Messaging.QueueAccessMode -&gt; System.Messaging.MessageQueue" Usage="new System.Messaging.MessageQueue (path, sharedModeDenyReceive, enableCache, accessMode)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="enableCache" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-252">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="37b16-252">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive"><span data-ttu-id="37b16-253">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-253"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache"><span data-ttu-id="37b16-254">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-254"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <param name="accessMode"><span data-ttu-id="37b16-255">Одно из значений <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-255">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="37b16-256">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-256">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="AccessMode">
      <MemberSignature Language="C#" Value="public System.Messaging.QueueAccessMode AccessMode { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.QueueAccessMode AccessMode" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.AccessMode" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property AccessMode As QueueAccessMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::QueueAccessMode AccessMode { System::Messaging::QueueAccessMode get(); };" />
      <MemberSignature Language="F#" Value="member this.AccessMode : System.Messaging.QueueAccessMode" Usage="System.Messaging.MessageQueue.AccessMode" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.QueueAccessMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-257">Получает значение, указывающее режим доступа для очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-257">Gets a value that indicates the access mode for the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-258">Одно из значений <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-258">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-259">Режим доступа по умолчанию для очереди — `QueueAccessMode.SendAndReceive`, если не указано иное при вызове конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-259">The default access mode for a queue is `QueueAccessMode.SendAndReceive`, unless you specify otherwise when calling the constructor.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Authenticate">
      <MemberSignature Language="C#" Value="public bool Authenticate { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Authenticate" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Authenticate" />
      <MemberSignature Language="VB.NET" Value="Public Property Authenticate As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Authenticate { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.Authenticate : bool with get, set" Usage="System.Messaging.MessageQueue.Authenticate" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Authenticate")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-260">Получает или задает значение, показывающее, принимает ли очередь только сообщения, прошедшие проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="37b16-260">Gets or sets a value that indicates whether the queue accepts only authenticated messages.</span></span></summary>
        <value><span data-ttu-id="37b16-261">Значение <see langword="true" />, если очередь принимает только сообщения, прошедшие проверку подлинности; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-261"><see langword="true" /> if the queue accepts only authenticated messages; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="37b16-262">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-262">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-263">Проверка подлинности сообщений предоставляет способ для проверки целостности сообщений и проверки отправителя сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-263">Message authentication provides a way to ensure message integrity and to verify who sent the message.</span></span> <span data-ttu-id="37b16-264">Чтобы запросить проверку подлинности, передающее приложение задает уровень проверки подлинности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-264">To request authentication, the sending application sets the message's authentication level.</span></span>  
  
 <span data-ttu-id="37b16-265">При задании <xref:System.Messaging.MessageQueue.Authenticate%2A> для `true`, вы ограничите доступ к очереди на сервере, не только к этому <xref:System.Messaging.MessageQueue> экземпляра.</span><span class="sxs-lookup"><span data-stu-id="37b16-265">When you set <xref:System.Messaging.MessageQueue.Authenticate%2A> to `true`, you are restricting access to the queue on the server, not only to this <xref:System.Messaging.MessageQueue> instance.</span></span> <span data-ttu-id="37b16-266">Будут возвращены после всех клиентов, работающих с той же очереди Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-266">All clients working against the same Message Queuing queue will be affected.</span></span>  
  
 <span data-ttu-id="37b16-267">Очередь, принимающую только сообщения, прошедшего проверку подлинности будет отклонять сообщения без проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="37b16-267">A queue that accepts only authenticated messages will reject a non-authenticated message.</span></span> <span data-ttu-id="37b16-268">Чтобы запросить уведомление об отклонении сообщения, приложение может задать <xref:System.Messaging.Message.AcknowledgeType%2A> свойства сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-268">To request notification of message rejection, a sending application can set the <xref:System.Messaging.Message.AcknowledgeType%2A> property of the message.</span></span> <span data-ttu-id="37b16-269">Поскольку существует других признаков отклонения сообщения, передающее приложение может потерять сообщения, вы можете запросить отправку в очередь недоставленных.</span><span class="sxs-lookup"><span data-stu-id="37b16-269">Because no other indication of message rejection exists, the sending application can lose the message unless you request that it be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="37b16-270">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-270">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-271">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-271">Workgroup mode</span></span>|<span data-ttu-id="37b16-272">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-272">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-273">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-273">Local computer</span></span>|<span data-ttu-id="37b16-274">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-274">Yes</span></span>|  
|<span data-ttu-id="37b16-275">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-275">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-276">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-276">Yes</span></span>|  
|<span data-ttu-id="37b16-277">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-277">Remote computer</span></span>|<span data-ttu-id="37b16-278">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-278">No</span></span>|  
|<span data-ttu-id="37b16-279">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-279">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-280">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-280">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-281">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.Authenticate%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-281">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Authenticate%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-282">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-282">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.UseDeadLetterQueue" />
        <altmember cref="P:System.Messaging.Message.AcknowledgeType" />
      </Docs>
    </Member>
    <Member MemberName="BasePriority">
      <MemberSignature Language="C#" Value="public short BasePriority { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int16 BasePriority" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.BasePriority" />
      <MemberSignature Language="VB.NET" Value="Public Property BasePriority As Short" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property short BasePriority { short get(); void set(short value); };" />
      <MemberSignature Language="F#" Value="member this.BasePriority : int16 with get, set" Usage="System.Messaging.MessageQueue.BasePriority" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_BasePriority")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int16</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-283">Получает или задает базовый приоритет, используемый службой очереди сообщений для маршрутизации сообщений общей очереди по сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-283">Gets or sets the base priority Message Queuing uses to route a public queue's messages over the network.</span></span></summary>
        <value><span data-ttu-id="37b16-284">Элементарный базовый приоритет для всех сообщений, переданных в общую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-284">The single base priority for all messages sent to the (public) queue.</span></span> <span data-ttu-id="37b16-285">Значение по умолчанию равно нулю (0).</span><span class="sxs-lookup"><span data-stu-id="37b16-285">The default is zero (0).</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-286">Базовый приоритет очереди сообщений указывает как прохождения сообщения очереди, обрабатывается во время их передачи по сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-286">A message queue's base priority specifies how a message en route to that queue is treated as it travels through the network.</span></span> <span data-ttu-id="37b16-287">Можно задать <xref:System.Messaging.MessageQueue.BasePriority%2A> свойства на основании высокий или низкий приоритет для всех сообщений, отправленных в указанную очередь, отправленными в другие очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-287">You can set the <xref:System.Messaging.MessageQueue.BasePriority%2A> property to confer a higher or lower priority to all messages sent to the specified queue than those sent to other queues.</span></span> <span data-ttu-id="37b16-288">Задание этого свойства изменяет очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-288">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="37b16-289">Таким образом, любой другой <xref:System.Messaging.MessageQueue> экземпляры будут затронуты данным изменением.</span><span class="sxs-lookup"><span data-stu-id="37b16-289">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="37b16-290">Очередь сообщений <xref:System.Messaging.MessageQueue.BasePriority%2A> не относится к <xref:System.Messaging.Message.Priority%2A> свойство сообщения, которое указывает порядок, в котором входящее сообщение помещается в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-290">A message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> is not related to the <xref:System.Messaging.Message.Priority%2A> property of a message, which specifies the order in which an incoming message is placed in the queue.</span></span>  
  
 <span data-ttu-id="37b16-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> применяется только к общим очередям, пути которых указываются с помощью имени формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> applies only to public queues whose paths are specified using the format name.</span></span> <span data-ttu-id="37b16-292">Базовый приоритет частной очереди всегда равно нулю (0).</span><span class="sxs-lookup"><span data-stu-id="37b16-292">The base priority of a private queue is always zero (0).</span></span>  
  
 <span data-ttu-id="37b16-293">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-293">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-294">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-294">Workgroup mode</span></span>|<span data-ttu-id="37b16-295">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-295">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-296">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-296">Local computer</span></span>|<span data-ttu-id="37b16-297">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-297">Yes</span></span>|  
|<span data-ttu-id="37b16-298">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-298">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-299">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-299">Yes</span></span>|  
|<span data-ttu-id="37b16-300">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-300">Remote computer</span></span>|<span data-ttu-id="37b16-301">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-301">No</span></span>|  
|<span data-ttu-id="37b16-302">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-302">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-303">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-303">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-304">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.BasePriority%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-304">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-305">Для базового приоритета задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="37b16-305">The base priority was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-306">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-306">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginPeek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="37b16-307">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-307">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="37b16-308">Инициирует асинхронную операцию считывания, указывая службе MSMQ на необходимость запуска операции считывания сообщения и уведомления обработчика событий о завершении операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-308">Initiates an asynchronous peek operation by telling Message Queuing to begin peeking a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek();" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : unit -&gt; IAsyncResult" Usage="messageQueue.BeginPeek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-309">Инициирует асинхронную операцию считывания, не имеющую тайм-аута. Операция остается незавершенной, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-309">Initiates an asynchronous peek operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-310">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-310">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-311">В асинхронной обработки используется <xref:System.Messaging.MessageQueue.BeginPeek%2A> для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-311">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue.</span></span>  
  
 <span data-ttu-id="37b16-312"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-312"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-313">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-313">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Инициирует асинхронную операцию считывания; <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.PeekCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-315"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> или путем извлечения результата с помощью <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-315">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-316"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-316">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-317">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди, не блокирует текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-317">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-318">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-318">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-319">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-319">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-320"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-320">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-321">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-321">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-322">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-322">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-323">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-323">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-324">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-324">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-325">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-325">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-326">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-326">Workgroup mode</span></span>|<span data-ttu-id="37b16-327">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-327">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-328">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-328">Local computer</span></span>|<span data-ttu-id="37b16-329">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-329">Yes</span></span>|  
|<span data-ttu-id="37b16-330">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-330">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-331">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-331">Yes</span></span>|  
|<span data-ttu-id="37b16-332">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-332">Remote computer</span></span>|<span data-ttu-id="37b16-333">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-333">No</span></span>|  
|<span data-ttu-id="37b16-334">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-334">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-335">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-335">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-336">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginPeek%2A> инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="37b16-336">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="37b16-337">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события, в примере считывает сообщение и выводит его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-337">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="37b16-338">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="37b16-338">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-339">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-340">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginPeek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-341">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-341">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="37b16-342">Инициирует асинхронную операцию считывания с заданным тайм-аутом. Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-342">Initiates an asynchronous peek operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-343">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-343">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-344">В асинхронной обработки используется <xref:System.Messaging.MessageQueue.BeginPeek%2A> для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение не станет доступным в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="37b16-344">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="37b16-345"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-345"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-346">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-346">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Инициирует асинхронную операцию считывания; <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.PeekCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-348"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> или путем извлечения результата с помощью <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-348">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-349"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-349">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-350">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди, не блокирует текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-350">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-351">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-351">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-352">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-352">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-353"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-353">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-354">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-354">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-355">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-355">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-356">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-356">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-357">Эта перегрузка позволяет задать время ожидания. Если время, заданное параметром `timeout` истекло, этот компонент создает <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-357">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="37b16-358">Поскольку сообщения отсутствуют, последующий вызов <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-358">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="37b16-359">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-359">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-360">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-360">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-361">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-361">Workgroup mode</span></span>|<span data-ttu-id="37b16-362">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-362">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-363">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-363">Local computer</span></span>|<span data-ttu-id="37b16-364">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-364">Yes</span></span>|  
|<span data-ttu-id="37b16-365">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-365">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-366">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-366">Yes</span></span>|  
|<span data-ttu-id="37b16-367">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-367">Remote computer</span></span>|<span data-ttu-id="37b16-368">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-368">No</span></span>|  
|<span data-ttu-id="37b16-369">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-369">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-370">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-370">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-371">В следующем примере кода создается асинхронную операцию считывания, используя путь очереди «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="37b16-371">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="37b16-372">Он создает обработчик событий `MyPeekCompleted`и присоединяет его к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-372">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="37b16-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается с временем ожидания длительностью в одну минуту, чтобы инициировать асинхронную операцию считывания.</span><span class="sxs-lookup"><span data-stu-id="37b16-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called with a time-out of one minute, to initiate the asynchronous peek operation.</span></span> <span data-ttu-id="37b16-374">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события или истечения времени ожидания, сообщение извлекается в том случае, если он существует и основной текст выводится на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-374">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expires, the message is retrieved if one exists, and its body is written to the screen.</span></span> <span data-ttu-id="37b16-375">Затем <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается снова, чтобы инициировать операцию асинхронного считывания с тем же временем ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-375">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CPP/mqbeginpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CS/mqbeginpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/VB/mqbeginpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-376">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-376">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-377">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-377">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-378">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-378">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-379">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-379">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="37b16-380">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-380">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="37b16-381">Инициирует асинхронную операцию считывания с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-381">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="37b16-382">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-382">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-383">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-383">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-384">В асинхронной обработки используется <xref:System.Messaging.MessageQueue.BeginPeek%2A> для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение не станет доступным в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="37b16-384">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="37b16-385"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-385"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-386">Используйте этот перегруженный метод, чтобы связать сведения с операцией, сохраняются на протяжении всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-386">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="37b16-387">Обработчик событий можно получить доступ к этой информации, просмотрев <xref:System.IAsyncResult.AsyncState%2A> свойство <xref:System.IAsyncResult> , связанного с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-387">The event handler can access this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="37b16-388">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-388">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Инициирует асинхронную операцию считывания; <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.PeekCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-390"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> или путем извлечения результата с помощью <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-390">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-391"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-391">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-392">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди, не блокирует текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-392">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-393">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-393">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-394">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-394">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает <xref:System.IAsyncResult> , определяющий асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-396">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-396">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-397">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-397">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-398">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-398">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-399">Эта перегрузка позволяет задать время ожидания и объект состояния.</span><span class="sxs-lookup"><span data-stu-id="37b16-399">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="37b16-400">Если время, заданное параметром `timeout` истекло, этот компонент создает <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-400">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="37b16-401">Поскольку сообщения отсутствуют, последующий вызов <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-401">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="37b16-402">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-402">The state object associates state information with the operation.</span></span> <span data-ttu-id="37b16-403">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="37b16-403">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span> <span data-ttu-id="37b16-404">Пример такого сценария см. разделе "Пример".</span><span class="sxs-lookup"><span data-stu-id="37b16-404">For an illustration of this scenario, see the Example section.</span></span>  
  
 <span data-ttu-id="37b16-405">Объект состояния может использоваться для передачи информации по потокам процессов.</span><span class="sxs-lookup"><span data-stu-id="37b16-405">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="37b16-406">Обратный вызов находится в другом потоке в асинхронном сценарии запуска потока, объект состояния маршалировать и передать обратно, а также сведения из события.</span><span class="sxs-lookup"><span data-stu-id="37b16-406">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="37b16-407">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-407">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-408">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-408">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-409">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-409">Workgroup mode</span></span>|<span data-ttu-id="37b16-410">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-410">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-411">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-411">Local computer</span></span>|<span data-ttu-id="37b16-412">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-412">Yes</span></span>|  
|<span data-ttu-id="37b16-413">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-413">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-414">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-414">Yes</span></span>|  
|<span data-ttu-id="37b16-415">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-415">Remote computer</span></span>|<span data-ttu-id="37b16-416">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-416">No</span></span>|  
|<span data-ttu-id="37b16-417">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-417">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-418">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-418">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-419">В следующем примере кода создается асинхронную операцию считывания, используя путь очереди «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="37b16-419">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="37b16-420">Он создает обработчик событий `MyPeekCompleted`и присоединяет его к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-420">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="37b16-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается, с временем ожидания длительностью в одну минуту.</span><span class="sxs-lookup"><span data-stu-id="37b16-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called, with a time-out of one minute.</span></span> <span data-ttu-id="37b16-422">Каждый вызов <xref:System.Messaging.MessageQueue.BeginPeek%2A> имеет уникальный целочисленный идентификатор, определяющий данную операцию.</span><span class="sxs-lookup"><span data-stu-id="37b16-422">Each call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> has a unique associated integer that identifies that particular operation.</span></span> <span data-ttu-id="37b16-423">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события или истечения тайм-аута, сообщение, если таковой существует, извлекается и его текст и относящиеся к операции целочисленный идентификатор записываются на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-423">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expired, the message, if one exists, is retrieved and its body and the operation-specific integer identifier are written to the screen.</span></span> <span data-ttu-id="37b16-424">Затем <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается снова, чтобы инициировать операцию асинхронного считывания с тем же тайм-аут и с целочисленным просто завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-424">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out and the associated integer of the just completed operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CPP/mqbeginpeek_timeoutstateobject.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CS/mqbeginpeek_timeoutstateobject.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/VB/mqbeginpeek_timeoutstateobject.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-425">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-425">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-426">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-427">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-427">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-428">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-428">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="37b16-429">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-429">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="37b16-430">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-430">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="37b16-431">Инициирует асинхронную операцию считывания с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-431">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="37b16-432">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-432">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="37b16-433">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-433">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-434">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-434">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-435">При использовании этой перегрузки, обратный вызов, указанный в параметре обратного вызова инициируется, сообщение не станет доступным в очереди или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.PeekCompleted> событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="37b16-435">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="37b16-436">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginPeek%2A> полагаются на этот компонент для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-436">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="37b16-437"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-437"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-438"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-438">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-439">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди, не блокирует текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-439">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-440">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-440">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-441">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-441">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает <xref:System.IAsyncResult> , определяющий асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-443">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-443">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-444">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-444">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-445">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-445">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-446">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-446">The state object associates state information with the operation.</span></span> <span data-ttu-id="37b16-447">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="37b16-447">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="37b16-448">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-448">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-449">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-449">Workgroup mode</span></span>|<span data-ttu-id="37b16-450">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-450">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-451">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-451">Local computer</span></span>|<span data-ttu-id="37b16-452">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-452">Yes</span></span>|  
|<span data-ttu-id="37b16-453">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-453">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-454">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-454">Yes</span></span>|  
|<span data-ttu-id="37b16-455">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-455">Remote computer</span></span>|<span data-ttu-id="37b16-456">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-456">No</span></span>|  
|<span data-ttu-id="37b16-457">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-457">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-458">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-458">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-459">В следующем примере кода создается асинхронную операцию считывания.</span><span class="sxs-lookup"><span data-stu-id="37b16-459">The following code example creates an asynchronous peek operation.</span></span> <span data-ttu-id="37b16-460">Пример кода отправляет сообщение в очередь локальных сообщений, затем вызывает <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, передавая: значение времени ожидания 10 секунд; уникальный целочисленный идентификатор конкретного сообщения; и новый экземпляр класса <xref:System.AsyncCallback> , определяющий обработчик событий, `MyPeekCompleted`.</span><span class="sxs-lookup"><span data-stu-id="37b16-460">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyPeekCompleted`.</span></span> <span data-ttu-id="37b16-461">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события, обработчик событий считывает сообщение и выводит на экран текст сообщения и целочисленный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-461">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the event handler peeks at the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginPeek#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginPeek/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginPeek#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginPeek/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-462">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-462">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-463">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-463">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-464">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-464">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginPeek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginPeek (timeout, cursor, action, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="state" Type="System.Object" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="callback" Type="System.AsyncCallback" Index="4" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-465">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-465">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="37b16-466">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-466">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="37b16-467">Одно из значений <see cref="T:System.Messaging.PeekAction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-467">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="37b16-468">Указывает, следует ли считывать текущее сообщение в очереди или следующее сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-468">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <param name="state"><span data-ttu-id="37b16-469">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-469">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="37b16-470">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-470">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="37b16-471">Инициирует асинхронную операцию считывания, которая имеет заданный тайм-аут и использует заданный курсор, заданную операцию считывания и заданный объект состояния.</span><span class="sxs-lookup"><span data-stu-id="37b16-471">Initiates an asynchronous peek operation that has a specified time-out and that uses a specified cursor, a specified peek action, and a specified state object.</span></span> <span data-ttu-id="37b16-472">Объект состояния предоставляет связанные сведения в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-472">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="37b16-473">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-473">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="37b16-474">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-474">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-475">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-475">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-476">При использовании этой перегрузки, обратный вызов, указанный в параметре обратного вызова инициируется, когда сообщение не станет доступным в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="37b16-476">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired.</span></span> <span data-ttu-id="37b16-477"><xref:System.Messaging.MessageQueue.PeekCompleted> Событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="37b16-477">The <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="37b16-478">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginPeek%2A> полагаются на этот компонент для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-478">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="37b16-479"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-479"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-480"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-480">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-481">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, его можно вызвать для просмотра очереди, не блокирует текущий поток выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-481">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-482">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-482">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-483">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-483">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает <xref:System.IAsyncResult> , определяющий асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation started by the method.</span></span> <span data-ttu-id="37b16-485">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-485">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-486">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-486">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-487">В этом случае следует использовать <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-487">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-488">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-488">The state object associates state information with the operation.</span></span> <span data-ttu-id="37b16-489">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="37b16-489">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="37b16-490">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-490">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-491">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-491">Workgroup mode</span></span>|<span data-ttu-id="37b16-492">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-492">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-493">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-493">Local computer</span></span>|<span data-ttu-id="37b16-494">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-494">Yes</span></span>|  
|<span data-ttu-id="37b16-495">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-495">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-496">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-496">Yes</span></span>|  
|<span data-ttu-id="37b16-497">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-497">Remote computer</span></span>|<span data-ttu-id="37b16-498">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-498">No</span></span>|  
|<span data-ttu-id="37b16-499">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-499">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-500">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-500">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="37b16-501">Для параметра <paramref name="action" /> было задано значение, отличное от <see langword="PeekAction.Current" /> или <see langword="PeekAction.Next" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-501">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-502">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-502">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-503">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-503">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-504">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-504">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-505">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-505">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginReceive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="37b16-506">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-506">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="37b16-507">Инициирует асинхронную операцию получения, указывая службе MSMQ на необходимость запуска операции получения сообщения и уведомления обработчика событий о завершении операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-507">Initiates an asynchronous receive operation by telling Message Queuing to begin receiving a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive();" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : unit -&gt; IAsyncResult" Usage="messageQueue.BeginReceive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-508">Инициирует асинхронную операцию получения без тайм-аута. Операция остается незавершенной, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-508">Initiates an asynchronous receive operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-509">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-509">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-510">В асинхронной обработки используется <xref:System.Messaging.MessageQueue.BeginReceive%2A> для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение было удалено из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-510">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message has been removed from the queue.</span></span>  
  
 <span data-ttu-id="37b16-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-512">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-512">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-514"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-514">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-515"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-515">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-516">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-516">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-517">Чтобы синхронно сообщение об ошибке, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-517">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-518">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-518">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-519"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-519">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-520">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-520">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-521">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-521">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-522">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-522">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-523">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-523">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-524">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="37b16-524">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="37b16-525">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, создаваемых для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="37b16-525">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="37b16-526">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="37b16-526">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="37b16-527">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-527">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-528">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-528">Workgroup mode</span></span>|<span data-ttu-id="37b16-529">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-529">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-530">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-530">Local computer</span></span>|<span data-ttu-id="37b16-531">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-531">Yes</span></span>|  
|<span data-ttu-id="37b16-532">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-532">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-533">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-533">Yes</span></span>|  
|<span data-ttu-id="37b16-534">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-534">Remote computer</span></span>|<span data-ttu-id="37b16-535">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-535">No</span></span>|  
|<span data-ttu-id="37b16-536">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-536">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-537">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-537">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-538">В следующем примере кода создается цепочка асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="37b16-538">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="37b16-539">Предполагается, что на локальном компьютере, именем «myQueue» очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-539">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="37b16-540">`Main` Функция начинает асинхронную операцию, которая обрабатывается `MyReceiveCompleted` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="37b16-540">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="37b16-541">`MyReceiveCompleted` обрабатывает текущее сообщение и начинает новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-541">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 <span data-ttu-id="37b16-542">В следующем примере кода создается очередь асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="37b16-542">The following code example queues asynchronous requests.</span></span> <span data-ttu-id="37b16-543">Вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> использует <xref:System.IAsyncResult.AsyncWaitHandle%2A> результирующее значение.</span><span class="sxs-lookup"><span data-stu-id="37b16-543">The call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> uses the <xref:System.IAsyncResult.AsyncWaitHandle%2A> in its return value.</span></span> <span data-ttu-id="37b16-544">`Main` Процедура ожидает завершить перед выходом из всех асинхронных операций.</span><span class="sxs-lookup"><span data-stu-id="37b16-544">The `Main` routine waits for all asynchronous operations to be completed before exiting.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_wh.cpp#2)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_wh.cs#2)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_wh.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-545">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-545">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-546">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-546">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan -&gt; IAsyncResult" Usage="messageQueue.BeginReceive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-547">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-547">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="37b16-548">Инициирует асинхронную операцию получения с указанным тайм-аутом. Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-548">Initiates an asynchronous receive operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-549">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-549">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-550">В асинхронной обработки используется <xref:System.Messaging.MessageQueue.BeginReceive%2A> для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение не станет доступным в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="37b16-550">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="37b16-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-552">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-552">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-554"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-554">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-555"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-555">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-556">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-556">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-557">Чтобы синхронно сообщение об ошибке, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-557">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-558">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-558">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-559">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-559">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-560"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-560">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-561">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-561">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-562">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-562">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-563">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-563">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-564">Эта перегрузка позволяет задать время ожидания. Если время, заданное параметром `timeout` истекло, этот компонент создает <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-564">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="37b16-565">Поскольку сообщения отсутствуют, последующий вызов <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-565">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="37b16-566">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="37b16-566">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="37b16-567">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, создаваемых для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="37b16-567">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="37b16-568">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="37b16-568">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="37b16-569">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-569">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-570">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-570">Workgroup mode</span></span>|<span data-ttu-id="37b16-571">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-571">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-572">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-572">Local computer</span></span>|<span data-ttu-id="37b16-573">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-573">Yes</span></span>|  
|<span data-ttu-id="37b16-574">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-574">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-575">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-575">Yes</span></span>|  
|<span data-ttu-id="37b16-576">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-576">Remote computer</span></span>|<span data-ttu-id="37b16-577">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-577">No</span></span>|  
|<span data-ttu-id="37b16-578">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-578">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-579">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-579">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-580">В следующем примере кода создается асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-580">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="37b16-581">В примере кода создается обработчик событий `MyReceiveCompleted`и присоединяет его к <xref:System.Messaging.MessageQueue.ReceiveCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-581">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="37b16-582">Пример кода отправляет сообщение в очередь локальных сообщений, затем вызывает метод <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, передавая значение времени ожидания 10 секунд.</span><span class="sxs-lookup"><span data-stu-id="37b16-582">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passing in a time-out value of ten seconds.</span></span> <span data-ttu-id="37b16-583">Когда <xref:System.Messaging.MessageQueue.ReceiveCompleted> события, обработчик событий получает сообщение и выводит на экран текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-583">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive1#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive1/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive1#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive1/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-584">Значение, заданное для параметра <paramref name="timeout" />, недопустимо. Возможно, было введено отрицательное число.</span><span class="sxs-lookup"><span data-stu-id="37b16-584">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly because it represents a negative number.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-585">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-585">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-586">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-586">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-587">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-587">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="37b16-588">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-588">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="37b16-589">Инициирует асинхронную операцию получения с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-589">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="37b16-590">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-590">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-591">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-591">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-592">В асинхронной обработки используется <xref:System.Messaging.MessageQueue.BeginReceive%2A> для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение не станет доступным в очереди или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="37b16-592">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="37b16-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-594">Используйте этот перегруженный метод, чтобы связать сведения с операцией, сохраняются на протяжении всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-594">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="37b16-595">Обработчик событий может обнаружить эти сведения, просмотрев <xref:System.IAsyncResult.AsyncState%2A> свойство <xref:System.IAsyncResult> , связанного с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-595">The event handler can detect this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="37b16-596">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-596">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-598"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-598">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-599"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-599">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-600">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-600">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-601">Чтобы синхронно сообщение об ошибке, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-601">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-602">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-602">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-603"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-603">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-604">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-604">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-605">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-605">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-606">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-606">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-607">Эта перегрузка позволяет задать время ожидания и объект состояния.</span><span class="sxs-lookup"><span data-stu-id="37b16-607">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="37b16-608">Если время, заданное параметром `timeout` истекло, этот компонент создает <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-608">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="37b16-609">Поскольку сообщения отсутствуют, последующий вызов <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-609">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="37b16-610">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-610">The state object associates state information with the operation.</span></span> <span data-ttu-id="37b16-611">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="37b16-611">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="37b16-612">Объект состояния может использоваться для передачи информации по потокам процессов.</span><span class="sxs-lookup"><span data-stu-id="37b16-612">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="37b16-613">Обратный вызов находится в другом потоке в асинхронном сценарии запуска потока, объект состояния маршалировать и передать обратно, а также сведения из события.</span><span class="sxs-lookup"><span data-stu-id="37b16-613">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="37b16-614">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="37b16-614">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="37b16-615">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, создаваемых для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="37b16-615">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="37b16-616">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="37b16-616">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="37b16-617">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-617">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-618">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-618">Workgroup mode</span></span>|<span data-ttu-id="37b16-619">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-619">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-620">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-620">Local computer</span></span>|<span data-ttu-id="37b16-621">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-621">Yes</span></span>|  
|<span data-ttu-id="37b16-622">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-622">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-623">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-623">Yes</span></span>|  
|<span data-ttu-id="37b16-624">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-624">Remote computer</span></span>|<span data-ttu-id="37b16-625">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-625">No</span></span>|  
|<span data-ttu-id="37b16-626">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-626">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-627">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-627">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-628">В следующем примере кода создается асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-628">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="37b16-629">В примере кода создается обработчик событий `MyReceiveCompleted`и присоединяет его к <xref:System.Messaging.MessageQueue.ReceiveCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-629">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="37b16-630">Пример кода отправляет сообщение в очередь локальных сообщений, затем вызывает метод <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, передавая значение времени ожидания 10 секунд и уникальный целочисленный идентификатор конкретного сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-630">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passing in a time-out value of ten seconds and a unique integer that identifies that particular message.</span></span> <span data-ttu-id="37b16-631">Когда <xref:System.Messaging.MessageQueue.ReceiveCompleted> события, обработчик событий получает сообщение и выводит на экран текст сообщения и целочисленный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-631">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive2#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive2/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive2#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive2/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-632">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-632">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-633">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-633">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-634">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-634">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, stateObject, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-635">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-635">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="37b16-636">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-636">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="37b16-637">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-637">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="37b16-638">Инициирует асинхронную операцию получения с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-638">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="37b16-639">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-639">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="37b16-640">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-640">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-641">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-641">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-642">При использовании этой перегрузки, обратный вызов, указанный в параметре обратного вызова инициируется, сообщение не станет доступным в очереди или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="37b16-642">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="37b16-643">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginReceive%2A> полагаются на этот компонент для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-643">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="37b16-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-645">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-645">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-647"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-647">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-648"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-648">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-649">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-649">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-650">Чтобы синхронно сообщение об ошибке, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-650">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-651">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-651">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-652"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-652">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-653">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-653">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-654">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-654">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-655">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-655">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-656">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-656">The state object associates state information with the operation.</span></span> <span data-ttu-id="37b16-657">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="37b16-657">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="37b16-658">Объект состояния может использоваться для передачи информации по потокам процессов.</span><span class="sxs-lookup"><span data-stu-id="37b16-658">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="37b16-659">Обратный вызов находится в другом потоке в асинхронном сценарии запуска потока, объект состояния маршалировать и передать обратно, а также сведения из события.</span><span class="sxs-lookup"><span data-stu-id="37b16-659">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="37b16-660">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="37b16-660">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="37b16-661">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, создаваемых для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="37b16-661">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="37b16-662">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="37b16-662">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="37b16-663">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-663">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-664">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-664">Workgroup mode</span></span>|<span data-ttu-id="37b16-665">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-665">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-666">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-666">Local computer</span></span>|<span data-ttu-id="37b16-667">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-667">Yes</span></span>|  
|<span data-ttu-id="37b16-668">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-668">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-669">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-669">Yes</span></span>|  
|<span data-ttu-id="37b16-670">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-670">Remote computer</span></span>|<span data-ttu-id="37b16-671">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-671">No</span></span>|  
|<span data-ttu-id="37b16-672">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-672">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-673">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-673">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-674">В следующем примере кода создается асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-674">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="37b16-675">Пример кода отправляет сообщение в очередь локальных сообщений, затем вызывает <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, передавая: значение времени ожидания 10 секунд; уникальный целочисленный идентификатор конкретного сообщения; и новый экземпляр класса <xref:System.AsyncCallback> , определяющий обработчик событий, `MyReceiveCompleted`.</span><span class="sxs-lookup"><span data-stu-id="37b16-675">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyReceiveCompleted`.</span></span> <span data-ttu-id="37b16-676">Когда <xref:System.Messaging.MessageQueue.ReceiveCompleted> события, обработчик событий получает сообщение и выводит на экран текст сообщения и целочисленный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-676">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive3#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive3/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive3#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive3/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-677">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-677">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-678">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-678">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-679">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-679">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, System.Messaging.Cursor cursor, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Messaging.Cursor,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberSignature Language="F#" Value="member this.BeginReceive : TimeSpan * System.Messaging.Cursor * obj * AsyncCallback -&gt; IAsyncResult" Usage="messageQueue.BeginReceive (timeout, cursor, state, callback)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="state" Type="System.Object" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="callback" Type="System.AsyncCallback" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-680">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-680">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="37b16-681">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-681">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="state"><span data-ttu-id="37b16-682">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-682">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="37b16-683">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-683">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="37b16-684">Инициирует асинхронную операцию получения, которая имеет заданный тайм-аут и использует заданный курсор и заданный объект состояния.</span><span class="sxs-lookup"><span data-stu-id="37b16-684">Initiates an asynchronous receive operation that has a specified time-out and uses a specified cursor and a specified state object.</span></span> <span data-ttu-id="37b16-685">Объект состояния предоставляет связанные сведения в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-685">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="37b16-686">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-686">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="37b16-687">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-687">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-688">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="37b16-688">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-689">При использовании этой перегрузки, обратный вызов, указанный в параметре обратного вызова инициируется, сообщение не станет доступным в очереди или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="37b16-689">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="37b16-690">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginReceive%2A> полагаются на этот компонент для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-690">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="37b16-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-692">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и свяжите его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-692">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="37b16-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> уведомляется через вызов <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий, при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="37b16-694"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="37b16-694">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="37b16-695"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод немедленно возвращает результат, но асинхронная операция не завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="37b16-695">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="37b16-696">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="37b16-696">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="37b16-697">Чтобы синхронно сообщение об ошибке, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-697">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-698">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="37b16-698">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="37b16-699"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="37b16-699">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="37b16-700">Это можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-700">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="37b16-701">Тем не менее, если вы запустили несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значений в массиве и укажите, следует ли ожидать все операции или завершения любой операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-701">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="37b16-702">В этом случае следует использовать <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="37b16-702">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="37b16-703">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-703">The state object associates state information with the operation.</span></span> <span data-ttu-id="37b16-704">Например, если вы вызываете <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="37b16-704">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="37b16-705">Объект состояния может использоваться для передачи информации по потокам процессов.</span><span class="sxs-lookup"><span data-stu-id="37b16-705">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="37b16-706">Обратный вызов находится в другом потоке в асинхронном сценарии запуска потока, объект состояния маршалировать и передать обратно, а также сведения из события.</span><span class="sxs-lookup"><span data-stu-id="37b16-706">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="37b16-707">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="37b16-707">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="37b16-708">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, создаваемых для операции просмотра.</span><span class="sxs-lookup"><span data-stu-id="37b16-708">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="37b16-709">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="37b16-709">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="37b16-710">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-710">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-711">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-711">Workgroup mode</span></span>|<span data-ttu-id="37b16-712">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-712">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-713">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-713">Local computer</span></span>|<span data-ttu-id="37b16-714">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-714">Yes</span></span>|  
|<span data-ttu-id="37b16-715">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-715">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-716">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-716">Yes</span></span>|  
|<span data-ttu-id="37b16-717">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-717">Remote computer</span></span>|<span data-ttu-id="37b16-718">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-718">No</span></span>|  
|<span data-ttu-id="37b16-719">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-719">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-720">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-720">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-721">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-721">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-722">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-722">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-723">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-723">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-724">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-724">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="CanRead">
      <MemberSignature Language="C#" Value="public bool CanRead { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanRead" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanRead" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanRead As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanRead { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanRead : bool" Usage="System.Messaging.MessageQueue.CanRead" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanRead")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-725">Получает значение, указывающее, может ли быть прочитан объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-725">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be read.</span></span></summary>
        <value><span data-ttu-id="37b16-726">Значение <see langword="true" />, если класс <see cref="T:System.Messaging.MessageQueue" /> существует, и приложение может прочитать данные из него; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-726"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can read from it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-727"><xref:System.Messaging.MessageQueue.CanRead%2A> Указывает, является ли приложение возможность считывания и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indicates whether the application is able to peek or receive messages from the queue.</span></span> <span data-ttu-id="37b16-728">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `true`, <xref:System.Messaging.MessageQueue> можно получать и считывать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-728">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `true`, the <xref:System.Messaging.MessageQueue> can receive or peek messages from the queue.</span></span> <span data-ttu-id="37b16-729">В противном случае это невозможно.</span><span class="sxs-lookup"><span data-stu-id="37b16-729">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="37b16-730"><xref:System.Messaging.MessageQueue.CanRead%2A> — `false` Если очередь уже был открыт монопольный доступ на чтение (или если он открыт монопольного доступа, и этот <xref:System.Messaging.MessageQueue> запрашивает монопольный доступ), или если приложение не имеет достаточных прав на доступ к нему.</span><span class="sxs-lookup"><span data-stu-id="37b16-730"><xref:System.Messaging.MessageQueue.CanRead%2A> is `false` if a queue is already open with exclusive read access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="37b16-731">Если приложение пытается прочитать из очереди при <xref:System.Messaging.MessageQueue.CanRead%2A> является `false`, доступ будет запрещен.</span><span class="sxs-lookup"><span data-stu-id="37b16-731">If your application tries to read from a queue when <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="37b16-732">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-732">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-733">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-733">Workgroup mode</span></span>|<span data-ttu-id="37b16-734">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-734">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-735">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-735">Local computer</span></span>|<span data-ttu-id="37b16-736">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-736">Yes</span></span>|  
|<span data-ttu-id="37b16-737">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-737">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-738">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-738">Yes</span></span>|  
|<span data-ttu-id="37b16-739">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-739">Remote computer</span></span>|<span data-ttu-id="37b16-740">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-740">No</span></span>|  
|<span data-ttu-id="37b16-741">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-741">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-742">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-742">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-743">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.CanRead%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-743">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanRead%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
    <Member MemberName="CanWrite">
      <MemberSignature Language="C#" Value="public bool CanWrite { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanWrite" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanWrite" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanWrite As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanWrite { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.CanWrite : bool" Usage="System.Messaging.MessageQueue.CanWrite" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanWrite")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-744">Получает значение, указывающее, может ли быть выполнена запись в <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-744">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be written to.</span></span></summary>
        <value><span data-ttu-id="37b16-745">Значение <see langword="true" />, если класс <see cref="T:System.Messaging.MessageQueue" /> существует, и приложение может записать в него данные; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-745"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can write to it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> Указывает, является ли приложение для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indicates whether the application is able to send messages to the queue.</span></span> <span data-ttu-id="37b16-747">Если <xref:System.Messaging.MessageQueue.CanWrite%2A> — `true`, <xref:System.Messaging.MessageQueue> может отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-747">If <xref:System.Messaging.MessageQueue.CanWrite%2A> is `true`, the <xref:System.Messaging.MessageQueue> can send messages to the queue.</span></span> <span data-ttu-id="37b16-748">В противном случае это невозможно.</span><span class="sxs-lookup"><span data-stu-id="37b16-748">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="37b16-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> — `false` Если очередь уже был открыт монопольный доступ на запись (или если он открыт монопольного доступа, и этот <xref:System.Messaging.MessageQueue> запрашивает монопольный доступ), или если приложение не имеет достаточных прав на доступ к нему.</span><span class="sxs-lookup"><span data-stu-id="37b16-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> is `false` if a queue is already open with exclusive write access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="37b16-750">Если приложение пытается записывать в очередь при <xref:System.Messaging.MessageQueue.CanWrite%2A> является `false`, доступ будет запрещен.</span><span class="sxs-lookup"><span data-stu-id="37b16-750">If your application tries to write to a queue when <xref:System.Messaging.MessageQueue.CanWrite%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="37b16-751">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-751">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-752">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-752">Workgroup mode</span></span>|<span data-ttu-id="37b16-753">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-753">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-754">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-754">Local computer</span></span>|<span data-ttu-id="37b16-755">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-755">Yes</span></span>|  
|<span data-ttu-id="37b16-756">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-756">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-757">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-757">Yes</span></span>|  
|<span data-ttu-id="37b16-758">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-758">Remote computer</span></span>|<span data-ttu-id="37b16-759">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-759">No</span></span>|  
|<span data-ttu-id="37b16-760">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-760">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-761">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-761">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-762">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.CanWrite%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-762">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanWrite%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
      </Docs>
    </Member>
    <Member MemberName="Category">
      <MemberSignature Language="C#" Value="public Guid Category { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Category" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Category" />
      <MemberSignature Language="VB.NET" Value="Public Property Category As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Category { Guid get(); void set(Guid value); };" />
      <MemberSignature Language="F#" Value="member this.Category : Guid with get, set" Usage="System.Messaging.MessageQueue.Category" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Category")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-763">Возвращает или задает категорию очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-763">Gets or sets the queue category.</span></span></summary>
        <value><span data-ttu-id="37b16-764">Объект <see cref="T:System.Guid" />, представляющий категорию очереди (идентификатор типа очереди сообщений), которая позволяет приложению классифицировать его очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-764">A <see cref="T:System.Guid" /> that represents the queue category (Message Queuing type identifier), which allows an application to categorize its queues.</span></span> <span data-ttu-id="37b16-765">Значение по умолчанию — <see langword="Guid.empty" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-765">The default is <see langword="Guid.empty" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-766">Категория очереди позволяет приложению классифицировать его очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-766">The queue category allows an application to categorize its queues.</span></span> <span data-ttu-id="37b16-767">Например можно поместить все очереди выставление счетов в одной категории, а все очереди порядок, в другой.</span><span class="sxs-lookup"><span data-stu-id="37b16-767">For example, you can place all Billing queues in one category and all Order queues in another.</span></span>  
  
 <span data-ttu-id="37b16-768"><xref:System.Messaging.MessageQueue.Category%2A> Свойство предоставляет доступ к свойству идентификатора типов очередей сообщений (который является чтение и запись), доступные через **свойства очереди** диалоговое окно, в консоли управления компьютером.</span><span class="sxs-lookup"><span data-stu-id="37b16-768">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing Type ID property (which is read/write), accessible through the **Queue Properties** dialog box in the Computer Management Console.</span></span> <span data-ttu-id="37b16-769">Можно определить новую категорию.</span><span class="sxs-lookup"><span data-stu-id="37b16-769">You can define a new category.</span></span> <span data-ttu-id="37b16-770">Несмотря на то, что можно использовать <xref:System.Guid.NewGuid%2A> для создания значения категории, которое является уникальным для всех <xref:System.Guid> значения, это действие не требуется.</span><span class="sxs-lookup"><span data-stu-id="37b16-770">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, such an action is unnecessary.</span></span> <span data-ttu-id="37b16-771">Значение категории должно отличаться только из других категорий, а не от всех других <xref:System.Guid> значения.</span><span class="sxs-lookup"><span data-stu-id="37b16-771">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="37b16-772">Например, можно назначить {00000000-0000-0000-0000-000000000001} как <xref:System.Messaging.MessageQueue.Category%2A> для одного набора очередей и {00000000-0000-0000-0000-000000000002} как <xref:System.Messaging.MessageQueue.Category%2A> для другого набора.</span><span class="sxs-lookup"><span data-stu-id="37b16-772">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="37b16-773">Нет необходимости задать <xref:System.Messaging.MessageQueue.Category%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-773">It is not necessary to set the <xref:System.Messaging.MessageQueue.Category%2A>.</span></span> <span data-ttu-id="37b16-774">Допускается значение `null`.</span><span class="sxs-lookup"><span data-stu-id="37b16-774">The value can be `null`.</span></span>  
  
 <span data-ttu-id="37b16-775">Задание этого свойства изменяет очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-775">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="37b16-776">Таким образом, любой другой <xref:System.Messaging.MessageQueue> экземпляры будут затронуты данным изменением.</span><span class="sxs-lookup"><span data-stu-id="37b16-776">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="37b16-777">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-777">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-778">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-778">Workgroup mode</span></span>|<span data-ttu-id="37b16-779">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-779">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-780">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-780">Local computer</span></span>|<span data-ttu-id="37b16-781">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-781">Yes</span></span>|  
|<span data-ttu-id="37b16-782">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-782">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-783">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-783">Yes</span></span>|  
|<span data-ttu-id="37b16-784">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-784">Remote computer</span></span>|<span data-ttu-id="37b16-785">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-785">No</span></span>|  
|<span data-ttu-id="37b16-786">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-786">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-787">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-787">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-788">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.Category%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-788">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Category%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-789">Для категории очереди задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="37b16-789">The queue category was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-790">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-790">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Id" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ClearConnectionCache">
      <MemberSignature Language="C#" Value="public static void ClearConnectionCache ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ClearConnectionCache() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ClearConnectionCache ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ClearConnectionCache();" />
      <MemberSignature Language="F#" Value="static member ClearConnectionCache : unit -&gt; unit" Usage="System.Messaging.MessageQueue.ClearConnectionCache " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-791">Очищает кэш подключений.</span><span class="sxs-lookup"><span data-stu-id="37b16-791">Clears the connection cache.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-792">При вызове <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, удаляются имена форматов, хранящиеся в кэше и закрытия дескрипторов открытые и хранящиеся в кэше.</span><span class="sxs-lookup"><span data-stu-id="37b16-792">When you call <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, the format names stored in the cache are removed and handles opened and stored in the cache are closed.</span></span>  
  
 <span data-ttu-id="37b16-793">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-793">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-794">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-794">Workgroup mode</span></span>|<span data-ttu-id="37b16-795">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-795">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-796">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-796">Local computer</span></span>|<span data-ttu-id="37b16-797">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-797">Yes</span></span>|  
|<span data-ttu-id="37b16-798">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-798">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-799">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-799">Yes</span></span>|  
|<span data-ttu-id="37b16-800">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-800">Remote computer</span></span>|<span data-ttu-id="37b16-801">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-801">Yes</span></span>|  
|<span data-ttu-id="37b16-802">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-802">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-803">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-803">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-804">В приведенном ниже примере кода вызывается <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-804">The following code example calls <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span></span>  
  
 [!code-csharp[MessageQueue#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="messageQueue.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-805">Освобождает все ресурсы, выделенные классом <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-805">Frees all resources allocated by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-806"><xref:System.Messaging.MessageQueue.Close%2A> Освобождает все ресурсы, связанные с <xref:System.Messaging.MessageQueue>, включая общие ресурсы, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-806"><xref:System.Messaging.MessageQueue.Close%2A> frees all resources associated with a <xref:System.Messaging.MessageQueue>, including shared resources if appropriate.</span></span> <span data-ttu-id="37b16-807">Система возвращает себе ресурсы автоматически, если они по-прежнему доступны, например при вызове <xref:System.Messaging.MessageQueue.Send%28System.Object%29> метода, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="37b16-807">The system re-acquires these resources automatically if they are still available, for example when you call the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method, as in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.Send("Text 1.");  
myMessageQueue.Close();  
myMessageQueue.Send("Text 2."); //Resources are re-acquired.  
```  
  
 <span data-ttu-id="37b16-808">При вызове <xref:System.Messaging.MessageQueue.Close%2A>, что все <xref:System.Messaging.MessageQueue> свойства, которые напрямую обращаются к очереди Message Queuing, очищаются. <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, И <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> все остается прежним.</span><span class="sxs-lookup"><span data-stu-id="37b16-808">When you call <xref:System.Messaging.MessageQueue.Close%2A>, all <xref:System.Messaging.MessageQueue> properties that directly access the Message Queuing queue are cleared out. The <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, and <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> all remain as they were.</span></span>  
  
 <span data-ttu-id="37b16-809"><xref:System.Messaging.MessageQueue.Close%2A> не всегда освободить чтения и записи в очередь, так как они могут быть общими.</span><span class="sxs-lookup"><span data-stu-id="37b16-809"><xref:System.Messaging.MessageQueue.Close%2A> does not always free the read and write handles to a queue, because they might be shared.</span></span> <span data-ttu-id="37b16-810">Вы можете использовать любую из следующих действий, чтобы убедиться, что <xref:System.Messaging.MessageQueue.Close%2A> освобождает дескрипторы чтения и записи в очередь:</span><span class="sxs-lookup"><span data-stu-id="37b16-810">You can take any of the following steps to ensure that <xref:System.Messaging.MessageQueue.Close%2A> frees the read and write handles to a queue:</span></span>  
  
-   <span data-ttu-id="37b16-811">Создание <xref:System.Messaging.MessageQueue> с монопольным доступом.</span><span class="sxs-lookup"><span data-stu-id="37b16-811">Create the <xref:System.Messaging.MessageQueue> with exclusive access.</span></span> <span data-ttu-id="37b16-812">Чтобы сделать это, вызовите <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> или <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> конструктора, а набора `sharedModeDenyReceive` параметр `true`.</span><span class="sxs-lookup"><span data-stu-id="37b16-812">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> or <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor, and set the `sharedModeDenyReceive` parameter to `true`.</span></span>  
  
-   <span data-ttu-id="37b16-813">Создание <xref:System.Messaging.MessageQueue> с отключенным кэшированием подключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-813">Create the <xref:System.Messaging.MessageQueue> with connection caching disabled.</span></span> <span data-ttu-id="37b16-814">Чтобы сделать это, вызовите <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> конструктора и задайте `enableConnectionCache` параметр `false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-814">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor and set the `enableConnectionCache` parameter to `false`.</span></span>  
  
-   <span data-ttu-id="37b16-815">Отключите кэширование подключений.</span><span class="sxs-lookup"><span data-stu-id="37b16-815">Disable connection caching.</span></span> <span data-ttu-id="37b16-816">Чтобы сделать это, установите <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> свойства `false`.</span><span class="sxs-lookup"><span data-stu-id="37b16-816">To do so, set the <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property to `false`.</span></span>  
  
 <span data-ttu-id="37b16-817">Следует вызывать <xref:System.Messaging.MessageQueue.Close%2A> для очереди, прежде чем удалить очередь на сервер очередей сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-817">You should call <xref:System.Messaging.MessageQueue.Close%2A> for a queue before you delete the queue on the Message Queuing server.</span></span> <span data-ttu-id="37b16-818">В противном случае сообщения, отправленные в очередь может вызывать исключения или появиться в очереди недоставленных.</span><span class="sxs-lookup"><span data-stu-id="37b16-818">Otherwise, messages sent to the queue could throw exceptions or appear in the dead-letter queue.</span></span>  
  
 <span data-ttu-id="37b16-819">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-819">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-820">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-820">Workgroup mode</span></span>|<span data-ttu-id="37b16-821">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-821">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-822">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-822">Local computer</span></span>|<span data-ttu-id="37b16-823">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-823">Yes</span></span>|  
|<span data-ttu-id="37b16-824">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-824">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-825">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-825">Yes</span></span>|  
|<span data-ttu-id="37b16-826">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-826">Remote computer</span></span>|<span data-ttu-id="37b16-827">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-827">Yes</span></span>|  
|<span data-ttu-id="37b16-828">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-828">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-829">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-829">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-830">В следующем примере кода закрывает очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-830">The following code example closes a Message Queuing queue.</span></span>  
  
 [!code-cpp[MessageQueue.Close#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Close/CPP/mqclose.cpp#1)]
 [!code-csharp[MessageQueue.Close#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Close/CS/mqclose.cs#1)]
 [!code-vb[MessageQueue.Close#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Close/VB/mqclose.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Create">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-831">Создает новую очередь на сервере очереди сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-831">Creates a new queue at the specified path on a Message Queuing server.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Create : string -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-832">Путь создаваемой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-832">The path of the queue to create.</span></span></param>
        <summary><span data-ttu-id="37b16-833">Создает нетранзакционную очередь сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-833">Creates a non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="37b16-834">Класс <see cref="T:System.Messaging.MessageQueue" />, представляющий новую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-834">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-835">Используйте этот перегруженный метод, чтобы создать нетранзакционную очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-835">Use this overload to create a non-transactional Message Queuing queue.</span></span>  
  
 <span data-ttu-id="37b16-836">Чтобы создать новый экземпляр класса <xref:System.Messaging.MessageQueue> класса в приложении и привязать его к существующей очереди, используйте <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор.</span><span class="sxs-lookup"><span data-stu-id="37b16-836">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="37b16-837">Чтобы создать новую очередь в очереди сообщений, вызовите <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-837">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="37b16-838">Синтаксис `path` параметр зависит от типа очереди он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-838">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-839">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-839">Queue type</span></span>|<span data-ttu-id="37b16-840">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-840">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-841">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-841">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-842">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-842">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="37b16-843">Используйте «.» для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="37b16-843">Use "." for the local computer.</span></span> <span data-ttu-id="37b16-844">Дополнительные сведения о синтаксисе см. в разделе <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-844">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="37b16-845">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-845">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-846">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-846">Workgroup mode</span></span>|<span data-ttu-id="37b16-847">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-847">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-848">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-848">Local computer</span></span>|<span data-ttu-id="37b16-849">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-849">Yes</span></span>|  
|<span data-ttu-id="37b16-850">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-850">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-851">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-851">Yes</span></span>|  
|<span data-ttu-id="37b16-852">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-852">Remote computer</span></span>|<span data-ttu-id="37b16-853">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-853">No</span></span>|  
|<span data-ttu-id="37b16-854">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-854">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-855">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-855">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-856">В следующем примере кода создается общая и частная очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-856">The following code example creates public and private queues.</span></span> <span data-ttu-id="37b16-857">Он отправляет сообщение в выбранной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-857">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_path/CPP/mqcreate.cpp#1)]
 [!code-csharp[MessageQueue.Create_path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_path/CS/mqcreate.cs#1)]
 [!code-vb[MessageQueue.Create_path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_path/VB/mqcreate.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-858">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="37b16-858">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-859">По указанному пути уже существует очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-859">A queue already exists at the specified path.</span></span>  
  
<span data-ttu-id="37b16-860">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-860">-or-</span></span> 
<span data-ttu-id="37b16-861">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-861">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path, bool transactional);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path, bool transactional) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String, transactional As Boolean) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path, bool transactional);" />
      <MemberSignature Language="F#" Value="static member Create : string * bool -&gt; System.Messaging.MessageQueue" Usage="System.Messaging.MessageQueue.Create (path, transactional)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="transactional" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-862">Путь создаваемой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-862">The path of the queue to create.</span></span></param>
        <param name="transactional"><span data-ttu-id="37b16-863">Значение <see langword="true" />, если необходимо создать транзакционную очередь; значение <see langword="false" />, если необходимо создать нетранзакционную очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-863"><see langword="true" /> to create a transactional queue; <see langword="false" /> to create a non-transactional queue.</span></span></param>
        <summary><span data-ttu-id="37b16-864">Создает транзакционную или нетранзакционную очередь сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-864">Creates a transactional or non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="37b16-865">Класс <see cref="T:System.Messaging.MessageQueue" />, представляющий новую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-865">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-866">Эта перегрузка можно использовать для создания транзакционной очереди в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-866">You can use this overload to create a transactional queue in Message Queuing.</span></span> <span data-ttu-id="37b16-867">Можно создать нетранзакционную очередь, задав `transactional` параметр `false` или путем вызова другой перегрузкой <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-867">You can create a non-transactional queue, by setting the `transactional` parameter to `false` or by calling the other overload of <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="37b16-868">Чтобы создать новый экземпляр класса <xref:System.Messaging.MessageQueue> класса в приложении и привязать его к существующей очереди, используйте <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор.</span><span class="sxs-lookup"><span data-stu-id="37b16-868">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="37b16-869">Чтобы создать новую очередь в очереди сообщений, вызовите <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-869">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="37b16-870">Синтаксис `path` параметр зависит от типа очереди он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-870">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-871">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-871">Queue type</span></span>|<span data-ttu-id="37b16-872">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-872">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-873">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-873">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-874">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-874">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="37b16-875">Используйте «.» для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="37b16-875">Use "." for the local computer.</span></span> <span data-ttu-id="37b16-876">Дополнительные сведения о синтаксисе см. в разделе <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-876">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="37b16-877">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-877">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-878">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-878">Workgroup mode</span></span>|<span data-ttu-id="37b16-879">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-879">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-880">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-880">Local computer</span></span>|<span data-ttu-id="37b16-881">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-881">Yes</span></span>|  
|<span data-ttu-id="37b16-882">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-882">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-883">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-883">Yes</span></span>|  
|<span data-ttu-id="37b16-884">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-884">Remote computer</span></span>|<span data-ttu-id="37b16-885">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-885">No</span></span>|  
|<span data-ttu-id="37b16-886">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-886">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-887">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-887">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-888">В следующем примере кода создается общедоступные и частные очереди транзакций.</span><span class="sxs-lookup"><span data-stu-id="37b16-888">The following code example creates public and private transactional queues.</span></span> <span data-ttu-id="37b16-889">Он отправляет сообщение в выбранной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-889">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CPP/mqcreate_transactional.cpp#1)]
 [!code-csharp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CS/mqcreate_transactional.cs#1)]
 [!code-vb[MessageQueue.Create_PathTransactional#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/VB/mqcreate_transactional.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-890">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="37b16-890">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-891">По указанному пути уже существует очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-891">A queue already exists at the specified path.</span></span>  
  
<span data-ttu-id="37b16-892">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-892">-or-</span></span> 
<span data-ttu-id="37b16-893">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-893">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
      </Docs>
    </Member>
    <Member MemberName="CreateCursor">
      <MemberSignature Language="C#" Value="public System.Messaging.Cursor CreateCursor ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Cursor CreateCursor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.CreateCursor" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateCursor () As Cursor" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Cursor ^ CreateCursor();" />
      <MemberSignature Language="F#" Value="member this.CreateCursor : unit -&gt; System.Messaging.Cursor" Usage="messageQueue.CreateCursor " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Cursor</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-894">Создает новый объект <see cref="T:System.Messaging.Cursor" /> для текущей очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-894">Creates a new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-895">Новый объект <see cref="T:System.Messaging.Cursor" /> для текущей очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-895">A new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span> <span data-ttu-id="37b16-896">Этот курсор используется для сохранения определенного положения в очереди при чтении сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-896">This cursor is used to maintain a specific location in the queue when reading the queue's messages.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Messaging.Cursor" />
      </Docs>
    </Member>
    <Member MemberName="CreateTime">
      <MemberSignature Language="C#" Value="public DateTime CreateTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime CreateTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CreateTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CreateTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime CreateTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.CreateTime : DateTime" Usage="System.Messaging.MessageQueue.CreateTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_CreateTime")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-897">Получает время и дату создания очереди в службе очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-897">Gets the time and date that the queue was created in Message Queuing.</span></span></summary>
        <value><span data-ttu-id="37b16-898">Объект <see cref="T:System.DateTime" /> представляющий дату и время создания очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-898">A <see cref="T:System.DateTime" /> that represents the date and time at which the queue was created.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> не относится к очереди на сервере очереди сообщений, <xref:System.Messaging.MessageQueue> экземпляра.</span><span class="sxs-lookup"><span data-stu-id="37b16-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> refers to the queue on the Message Queuing server, not the <xref:System.Messaging.MessageQueue> instance.</span></span>  
  
 <span data-ttu-id="37b16-900">Если очередь существует, это свойство представляет время создания очереди, корректируется в местное время сервера, на котором существует очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-900">If the queue exists, this property represents the time the queue was created, adjusted to the local time of the server on which the queue exists.</span></span>  
  
 <span data-ttu-id="37b16-901">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-901">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-902">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-902">Workgroup mode</span></span>|<span data-ttu-id="37b16-903">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-903">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-904">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-904">Local computer</span></span>|<span data-ttu-id="37b16-905">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-905">Yes</span></span>|  
|<span data-ttu-id="37b16-906">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-906">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-907">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-907">Yes</span></span>|  
|<span data-ttu-id="37b16-908">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-908">Remote computer</span></span>|<span data-ttu-id="37b16-909">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-909">No</span></span>|  
|<span data-ttu-id="37b16-910">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-910">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-911">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-911">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-912">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.CreateTime%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-912">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CreateTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-913">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-913">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.LastModifyTime" />
      </Docs>
    </Member>
    <Member MemberName="DefaultPropertiesToSend">
      <MemberSignature Language="C#" Value="public System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberSignature Language="VB.NET" Value="Public Property DefaultPropertiesToSend As DefaultPropertiesToSend" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::DefaultPropertiesToSend ^ DefaultPropertiesToSend { System::Messaging::DefaultPropertiesToSend ^ get(); void set(System::Messaging::DefaultPropertiesToSend ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DefaultPropertiesToSend : System.Messaging.DefaultPropertiesToSend with get, set" Usage="System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DefaultPropertiesToSend")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.DefaultPropertiesToSend</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-914">Получает или задает значения свойств сообщения, которые будут использоваться по умолчанию, когда приложение будет отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-914">Gets or sets the message property values to be used by default when the application sends messages to the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-915">Свойство <see cref="T:System.Messaging.DefaultPropertiesToSend" />, содержащее используемые по умолчанию значения свойств сообщений очереди сообщений, которые применяются, когда приложение отправляет в очередь объекты, отличные от экземпляров <see cref="T:System.Messaging.Message" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-915">A <see cref="T:System.Messaging.DefaultPropertiesToSend" /> that contains the default Message Queuing message property values used when the application sends objects other than <see cref="T:System.Messaging.Message" /> instances to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-916">При отправке любой объект, который не относится к типу <xref:System.Messaging.Message> в очередь <xref:System.Messaging.MessageQueue> вставляет объект в сообщение очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-916">When you send any object that is not of type <xref:System.Messaging.Message> to the queue, the <xref:System.Messaging.MessageQueue> inserts the object into a Message Queuing message.</span></span> <span data-ttu-id="37b16-917">В этот момент <xref:System.Messaging.MessageQueue> применяет к сообщению значения свойств, заданные вами в <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-917">At that time, the <xref:System.Messaging.MessageQueue> applies to the message the property values you specify in the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property.</span></span> <span data-ttu-id="37b16-918">И наоборот при отправке <xref:System.Messaging.Message> в очередь, эти свойства уже заданы для самого экземпляра, поэтому <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> учитывается для <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-918">Conversely, if you send a <xref:System.Messaging.Message> to the queue, these properties are already specified for the instance itself, so <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> is ignored for the <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="37b16-919">Несмотря на то, что вы задали свойства через <xref:System.Messaging.MessageQueue> объекта, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> ссылается на свойства сообщений, отправленных в очередь, а не к самой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-919">Although you set the properties through the <xref:System.Messaging.MessageQueue> object, the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> refers to the properties of the messages that are sent to the queue, not the queue itself.</span></span>  
  
 <span data-ttu-id="37b16-920">В следующей таблице показаны значения по умолчанию для свойства.</span><span class="sxs-lookup"><span data-stu-id="37b16-920">The default values for the properties are shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-921">Свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-921">Property</span></span>|<span data-ttu-id="37b16-922">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="37b16-922">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.DefaultPropertiesToSend.AcknowledgeType%2A>|`AcknowledgeType.None`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AdministrationQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AppSpecific%2A>|<span data-ttu-id="37b16-923">Ноль (0)</span><span class="sxs-lookup"><span data-stu-id="37b16-923">Zero (0)</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.AttachSenderId%2A>|`true`|  
|<xref:System.Messaging.DefaultPropertiesToSend.EncryptionAlgorithm%2A>|`EncryptionAlgorithm.RC2`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Extension%2A>|<span data-ttu-id="37b16-924">Массив байтов нулевой длины</span><span class="sxs-lookup"><span data-stu-id="37b16-924">A zero-length array of bytes</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.HashAlgorithm%2A>|`HashAlgorithm.MD5`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Label%2A>|<span data-ttu-id="37b16-925">пустая строка (»»)</span><span class="sxs-lookup"><span data-stu-id="37b16-925">Empty string ("")</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.Priority%2A>|`MessagePriority.Normal`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Recoverable%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.ResponseQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToBeReceived%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToReachQueue%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TransactionStatusQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="37b16-926">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-926">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-927">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-927">Workgroup mode</span></span>|<span data-ttu-id="37b16-928">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-928">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-929">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-929">Local computer</span></span>|<span data-ttu-id="37b16-930">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-930">Yes</span></span>|  
|<span data-ttu-id="37b16-931">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-931">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-932">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-932">Yes</span></span>|  
|<span data-ttu-id="37b16-933">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-933">Remote computer</span></span>|<span data-ttu-id="37b16-934">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-934">Yes</span></span>|  
|<span data-ttu-id="37b16-935">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-935">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-936">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-936">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-937">В следующем примере кода использует приоритет сообщения, чтобы определить свойства по умолчанию для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-937">The following code example uses the priority of a message to determine default properties to send for the message.</span></span>  
  
 [!code-cpp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CPP/mqdefaultpropertiestosend.cpp#1)]
 [!code-csharp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CS/mqdefaultpropertiestosend.cs#1)]
 [!code-vb[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/VB/mqdefaultpropertiestosend.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-938">Для очереди нельзя задать использующиеся по умолчанию свойства. Возможно, потому что неправильно задано одно из свойств.</span><span class="sxs-lookup"><span data-stu-id="37b16-938">The default properties could not be set for the queue, possibly because one of the properties is not valid.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.AcknowledgeTypes" />
        <altmember cref="T:System.Messaging.EncryptionAlgorithm" />
        <altmember cref="T:System.Messaging.HashAlgorithm" />
        <altmember cref="F:System.Messaging.Message.InfiniteTimeout" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Messaging.MessageQueue.Delete path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-939">Расположение удаляемой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-939">The location of the queue to be deleted.</span></span></param>
        <summary><span data-ttu-id="37b16-940">Удаляет очередь с сервера очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-940">Deletes a queue on a Message Queuing server.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-941">Синтаксис `path` параметр зависит от типа очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-941">The syntax for the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="37b16-942">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-942">Queue type</span></span>|<span data-ttu-id="37b16-943">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-943">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-944">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-944">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-945">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-945">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="37b16-946">Дополнительные сведения о синтаксисе см. в разделе <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-946">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="37b16-947">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-947">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="37b16-948">Ссылка</span><span class="sxs-lookup"><span data-stu-id="37b16-948">Reference</span></span>|<span data-ttu-id="37b16-949">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-949">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="37b16-950">Название формата</span><span class="sxs-lookup"><span data-stu-id="37b16-950">Format name</span></span>|<span data-ttu-id="37b16-951">FormatName: [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-951">FormatName:[ *format name* ]</span></span>|  
|<span data-ttu-id="37b16-952">Метка</span><span class="sxs-lookup"><span data-stu-id="37b16-952">Label</span></span>|<span data-ttu-id="37b16-953">Метка: [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-953">Label:[ *label* ]</span></span>|  
  
 <span data-ttu-id="37b16-954">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-954">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-955">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-955">Workgroup mode</span></span>|<span data-ttu-id="37b16-956">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-956">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-957">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-957">Local computer</span></span>|<span data-ttu-id="37b16-958">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-958">Yes</span></span>|  
|<span data-ttu-id="37b16-959">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-959">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-960">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-960">Yes</span></span>|  
|<span data-ttu-id="37b16-961">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-961">Remote computer</span></span>|<span data-ttu-id="37b16-962">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-962">No</span></span>|  
|<span data-ttu-id="37b16-963">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-963">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-964">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-964">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-965">В следующем примере кода удаляет очередь MSMQ, если он существует.</span><span class="sxs-lookup"><span data-stu-id="37b16-965">The following code example deletes a Message Queuing queue, if it exists.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-966">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="37b16-966">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-967">Для параметра <paramref name="path" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="37b16-967">The syntax for the <paramref name="path" /> parameter is not valid.</span></span>  
  
<span data-ttu-id="37b16-968">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-968">-or-</span></span> 
<span data-ttu-id="37b16-969">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-969">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="DenySharedReceive">
      <MemberSignature Language="C#" Value="public bool DenySharedReceive { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DenySharedReceive" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberSignature Language="VB.NET" Value="Public Property DenySharedReceive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DenySharedReceive { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.DenySharedReceive : bool with get, set" Usage="System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_DenySharedReceive")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-970">Получает или задает значение, показывающее, имеет ли этот объект <see cref="T:System.Messaging.MessageQueue" /> монопольный доступ на получение сообщений из очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-970">Gets or sets a value that indicates whether this <see cref="T:System.Messaging.MessageQueue" /> has exclusive access to receive messages from the Message Queuing queue.</span></span></summary>
        <value><span data-ttu-id="37b16-971">Значение <see langword="true" />, если этот класс <see cref="T:System.Messaging.MessageQueue" /> имеет права монопольного доступа для получения сообщений из очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-971"><see langword="true" /> if this <see cref="T:System.Messaging.MessageQueue" /> has exclusive rights to receive messages from the queue; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="37b16-972">Значение по умолчанию — <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-972">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> Указывает режим общей очереди, на которое указывает данный <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> specifies the shared mode of the queue referenced by this <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-974">Задайте <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> для `true` , только это <xref:System.Messaging.MessageQueue> должны иметь доступ к считывания и получения сообщений из очереди с указанным <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-974">Set <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> to `true` to indicate that only this <xref:System.Messaging.MessageQueue> should have access to peek or receive messages from the queue with the specified <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="37b16-975">Если другой <xref:System.Messaging.MessageQueue> или другое приложение связано с тем же ресурсом очереди, этот экземпляр или приложение не сможет просматривать и получать сообщения, но он по-прежнему можете отправить им.</span><span class="sxs-lookup"><span data-stu-id="37b16-975">If another <xref:System.Messaging.MessageQueue> or another application is associated with the same queue resource, that instance or application will not be able to peek or receive messages, but it can still send them.</span></span>  
  
 <span data-ttu-id="37b16-976">Если <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> является `false`, очередь доступна для нескольких приложений для отправки, считывании и приеме сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-976">If <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> is `false`, the queue is available to multiple applications for sending, peeking, or receiving messages.</span></span>  
  
 <span data-ttu-id="37b16-977">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-977">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-978">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-978">Workgroup mode</span></span>|<span data-ttu-id="37b16-979">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-979">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-980">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-980">Local computer</span></span>|<span data-ttu-id="37b16-981">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-981">Yes</span></span>|  
|<span data-ttu-id="37b16-982">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-982">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-983">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-983">Yes</span></span>|  
|<span data-ttu-id="37b16-984">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-984">Remote computer</span></span>|<span data-ttu-id="37b16-985">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-985">Yes</span></span>|  
|<span data-ttu-id="37b16-986">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-986">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-987">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-987">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-988">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-988">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="messageQueue.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing"><span data-ttu-id="37b16-989">Значение <see langword="true" /> позволяет освободить управляемые и неуправляемые ресурсы; значение <see langword="false" /> позволяет освободить только неуправляемые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="37b16-989"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="37b16-990">Уничтожает ресурсы (кроме памяти), используемые классом <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-990">Disposes of the resources (other than memory) used by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-991">Вызовите метод <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> по окончании использования класса <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-991">Call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> when you are finished using the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-992">Метод <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> оставляет класс <xref:System.Messaging.MessageQueue> в непригодном для использования состоянии.</span><span class="sxs-lookup"><span data-stu-id="37b16-992">The <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> method leaves the <xref:System.Messaging.MessageQueue> in an unusable state.</span></span> <span data-ttu-id="37b16-993">После вызова метода <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, необходимо освободить все ссылки на <xref:System.Messaging.MessageQueue> , занимаемая ими память может быть освобожден при коллекцией мусора.</span><span class="sxs-lookup"><span data-stu-id="37b16-993">After calling <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, you must release all references to the <xref:System.Messaging.MessageQueue> so the memory it was occupying can be reclaimed by garbage collection.</span></span>  
  
 <span data-ttu-id="37b16-994">Следует вызывать <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> перед освобождением последней ссылки на <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-994">You should call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> before you release your last reference to the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-995">В противном случае ресурсы <xref:System.Messaging.MessageQueue> является не будут освобождены до сборки мусора не будет <xref:System.Messaging.MessageQueue> вызов деструктора объекта основы.</span><span class="sxs-lookup"><span data-stu-id="37b16-995">Otherwise, the resources the <xref:System.Messaging.MessageQueue> is using will not be freed until garbage collection calls the <xref:System.Messaging.MessageQueue> object's destructor.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <Member MemberName="EnableConnectionCache">
      <MemberSignature Language="C#" Value="public static bool EnableConnectionCache { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool EnableConnectionCache" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property EnableConnectionCache As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool EnableConnectionCache { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableConnectionCache : bool with get, set" Usage="System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-996">Получает или задает значение, указывающее, будет ли приложение поддерживать кэш подключений.</span><span class="sxs-lookup"><span data-stu-id="37b16-996">Gets or sets a value that indicates whether a cache of connections will be maintained by the application.</span></span></summary>
        <value><span data-ttu-id="37b16-997">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-997"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-998">Кэш подключений приведен список ссылок на структуры, содержащие чтения или записи в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-998">A connection cache is a list of references to structures that contain read or write handles to queues.</span></span> <span data-ttu-id="37b16-999">Когда <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> — `true`, <xref:System.Messaging.MessageQueue> заимствует маркеры из кэша при каждом вызове <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, или <xref:System.Messaging.MessageQueue.Receive%2A>, вместо того чтобы открытых дескрипторов на новый.</span><span class="sxs-lookup"><span data-stu-id="37b16-999">When <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> is `true`, the <xref:System.Messaging.MessageQueue> borrows handles from the cache each time you call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, rather than open new handles.</span></span> <span data-ttu-id="37b16-1000">Это может повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="37b16-1000">This can improve performance.</span></span> <span data-ttu-id="37b16-1001">Использование кэша подключений также изолирует <xref:System.Messaging.MessageQueue> от изменений в топологии сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1001">Using a connection cache also insulates the <xref:System.Messaging.MessageQueue> from changes in the network topology.</span></span>  
  
 <span data-ttu-id="37b16-1002">Если создать его в очередь при заполнении, кэш подключений <xref:System.Messaging.MessageQueue> перезаписывает структуре бы недавно использовавшихся на новое подключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1002">If you create a new connection to a queue when the connection cache is full, the <xref:System.Messaging.MessageQueue> overwrites the least recently accessed structure with the new connection.</span></span> <span data-ttu-id="37b16-1003">Вы можете очистить кэш полностью путем вызова <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, например, если формат имена очередей, вы работаете с были изменены, чтобы предыдущие чтения и записи, дескрипторы становятся недействительными.</span><span class="sxs-lookup"><span data-stu-id="37b16-1003">You can clear the cache entirely by calling <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, for example, if the format names of the queues you are working with have changed so that the previous read and write handles are no longer valid.</span></span>  
  
 <span data-ttu-id="37b16-1004">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1004">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1005">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1005">Workgroup mode</span></span>|<span data-ttu-id="37b16-1006">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1006">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1007">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1007">Local computer</span></span>|<span data-ttu-id="37b16-1008">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1008">Yes</span></span>|  
|<span data-ttu-id="37b16-1009">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1009">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1010">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1010">Yes</span></span>|  
|<span data-ttu-id="37b16-1011">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1011">Remote computer</span></span>|<span data-ttu-id="37b16-1012">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1012">Yes</span></span>|  
|<span data-ttu-id="37b16-1013">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1013">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1014">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1014">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1015">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1015">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="EncryptionRequired">
      <MemberSignature Language="C#" Value="public System.Messaging.EncryptionRequired EncryptionRequired { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.EncryptionRequired EncryptionRequired" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberSignature Language="VB.NET" Value="Public Property EncryptionRequired As EncryptionRequired" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::EncryptionRequired EncryptionRequired { System::Messaging::EncryptionRequired get(); void set(System::Messaging::EncryptionRequired value); };" />
      <MemberSignature Language="F#" Value="member this.EncryptionRequired : System.Messaging.EncryptionRequired with get, set" Usage="System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_EncryptionRequired")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.EncryptionRequired</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1016">Получает или задает значение, указывающее, будет ли очередь принимать только неконфиденциальные (незашифрованные) сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1016">Gets or sets a value that indicates whether the queue accepts only non-private (non-encrypted) messages.</span></span></summary>
        <value><span data-ttu-id="37b16-1017">Одно из значений <see cref="T:System.Messaging.EncryptionRequired" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1017">One of the <see cref="T:System.Messaging.EncryptionRequired" /> values.</span></span> <span data-ttu-id="37b16-1018">Значение по умолчанию — <see langword="None" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1018">The default is <see langword="None" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1019">При указании, что шифрование является обязательным для сообщений, отправленных в очередь, шифруются только тела сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1019">When you specify that encryption is required for the messages sent to a queue, only the message bodies are encrypted.</span></span> <span data-ttu-id="37b16-1020">Другие элементы (например, <xref:System.Messaging.Message.Label%2A> и <xref:System.Messaging.Message.SenderId%2A> свойства) не могут быть зашифрованы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1020">The other members (for example, the <xref:System.Messaging.Message.Label%2A> and <xref:System.Messaging.Message.SenderId%2A> properties) cannot be encrypted.</span></span>  
  
 <span data-ttu-id="37b16-1021">Задание этого свойства изменяет очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-1021">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="37b16-1022">Таким образом, любой другой <xref:System.Messaging.MessageQueue> экземпляры будут затронуты данным изменением.</span><span class="sxs-lookup"><span data-stu-id="37b16-1022">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="37b16-1023">Шифрование сообщения делает закрытого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1023">Encrypting a message makes the message private.</span></span> <span data-ttu-id="37b16-1024">Можно указать требования шифрования очереди `None`, `Body`, или `Optional` , задав <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> свойство соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="37b16-1024">You can specify the queue's encryption requirement to be `None`, `Body`, or `Optional` by setting the <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property appropriately.</span></span> <span data-ttu-id="37b16-1025"><xref:System.Messaging.Message.UseEncryption%2A> Сообщение должно соответствовать требования шифрования очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1025">The <xref:System.Messaging.Message.UseEncryption%2A> setting of the message must correspond to the encryption requirement of the queue.</span></span> <span data-ttu-id="37b16-1026">Если сообщение не зашифровано, но в очереди указана `Body`, или если сообщение зашифровано, но в очереди указана `None`, сообщение не принято по очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1026">If the message is not encrypted but the queue specifies `Body`, or if the message is encrypted but the queue specifies `None`, the message is rejected by the queue.</span></span> <span data-ttu-id="37b16-1027">Если отправляющее приложение запрашивает сообщение отрицательного подтверждения в этом событии, очереди сообщений указывает, что сообщение было отвергнуто в передающее приложение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1027">If the sending application requests a negative acknowledgment message in this event, Message Queuing indicates the message's rejection to the sending application.</span></span> <span data-ttu-id="37b16-1028">Если <xref:System.Messaging.Message.UseDeadLetterQueue%2A> свойство `true`, сообщение, которое происходит сбой шифрования отправляется в очередь недоставленных.</span><span class="sxs-lookup"><span data-stu-id="37b16-1028">If the <xref:System.Messaging.Message.UseDeadLetterQueue%2A> property is `true`, a message that fails encryption is sent to the dead-letter queue.</span></span> <span data-ttu-id="37b16-1029">В противном случае сообщение теряется.</span><span class="sxs-lookup"><span data-stu-id="37b16-1029">Otherwise, the message is lost.</span></span>  
  
 <span data-ttu-id="37b16-1030">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1030">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1031">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1031">Workgroup mode</span></span>|<span data-ttu-id="37b16-1032">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1032">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1033">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1033">Local computer</span></span>|<span data-ttu-id="37b16-1034">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1034">Yes</span></span>|  
|<span data-ttu-id="37b16-1035">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1035">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1036">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1036">Yes</span></span>|  
|<span data-ttu-id="37b16-1037">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1037">Remote computer</span></span>|<span data-ttu-id="37b16-1038">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1038">No</span></span>|  
|<span data-ttu-id="37b16-1039">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1039">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1040">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1040">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1041">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1041">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1042">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1042">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Acknowledgment" />
        <altmember cref="P:System.Messaging.Message.UseEncryption" />
      </Docs>
    </Member>
    <Member MemberName="EndPeek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndPeek (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndPeek(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndPeek(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndPeek (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndPeek(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndPeek : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndPeek asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="37b16-1043">Объект <see cref="T:System.IAsyncResult" />, определяющий асинхронную операцию считывания, которая завершается и из которой извлекается конечный результат.</span><span class="sxs-lookup"><span data-stu-id="37b16-1043">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous peek operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="37b16-1044">Завершает указанную асинхронную операцию считывания.</span><span class="sxs-lookup"><span data-stu-id="37b16-1044">Completes the specified asynchronous peek operation.</span></span></summary>
        <returns><span data-ttu-id="37b16-1045">Класс <see cref="T:System.Messaging.Message" />, связанный с завершенной асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-1045">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1046">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> завершает операцию, которая была начата <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызова.</span><span class="sxs-lookup"><span data-stu-id="37b16-1046">When the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginPeek%2A> call.</span></span> <span data-ttu-id="37b16-1047">Чтобы сделать это, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> считывает сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1047">To do so, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> peeks the message.</span></span>  
  
 <span data-ttu-id="37b16-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> можно указать время ожидания, что приводит к <xref:System.Messaging.MessageQueue.PeekCompleted> событие, создаваемое, если истекло время ожидания до появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="37b16-1049">При возникновении тайм-аута без сообщений, поступающих в очередь, последующий вызов <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> возникло исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1049">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="37b16-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> используется для чтения сообщения, которое вызвало <xref:System.Messaging.MessageQueue.PeekCompleted> возникает событие.</span><span class="sxs-lookup"><span data-stu-id="37b16-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to read the message that caused the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="37b16-1051">Если вы хотите продолжить асинхронный просмотр сообщений, можно снова вызвать метод <xref:System.Messaging.MessageQueue.BeginPeek%2A> после вызова метода <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1051">If you want to continue to asynchronously peek messages, you can again call <xref:System.Messaging.MessageQueue.BeginPeek%2A> after calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-1052">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1052">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1053">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1053">Workgroup mode</span></span>|<span data-ttu-id="37b16-1054">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1054">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1055">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1055">Local computer</span></span>|<span data-ttu-id="37b16-1056">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1056">Yes</span></span>|  
|<span data-ttu-id="37b16-1057">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1057">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1058">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1058">Yes</span></span>|  
|<span data-ttu-id="37b16-1059">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1059">Remote computer</span></span>|<span data-ttu-id="37b16-1060">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1060">No</span></span>|  
|<span data-ttu-id="37b16-1061">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1061">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1062">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1062">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1063">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginPeek%2A> инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="37b16-1063">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="37b16-1064">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события, в примере считывает сообщение и выводит его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-1064">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="37b16-1065">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="37b16-1065">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1066">Параметр <paramref name="asyncResult" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1066">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1067">Для параметра <paramref name="asyncResult" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="37b16-1067">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1068">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1068">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
      </Docs>
    </Member>
    <Member MemberName="EndReceive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndReceive (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndReceive(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndReceive(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndReceive (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndReceive(IAsyncResult ^ asyncResult);" />
      <MemberSignature Language="F#" Value="member this.EndReceive : IAsyncResult -&gt; System.Messaging.Message" Usage="messageQueue.EndReceive asyncResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="37b16-1069">Объект <see cref="T:System.IAsyncResult" />, определяющий асинхронную операцию получения, которая завершается и из которой извлекается конечный результат.</span><span class="sxs-lookup"><span data-stu-id="37b16-1069">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous receive operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="37b16-1070">Завершает указанную асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1070">Completes the specified asynchronous receive operation.</span></span></summary>
        <returns><span data-ttu-id="37b16-1071">Класс <see cref="T:System.Messaging.Message" />, связанный с завершенной асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-1071">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1072">Когда <xref:System.Messaging.MessageQueue.ReceiveCompleted> события <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> завершает операцию, которая была начата <xref:System.Messaging.MessageQueue.BeginReceive%2A> вызова.</span><span class="sxs-lookup"><span data-stu-id="37b16-1072">When the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginReceive%2A> call.</span></span> <span data-ttu-id="37b16-1073">Чтобы сделать это, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> получает сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1073">To do so, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> receives the message.</span></span>  
  
 <span data-ttu-id="37b16-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> можно указать время ожидания, что приводит к <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, создаваемое, если истекло время ожидания до появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="37b16-1075">При возникновении тайм-аута без сообщений, поступающих в очередь, последующий вызов <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> возникло исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1075">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="37b16-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> используется для чтения (удаление из очереди) сообщения, которое вызвало <xref:System.Messaging.MessageQueue.ReceiveCompleted> возникает событие.</span><span class="sxs-lookup"><span data-stu-id="37b16-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to read (removing from the queue) the message that caused the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="37b16-1077">Если вы хотите продолжить асинхронное получение сообщений, можно снова вызвать метод <xref:System.Messaging.MessageQueue.BeginReceive%2A> после вызова метода <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1077">If you want to continue to asynchronously receive messages, you can again call <xref:System.Messaging.MessageQueue.BeginReceive%2A> after calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="37b16-1078">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1078">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1079">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1079">Workgroup mode</span></span>|<span data-ttu-id="37b16-1080">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1080">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1081">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1081">Local computer</span></span>|<span data-ttu-id="37b16-1082">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1082">Yes</span></span>|  
|<span data-ttu-id="37b16-1083">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1083">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1084">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1084">Yes</span></span>|  
|<span data-ttu-id="37b16-1085">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1085">Remote computer</span></span>|<span data-ttu-id="37b16-1086">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1086">No</span></span>|  
|<span data-ttu-id="37b16-1087">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1087">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1088">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1088">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1089">В следующем примере кода создается цепочка асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="37b16-1089">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="37b16-1090">Предполагается, что на локальном компьютере, именем «myQueue» очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1090">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="37b16-1091">`Main` Функция начинает асинхронную операцию, которая обрабатывается `MyReceiveCompleted` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1091">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="37b16-1092">`MyReceiveCompleted` обрабатывает текущее сообщение и начинает новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1092">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1093">Параметр <paramref name="asyncResult" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1093">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1094">Для параметра <paramref name="asyncResult" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="37b16-1094">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1095">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1095">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Messaging.MessageQueue.Exists path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="37b16-1096">Расположение искомой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1096">The location of the queue to find.</span></span></param>
        <summary><span data-ttu-id="37b16-1097">Определяет, существует ли по указанному пути очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1097">Determines whether a Message Queuing queue exists at the specified path.</span></span></summary>
        <returns><span data-ttu-id="37b16-1098">Значение <see langword="true" />, если очередь по указанному пути существует; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1098"><see langword="true" /> if a queue with the specified path exists; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1099"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> Метод определяет, существует ли очередь MSMQ по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-1099">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method determines whether a Message Queuing queue exists at a specified path.</span></span> <span data-ttu-id="37b16-1100">Метода не существует. Чтобы определить, существует ли очередь с именем указанного формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-1100">No method exists to determine whether a queue with a specified format name exists.</span></span> <span data-ttu-id="37b16-1101">Дополнительные сведения о синтаксисе имени формата и других формах синтаксиса пути, см. в разделе <xref:System.Messaging.MessageQueue.Path%2A> свойство.)</span><span class="sxs-lookup"><span data-stu-id="37b16-1101">For more information about the format name syntax and other path syntax forms, see the <xref:System.Messaging.MessageQueue.Path%2A> property.)</span></span>  
  
 <span data-ttu-id="37b16-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> является ресурсоемкой операцией.</span><span class="sxs-lookup"><span data-stu-id="37b16-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> is an expensive operation.</span></span> <span data-ttu-id="37b16-1103">Используйте только в том случае, когда это необходимо в приложении.</span><span class="sxs-lookup"><span data-stu-id="37b16-1103">Use it only when it is necessary within the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37b16-1104"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> Метод не поддерживает <xref:System.Messaging.MessageQueue.FormatName%2A> префикс.</span><span class="sxs-lookup"><span data-stu-id="37b16-1104">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method does not support the <xref:System.Messaging.MessageQueue.FormatName%2A> prefix.</span></span>  
  
 <span data-ttu-id="37b16-1105">Синтаксис `path` параметр зависит от типа очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-1105">The syntax for the `path` parameter depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-1106">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1106">Queue type</span></span>|<span data-ttu-id="37b16-1107">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-1107">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-1108">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1108">Public queue</span></span>|`MachineName`\\`QueueName`|  
  
 <span data-ttu-id="37b16-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> нельзя вызывать для проверки существования удаленной частной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> cannot be called to verify the existence of a remote private queue.</span></span>  
  
 <span data-ttu-id="37b16-1110">Дополнительные сведения о синтаксисе см. в разделе <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1110">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="37b16-1111">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1111">Alternatively, you can use the <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="37b16-1112">Ссылка</span><span class="sxs-lookup"><span data-stu-id="37b16-1112">Reference</span></span>|<span data-ttu-id="37b16-1113">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-1113">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="37b16-1114">Метка</span><span class="sxs-lookup"><span data-stu-id="37b16-1114">Label</span></span>|<span data-ttu-id="37b16-1115">Метка: [ `label` ]</span><span class="sxs-lookup"><span data-stu-id="37b16-1115">Label:[ `label` ]</span></span>|  
  
 <span data-ttu-id="37b16-1116">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1116">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1117">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1117">Workgroup mode</span></span>|<span data-ttu-id="37b16-1118">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1118">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1119">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1119">Local computer</span></span>|<span data-ttu-id="37b16-1120">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1120">Yes</span></span>|  
|<span data-ttu-id="37b16-1121">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1121">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1122">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1122">No</span></span>|  
|<span data-ttu-id="37b16-1123">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1123">Remote computer</span></span>|<span data-ttu-id="37b16-1124">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1124">No</span></span>|  
|<span data-ttu-id="37b16-1125">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1125">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1126">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1126">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1127">В следующем примере кода проверяет, существует ли очередь Message Queuing и затем удаляет его.</span><span class="sxs-lookup"><span data-stu-id="37b16-1127">The following code example verifies whether a Message Queuing queue exists, and then deletes it.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1128">Неправильный синтаксис параметра <paramref name="path" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1128">The <paramref name="path" /> syntax is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1129">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1129">An error occurred when accessing a Message Queuing method.</span></span>  
  
<span data-ttu-id="37b16-1130">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-1130">-or-</span></span> 
<span data-ttu-id="37b16-1131">Метод <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> вызывается на удаленной частной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1131">The <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> method is being called on a remote private queue</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1132">При проверке существования очереди приложение использовало синтаксис имени формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-1132">The application used format name syntax when verifying queue existence.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="FormatName">
      <MemberSignature Language="C#" Value="public string FormatName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FormatName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.FormatName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FormatName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FormatName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.FormatName : string" Usage="System.Messaging.MessageQueue.FormatName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_FormatName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1133">Получает уникальное имя очереди, созданное службой очереди сообщений в момент создания очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1133">Gets the unique queue name that Message Queuing generated at the time of the queue's creation.</span></span></summary>
        <value><span data-ttu-id="37b16-1134">Имя очереди, которое является уникальным в сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1134">The name for the queue, which is unique on the network.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1135"><xref:System.Messaging.MessageQueue.FormatName%2A> Свойство содержит имя формата очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1135">The <xref:System.Messaging.MessageQueue.FormatName%2A> property contains the format name of the queue.</span></span> <span data-ttu-id="37b16-1136">Служба очереди сообщений использует имя формата для определения, какая очередь, чтобы открыть и доступе к нему.</span><span class="sxs-lookup"><span data-stu-id="37b16-1136">Message Queuing uses the format name to identify which queue to open and how to access it.</span></span> <span data-ttu-id="37b16-1137">В отличие от большинства характеристик очереди имя формата не является свойством очереди приложения Message Queuing, поэтому не может получить доступ к его через средство управления очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1137">Unlike most of a queue's characteristics, the format name is not a Message Queuing application queue property, so you cannot access it through the Message Queuing management tool.</span></span> <span data-ttu-id="37b16-1138">Имя формата — это уникальное имя для очереди, который создается службой Message Queuing при создании очереди или более поздней версии создается приложением.</span><span class="sxs-lookup"><span data-stu-id="37b16-1138">The format name is simply a unique name for the queue, which Message Queuing generates when it creates the queue or which the application generates later.</span></span>  
  
 <span data-ttu-id="37b16-1139">Если вы укажите путь, используя синтаксис имени пути (например `myComputer\myQueue`) вместо того чтобы использовать синтаксис имени формата при чтении или записи в очередь, преобразует основного контроллера домена (с использованием Active Directory) <xref:System.Messaging.MessageQueue.Path%2A> в связанных <xref:System.Messaging.MessageQueue.FormatName%2A> перед доступом к очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1139">If you specify a path using the path name syntax (such as `myComputer\myQueue`) rather than using the format name syntax when you read or write to the queue, the primary domain controller (which uses Active Directory) translates the <xref:System.Messaging.MessageQueue.Path%2A> into the associated <xref:System.Messaging.MessageQueue.FormatName%2A> before accessing the queue.</span></span> <span data-ttu-id="37b16-1140">Если приложение работает в автономном режиме, необходимо использовать синтаксис имени формата; в противном случае основной контроллер домена будет недоступен для выполнения преобразования путь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1140">If your application is working offline, you must use the format name syntax; otherwise, the primary domain controller will not be available to perform the path translation.</span></span>  
  
 <span data-ttu-id="37b16-1141">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1141">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1142">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1142">Workgroup mode</span></span>|<span data-ttu-id="37b16-1143">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1143">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1144">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1144">Local computer</span></span>|<span data-ttu-id="37b16-1145">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1145">Yes</span></span>|  
|<span data-ttu-id="37b16-1146">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1146">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1147">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1147">Yes</span></span>|  
|<span data-ttu-id="37b16-1148">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1148">Remote computer</span></span>|<span data-ttu-id="37b16-1149">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1149">Yes</span></span>|  
|<span data-ttu-id="37b16-1150">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1150">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1151">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1151">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1152">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.FormatName%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1152">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.FormatName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1153"><see cref="P:System.Messaging.MessageQueue.Path" /> не указывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-1153">The <see cref="P:System.Messaging.MessageQueue.Path" /> is not set.</span></span>  
  
<span data-ttu-id="37b16-1154">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-1154">-or-</span></span> 
<span data-ttu-id="37b16-1155">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1155">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="T:System.Messaging.MessageQueue" />
      </Docs>
    </Member>
    <Member MemberName="Formatter">
      <MemberSignature Language="C#" Value="public System.Messaging.IMessageFormatter Formatter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.IMessageFormatter Formatter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Formatter" />
      <MemberSignature Language="VB.NET" Value="Public Property Formatter As IMessageFormatter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::IMessageFormatter ^ Formatter { System::Messaging::IMessageFormatter ^ get(); void set(System::Messaging::IMessageFormatter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Formatter : System.Messaging.IMessageFormatter with get, set" Usage="System.Messaging.MessageQueue.Formatter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageFormatterConverter))</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Formatter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.IMessageFormatter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1156">Получает или задает модуль форматирования, используемый для сериализации объекта в текст сообщения или десериализации из текста сообщения, прочитанного из очереди или записанного в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1156">Gets or sets the formatter used to serialize an object into or deserialize an object from the body of a message read from or written to the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-1157">Объект <see cref="T:System.Messaging.IMessageFormatter" />, создающий поток, записываемый в текст сообщения или считываемый из него.</span><span class="sxs-lookup"><span data-stu-id="37b16-1157">The <see cref="T:System.Messaging.IMessageFormatter" /> that produces a stream to be written to or read from the message body.</span></span> <span data-ttu-id="37b16-1158">Значение по умолчанию — <see cref="T:System.Messaging.XmlMessageFormatter" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1158">The default is <see cref="T:System.Messaging.XmlMessageFormatter" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1159"><xref:System.Messaging.MessageQueue.Formatter%2A> Свойство содержит экземпляр объекта средства форматирования, который преобразует сообщения, когда приложение считывает или записывает в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1159">The <xref:System.Messaging.MessageQueue.Formatter%2A> property contains an instance of a formatter object, which transforms messages when your application reads or writes to the queue.</span></span>  
  
 <span data-ttu-id="37b16-1160">Когда приложение отправляет сообщение в очередь, модуль форматирования сериализует объект в поток и вставляет его в тело сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1160">When the application sends message to the queue, the formatter serializes the object into a stream and inserts it into the message body.</span></span> <span data-ttu-id="37b16-1161">При чтении из очереди, модуль форматирования десериализует данные из <xref:System.Messaging.Message.Body%2A> свойство <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1161">When reading from a queue, the formatter deserializes the message data into the <xref:System.Messaging.Message.Body%2A> property of a <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="37b16-1162"><xref:System.Messaging.XmlMessageFormatter> Слабо связанный, поэтому нет необходимости в тот же объект введите на отправителя и получателя, при использовании этого формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-1162">The <xref:System.Messaging.XmlMessageFormatter> is loosely coupled, so it is not necessary to have the same object type on the sender and receiver when using this format.</span></span> <span data-ttu-id="37b16-1163"><xref:System.Messaging.ActiveXMessageFormatter> И <xref:System.Messaging.BinaryMessageFormatter> сериализовать данные в двоичное представление.</span><span class="sxs-lookup"><span data-stu-id="37b16-1163">The <xref:System.Messaging.ActiveXMessageFormatter> and <xref:System.Messaging.BinaryMessageFormatter> serialize the data into binary representation.</span></span> <span data-ttu-id="37b16-1164"><xref:System.Messaging.ActiveXMessageFormatter> Используется при отправке или получении COM-компонентов.</span><span class="sxs-lookup"><span data-stu-id="37b16-1164">The <xref:System.Messaging.ActiveXMessageFormatter> is used when sending or receiving COM components.</span></span>  
  
 <span data-ttu-id="37b16-1165"><xref:System.Messaging.BinaryMessageFormatter> и <xref:System.Messaging.ActiveXMessageFormatter> обеспечить большую пропускную способность, чем <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1165"><xref:System.Messaging.BinaryMessageFormatter> and <xref:System.Messaging.ActiveXMessageFormatter> provide faster throughput than the <xref:System.Messaging.XmlMessageFormatter>.</span></span> <span data-ttu-id="37b16-1166"><xref:System.Messaging.ActiveXMessageFormatter> Обеспечивает возможность взаимодействия с приложениями очереди сообщений Visual Basic 6.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1166">The <xref:System.Messaging.ActiveXMessageFormatter> allows interoperability with Visual Basic 6.0 Message Queuing applications.</span></span>  
  
 <span data-ttu-id="37b16-1167">Когда приложение отправляет сообщения в очередь <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> применяется только к этих сообщений, которые используют свойства сообщений по умолчанию <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1167">When your application sends messages to the queue, the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> applies only to those messages that use the default message properties, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span></span> <span data-ttu-id="37b16-1168">При отправке <xref:System.Messaging.Message> в очередь, используемый службой очереди сообщений модуль форматирования, определенные в <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойства вместо сериализации текста сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1168">If you send a <xref:System.Messaging.Message> to the queue, Message Queuing uses the formatter defined in the <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property to serialize the body instead.</span></span>  
  
 <span data-ttu-id="37b16-1169"><xref:System.Messaging.MessageQueue> Класс будет всегда использовать <xref:System.Messaging.Message> получать и считывать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1169">The <xref:System.Messaging.MessageQueue> class will always use a <xref:System.Messaging.Message> to receive or peek a message from the queue.</span></span> <span data-ttu-id="37b16-1170">Сообщение сериализуется с помощью <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1170">The message is deserialized using the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="37b16-1171">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1171">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1172">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1172">Workgroup mode</span></span>|<span data-ttu-id="37b16-1173">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1173">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1174">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1174">Local computer</span></span>|<span data-ttu-id="37b16-1175">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1175">Yes</span></span>|  
|<span data-ttu-id="37b16-1176">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1176">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1177">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1177">Yes</span></span>|  
|<span data-ttu-id="37b16-1178">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1178">Remote computer</span></span>|<span data-ttu-id="37b16-1179">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1179">No</span></span>|  
|<span data-ttu-id="37b16-1180">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1180">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1181">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1181">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1182">В следующем примере кода демонстрируется форматирование тела сообщения с помощью <xref:System.Messaging.BinaryMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1182">The following code example demonstrates formatting a message body using <xref:System.Messaging.BinaryMessageFormatter>.</span></span>  
  
 [!code-cpp[MessagingBinaryFormatter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessagingBinaryFormatter/CPP/message_binaryformatter.cpp#1)]
 [!code-csharp[MessagingBinaryFormatter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessagingBinaryFormatter/CS/message_binaryformatter.cs#1)]
 [!code-vb[MessagingBinaryFormatter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessagingBinaryFormatter/VB/message_binaryformatter.vb#1)]  
  
 <span data-ttu-id="37b16-1183">В следующем примере кода демонстрируется форматирование тела сообщения с помощью <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1183">The following code example demonstrates formatting a message body using <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 [!code-cpp[Message.Body#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Body/CPP/message_sendreceive.cpp#1)]
 [!code-csharp[Message.Body#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Body/CS/message_sendreceive.cs#1)]
 [!code-vb[Message.Body#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Body/VB/message_sendreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Messaging.XmlMessageFormatter" />
        <altmember cref="T:System.Messaging.ActiveXMessageFormatter" />
        <altmember cref="T:System.Messaging.BinaryMessageFormatter" />
        <altmember cref="P:System.Messaging.Message.Formatter" />
      </Docs>
    </Member>
    <Member MemberName="GetAllMessages">
      <MemberSignature Language="C#" Value="public System.Messaging.Message[] GetAllMessages ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message[] GetAllMessages() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetAllMessages" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllMessages () As Message()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Messaging::Message ^&gt; ^ GetAllMessages();" />
      <MemberSignature Language="F#" Value="member this.GetAllMessages : unit -&gt; System.Messaging.Message[]" Usage="messageQueue.GetAllMessages " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1184">Возвращает все сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1184">Returns all the messages that are in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-1185">Массив типа <see cref="T:System.Messaging.Message" />, который представляет все сообщения очереди в том же порядке, в каком они располагаются в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1185">An array of type <see cref="T:System.Messaging.Message" /> that represents all the messages in the queue, in the same order as they appear in the Message Queuing queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> Возвращает статический снимок сообщений в очереди, не динамические ссылки на эти сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a static snapshot of the messages in the queue, not dynamic links to those messages.</span></span> <span data-ttu-id="37b16-1187">Таким образом массив нельзя использовать для изменения сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1187">Therefore, you cannot use the array to modify the messages in the queue.</span></span> <span data-ttu-id="37b16-1188">Если требуется, чтобы в режиме реального времени, динамического взаимодействия с очередью (например, возможность удаления сообщений), вызовите <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> метод, который возвращает динамический список сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1188">If you want real-time, dynamic interaction with the queue (such as the ability to delete messages), call the <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> method, which returns a dynamic list of the messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1189">Так как <xref:System.Messaging.MessageQueue.GetAllMessages%2A> возвращает копии сообщения в очереди во время вызова метода, массив не отражает новые сообщения, поступающие в очередь или сообщений, удаленных из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1189">Because <xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a copy of the messages in the queue at the time the method was called, the array does not reflect new messages that arrive in the queue or messages that are removed from the queue.</span></span>  
  
 <span data-ttu-id="37b16-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> извлекает только те свойства, которые не отфильтрованные <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> retrieves only those properties not filtered out by the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span>  
  
 <span data-ttu-id="37b16-1191">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1191">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1192">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1192">Workgroup mode</span></span>|<span data-ttu-id="37b16-1193">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1193">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1194">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1194">Local computer</span></span>|<span data-ttu-id="37b16-1195">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1195">Yes</span></span>|  
|<span data-ttu-id="37b16-1196">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1196">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1197">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1197">Yes</span></span>|  
|<span data-ttu-id="37b16-1198">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1198">Remote computer</span></span>|<span data-ttu-id="37b16-1199">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1199">No</span></span>|  
|<span data-ttu-id="37b16-1200">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1200">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1201">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1201">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1202">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1202">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#21](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#21)]
 [!code-csharp[MessageQueue2#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1203">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1203">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.IEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::IEnumerator ^ GetEnumerator();" />
      <MemberSignature Language="F#" Value="abstract member GetEnumerator : unit -&gt; System.Collections.IEnumerator&#xA;override this.GetEnumerator : unit -&gt; System.Collections.IEnumerator" Usage="messageQueue.GetEnumerator " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1204">Перечисляет сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1204">Enumerates the messages in a queue.</span></span> <span data-ttu-id="37b16-1205">Параметр <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> использовать не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="37b16-1205"><see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> is deprecated.</span></span> <span data-ttu-id="37b16-1206">Вместо него следует использовать метод <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1206"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="37b16-1207">Объект <see cref="T:System.Collections.IEnumerator" />, обеспечивающий динамическое подключение к сообщениям очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1207">A <see cref="T:System.Collections.IEnumerator" /> that provides a dynamic connection to the messages in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1208">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1208">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1209">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1209">Workgroup mode</span></span>|<span data-ttu-id="37b16-1210">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1210">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1211">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1211">Local computer</span></span>|<span data-ttu-id="37b16-1212">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1212">Yes</span></span>|  
|<span data-ttu-id="37b16-1213">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1213">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1214">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1214">Yes</span></span>|  
|<span data-ttu-id="37b16-1215">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1215">Remote computer</span></span>|<span data-ttu-id="37b16-1216">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1216">No</span></span>|  
|<span data-ttu-id="37b16-1217">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1217">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1218">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1218">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1219">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1219">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#22](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#22)]
 [!code-csharp[MessageQueue2#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMachineId">
      <MemberSignature Language="C#" Value="public static Guid GetMachineId (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig valuetype System.Guid GetMachineId(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMachineId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMachineId (machineName As String) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Guid GetMachineId(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetMachineId : string -&gt; Guid" Usage="System.Messaging.MessageQueue.GetMachineId machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="37b16-1220">Имя компьютера, на котором расположена очередь, без двух обратных косых черт (\\\\) в начале.</span><span class="sxs-lookup"><span data-stu-id="37b16-1220">The name of the computer that contains the queue, without the two preceding backslashes (\\\\).</span></span></param>
        <summary><span data-ttu-id="37b16-1221">Получает идентификатор компьютера, на котором расположена очередь, на которую ссылается этот класс <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1221">Gets the identifier of the computer on which the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> is located.</span></span></summary>
        <returns><span data-ttu-id="37b16-1222">Объект <see cref="T:System.Guid" />, который представляет уникальный идентификатор компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1222">A <see cref="T:System.Guid" /> that represents a unique identifier for the computer on which the queue is located.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1223">Идентификатор компьютера можно использовать для двух целей, помимо прочего: для чтения журнала компьютера и задания сертификатов безопасности.</span><span class="sxs-lookup"><span data-stu-id="37b16-1223">You can use a computer's identifier for two purposes, among others: to read the computer journal and to set security certificates.</span></span> <span data-ttu-id="37b16-1224">Тем не менее, нельзя вызывать <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> на удаленном компьютере, при работе вне сети, так как в приложении необходим доступ к службе каталогов на контроллере домена.</span><span class="sxs-lookup"><span data-stu-id="37b16-1224">However, you cannot call <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> for a remote computer when you are working offline because the application must have access to the directory service on the domain controller.</span></span>  
  
 <span data-ttu-id="37b16-1225">Идентификатор компьютера (или идентификаторы компьютеров), <xref:System.Guid> , Message Queuing создает при добавлении компьютера на предприятии.</span><span class="sxs-lookup"><span data-stu-id="37b16-1225">The computer identifier (or machine identifier) is a <xref:System.Guid> that Message Queuing creates when a computer is added to the enterprise.</span></span> <span data-ttu-id="37b16-1226">Служба очереди сообщений сочетает в себе идентификатор компьютера с `Machine` и `Journal` ключевые слова для создания имени формата журнал компьютера, который имеет синтаксис `Machine=<computeridentifier>;Journal`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1226">Message Queuing combines the computer identifier with the `Machine` and `Journal` keywords to create the machine journal's format name, which has the syntax `Machine=<computeridentifier>;Journal`.</span></span> <span data-ttu-id="37b16-1227">Журнал компьютера, который также известен как в очередь журнала является системной очереди, в которой хранятся копии генерируемые приложением сообщения, когда <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> свойство `true`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1227">The machine journal, which is also known as the journal queue, is a system queue that stores copies of application-generated messages when the <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property is `true`.</span></span>  
  
 <span data-ttu-id="37b16-1228">Этот синтаксис для журнала используется только при создании имени формата очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1228">This syntax for the journal is only valid when constructing the format name for the queue.</span></span> <span data-ttu-id="37b16-1229">Синтаксис имени пути `MachineName` \\ `Journal$`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1229">The path name syntax is `MachineName`\\`Journal$`.</span></span>  
  
 <span data-ttu-id="37b16-1230">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1230">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1231">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1231">Workgroup mode</span></span>|<span data-ttu-id="37b16-1232">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1232">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1233">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1233">Local computer</span></span>|<span data-ttu-id="37b16-1234">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1234">No</span></span>|  
|<span data-ttu-id="37b16-1235">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1235">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1236">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1236">No</span></span>|  
|<span data-ttu-id="37b16-1237">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1237">Remote computer</span></span>|<span data-ttu-id="37b16-1238">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1238">No</span></span>|  
|<span data-ttu-id="37b16-1239">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1239">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1240">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1240">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1241">В приведенном ниже примере кода вызывается <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1241">The following code example calls <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span></span>  
  
 [!code-csharp[MessageQueue#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1242">Не удается извлечь идентификатор компьютера. Возможной причиной может быть недоступность службы каталогов: например, при работе в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="37b16-1242">The computer identifier could not be retrieved, possibly because the directory service is not available; for example, if you are working offline.</span></span>  
  
<span data-ttu-id="37b16-1243">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-1243">-or-</span></span> 
<span data-ttu-id="37b16-1244">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1244">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("This method returns a MessageEnumerator that implements RemoveCurrent family of methods incorrectly. Please use GetMessageEnumerator2 instead.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1245">Создает объект перечислителя для всех сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1245">Creates an enumerator object for all the messages in the queue.</span></span> <span data-ttu-id="37b16-1246">Параметр <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> использовать не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="37b16-1246"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> is deprecated.</span></span> <span data-ttu-id="37b16-1247">Вместо него следует использовать метод <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1247"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="37b16-1248">Объект <see cref="T:System.Messaging.MessageEnumerator" /> содержащий сообщения, которые находятся в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1248">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> Создает динамический список всех сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="37b16-1250">Можно удалить из очереди сообщение в текущей позиции перечислителя, вызвав <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> для <xref:System.Messaging.MessageEnumerator> , <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> возвращает.</span><span class="sxs-lookup"><span data-stu-id="37b16-1250">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> returns.</span></span>  
  
 <span data-ttu-id="37b16-1251">Так, как курсор не связано с динамический список сообщений в очереди, перечисление отражает все изменения, внесенные в сообщения в очереди, если сообщение находится за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="37b16-1251">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="37b16-1252">Например перечислитель может автоматически получить доступ к сообщению с более низким приоритетом, размещенному за текущей позицией курсора, но не более высокий приоритет сообщения вставляется перед этой позиции.</span><span class="sxs-lookup"><span data-stu-id="37b16-1252">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="37b16-1253">Тем не менее, вы можете сбросить перечисления, тем самым Возврат курсора в начало списка, путем вызова <xref:System.Messaging.MessageEnumerator.Reset%2A> для <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1253">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="37b16-1254">Порядок сообщений в перечислении отражает их порядка в очереди, поэтому сообщения с более высоким приоритетом отображаются перед более низким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="37b16-1254">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="37b16-1255">Если требуется статический снимок сообщений в очереди, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1255">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="37b16-1256">Этот метод возвращает массив <xref:System.Messaging.Message> объекты, которые представляют сообщения на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1256">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="37b16-1257">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1257">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1258">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1258">Workgroup mode</span></span>|<span data-ttu-id="37b16-1259">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1259">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1260">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1260">Local computer</span></span>|<span data-ttu-id="37b16-1261">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1261">Yes</span></span>|  
|<span data-ttu-id="37b16-1262">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1262">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1263">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1263">Yes</span></span>|  
|<span data-ttu-id="37b16-1264">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1264">Remote computer</span></span>|<span data-ttu-id="37b16-1265">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1265">Yes</span></span>|  
|<span data-ttu-id="37b16-1266">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1266">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1267">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1267">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1268">В следующем примере кода получает динамический список сообщений в очереди и подсчитывает все сообщения с <xref:System.Messaging.Message.Priority%2A> свойство значение <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1268">The following code example gets a dynamic list of messages in a queue and counts all messages with the <xref:System.Messaging.Message.Priority%2A> property set to <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CPP/mqgetmessageenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CS/mqgetmessageenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/VB/mqgetmessageenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator2">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator2 ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator2() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator2 () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator2();" />
      <MemberSignature Language="F#" Value="member this.GetMessageEnumerator2 : unit -&gt; System.Messaging.MessageEnumerator" Usage="messageQueue.GetMessageEnumerator2 " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1269">Создает объект перечислителя для всех сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1269">Creates an enumerator object for all the messages in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-1270">Объект <see cref="T:System.Messaging.MessageEnumerator" /> содержащий сообщения, которые находятся в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1270">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> Создает динамический список всех сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="37b16-1272">Можно удалить из очереди сообщение в текущей позиции перечислителя, вызвав <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> для <xref:System.Messaging.MessageEnumerator> , <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> возвращает.</span><span class="sxs-lookup"><span data-stu-id="37b16-1272">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> returns.</span></span>  
  
 <span data-ttu-id="37b16-1273">Так, как курсор не связано с динамический список сообщений в очереди, перечисление отражает все изменения, внесенные в сообщения в очереди, если сообщение находится за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="37b16-1273">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="37b16-1274">Например перечислитель может автоматически получить доступ к сообщению с более низким приоритетом, размещенному за текущей позицией курсора, но не более высокий приоритет сообщения вставляется перед этой позиции.</span><span class="sxs-lookup"><span data-stu-id="37b16-1274">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="37b16-1275">Тем не менее, вы можете сбросить перечисления, тем самым Возврат курсора в начало списка, путем вызова <xref:System.Messaging.MessageEnumerator.Reset%2A> для <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1275">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="37b16-1276">Порядок сообщений в перечислении отражает их порядка в очереди, поэтому сообщения с более высоким приоритетом отображаются перед более низким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="37b16-1276">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="37b16-1277">Если требуется статический снимок сообщений в очереди, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1277">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="37b16-1278">Этот метод возвращает массив <xref:System.Messaging.Message> объекты, которые представляют сообщения на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1278">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="37b16-1279">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1279">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1280">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1280">Workgroup mode</span></span>|<span data-ttu-id="37b16-1281">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1281">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1282">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1282">Local computer</span></span>|<span data-ttu-id="37b16-1283">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1283">Yes</span></span>|  
|<span data-ttu-id="37b16-1284">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1284">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1285">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1285">Yes</span></span>|  
|<span data-ttu-id="37b16-1286">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1286">Remote computer</span></span>|<span data-ttu-id="37b16-1287">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1287">Yes</span></span>|  
|<span data-ttu-id="37b16-1288">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1288">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1289">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1289">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetMessageQueueEnumerator">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-1290">Создает объект перечислителя для динамического списка общих очередей сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1290">Creates an enumerator object for a dynamic listing of the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator () As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator();" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : unit -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1291">Обеспечивает семантику курсора последовательного доступа для перечисления во всех общих очередях сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1291">Provides forward-only cursor semantics to enumerate through all public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="37b16-1292">Объект <see cref="T:System.Messaging.MessageQueueEnumerator" />, обеспечивающий динамическое перечисление всех общих очередей сообщений в сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1292">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of all the public message queues on the network.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1293">Эта перегрузка <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> возвращает перечисление всех общих очередей, которые входят в сеть.</span><span class="sxs-lookup"><span data-stu-id="37b16-1293">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns an enumeration of all the public queues that are on the network.</span></span>  
  
 <span data-ttu-id="37b16-1294">Поскольку курсор связан с динамическим перечислением, перечисление отражаются все изменения, внесенные в список очередей удалены или добавлены за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="37b16-1294">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue list for queues deleted or added beyond the cursor's current position.</span></span> <span data-ttu-id="37b16-1295">Добавление и удаление очередей, расположенных до текущей позиции курсора, не отражаются.</span><span class="sxs-lookup"><span data-stu-id="37b16-1295">Additions or deletion of queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="37b16-1296">Например перечислитель может автоматически получить доступ к очереди, добавленной за позицией курсора, но не вставляется перед этой позиции.</span><span class="sxs-lookup"><span data-stu-id="37b16-1296">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="37b16-1297">Тем не менее, вы можете сбросить перечисления, тем самым Возврат курсора в начало списка, путем вызова <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> для <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1297">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="37b16-1298">Нет, не определен порядок очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1298">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="37b16-1299">Перечислитель не упорядочивает их по компьютерам, метки, общедоступных или частных состояние или любому другому доступному критерию.</span><span class="sxs-lookup"><span data-stu-id="37b16-1299">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="37b16-1300">Если требуется статический снимок очередей в сети, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1300">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="37b16-1301">Каждый из этих двух методов возвращает массив <xref:System.Messaging.MessageQueue> объекты, которые представлены очереди на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1301">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span>  
  
 <span data-ttu-id="37b16-1302">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1303">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1303">Workgroup mode</span></span>|<span data-ttu-id="37b16-1304">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1305">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1305">Local computer</span></span>|<span data-ttu-id="37b16-1306">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1306">No</span></span>|  
|<span data-ttu-id="37b16-1307">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1307">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1308">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1308">No</span></span>|  
|<span data-ttu-id="37b16-1309">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1309">Remote computer</span></span>|<span data-ttu-id="37b16-1310">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1310">No</span></span>|  
|<span data-ttu-id="37b16-1311">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1311">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1312">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1313">В следующем примере кода выполняется итерация по всем очередям сообщений в сети и проверяет путь для каждой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1313">The following code example iterates through all the message queues in the network, and examines the path for each queue.</span></span> <span data-ttu-id="37b16-1314">Наконец он отображает количество общих очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1314">Finally, it displays the number of public queues on the network.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CPP/mqgetmessagequeueenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CS/mqgetmessagequeueenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/VB/mqgetmessagequeueenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator (criteria As MessageQueueCriteria) As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetMessageQueueEnumerator : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueueEnumerator" Usage="System.Messaging.MessageQueue.GetMessageQueueEnumerator criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="37b16-1315">Объект <see cref="T:System.Messaging.MessageQueueCriteria" />, содержащий критерии фильтрации доступных очередей сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1315">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the available message queues.</span></span></param>
        <summary><span data-ttu-id="37b16-1316">Обеспечивает семантику курсора последовательного доступа для перечисления во всех общих очередях сети, удовлетворяющих указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="37b16-1316">Provides forward-only cursor semantics to enumerate through all public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="37b16-1317">Объект <see cref="T:System.Messaging.MessageQueueEnumerator" />, обеспечивающий динамическое перечисление общих очередей сообщений сети, удовлетворяющих ограничениям, заданным параметром <paramref name="criteria" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1317">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of the public message queues on the network that satisfy the restrictions specified by the <paramref name="criteria" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1318">Эта перегрузка <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> возвращен список всех общих очередях сети, который удовлетворяет условию, определенный в приложении.</span><span class="sxs-lookup"><span data-stu-id="37b16-1318">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns a listing of all the public queues on the network that satisfy criteria defined in the application criteria.</span></span> <span data-ttu-id="37b16-1319">Можно указать критерии можно включить, например, очереди, время создания или изменения, имя компьютера, метки, категории или любое их сочетание.</span><span class="sxs-lookup"><span data-stu-id="37b16-1319">You can specify the criteria to include, for example, queue creation or modification time, computer name, label, category, or any combination of these.</span></span>  
  
 <span data-ttu-id="37b16-1320">Поскольку курсор связан с динамическим перечислением, перечисление отражаются все изменения, внесенные в очередь, находящихся за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="37b16-1320">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue that occurs beyond the cursor's current position.</span></span> <span data-ttu-id="37b16-1321">Изменение очередей, расположенных до текущей позиции курсора, не отражаются.</span><span class="sxs-lookup"><span data-stu-id="37b16-1321">Changes to queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="37b16-1322">Например перечислитель может автоматически получить доступ к очереди, добавленной за позицией курсора, но не вставляется перед этой позиции.</span><span class="sxs-lookup"><span data-stu-id="37b16-1322">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="37b16-1323">Тем не менее, вы можете сбросить перечисления, тем самым Возврат курсора в начало списка, путем вызова <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> для <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1323">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="37b16-1324">Нет, не определен порядок очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1324">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="37b16-1325">Перечислитель не упорядочивает их по компьютерам, метки, общедоступных или частных состояние или любому другому доступному критерию.</span><span class="sxs-lookup"><span data-stu-id="37b16-1325">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="37b16-1326">Статический снимок очередей в сети, а не динамическое подключение к ним, укажите критерии для <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или вызвать <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1326">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, specify criteria for <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or call <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="37b16-1327">Каждый из этих двух методов возвращает массив <xref:System.Messaging.MessageQueue> объекты, которые представлены очереди на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1327">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span> <span data-ttu-id="37b16-1328">Вызов <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, или <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> предоставляет те же результаты, что и вызов метода <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> с критериями фильтра свойств <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, и <xref:System.Messaging.MessageQueue.MachineName%2A>, соответственно.</span><span class="sxs-lookup"><span data-stu-id="37b16-1328">Calling <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> provides the same results as calling <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> with the filtering criteria of <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>, respectively.</span></span>  
  
 <span data-ttu-id="37b16-1329">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1329">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1330">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1330">Workgroup mode</span></span>|<span data-ttu-id="37b16-1331">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1331">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1332">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1332">Local computer</span></span>|<span data-ttu-id="37b16-1333">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1333">No</span></span>|  
|<span data-ttu-id="37b16-1334">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1334">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1335">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1335">No</span></span>|  
|<span data-ttu-id="37b16-1336">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1336">Remote computer</span></span>|<span data-ttu-id="37b16-1337">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1337">No</span></span>|  
|<span data-ttu-id="37b16-1338">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1338">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1339">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1339">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1340">В следующем примере кода выполняется итерация по очереди сообщений и отображает путь к каждой очереди, который был создан в последний день, и который существует на компьютере «MyComputer».</span><span class="sxs-lookup"><span data-stu-id="37b16-1340">The following code example iterates through message queues and displays the path of each queue that was created in the last day and that exists on the computer "MyComputer".</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CPP/mqgetmessagequeueenumerator_criteria.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CS/mqgetmessagequeueenumerator_criteria.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/VB/mqgetmessagequeueenumerator_criteria.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetPrivateQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPrivateQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPrivateQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPrivateQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPrivateQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPrivateQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPrivateQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPrivateQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="37b16-1341">Компьютер, из которого извлекаются частные очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1341">The computer from which to retrieve the private queues.</span></span></param>
        <summary><span data-ttu-id="37b16-1342">Извлекает все частные очереди на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="37b16-1342">Retrieves all the private queues on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="37b16-1343">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные частные очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1343">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved private queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> Извлекает статический снимок очередей на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="37b16-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues on a specified computer.</span></span>  
  
 <span data-ttu-id="37b16-1345">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1345">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1346">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1346">Workgroup mode</span></span>|<span data-ttu-id="37b16-1347">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1347">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1348">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1348">Local computer</span></span>|<span data-ttu-id="37b16-1349">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1349">Yes</span></span>|  
|<span data-ttu-id="37b16-1350">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1350">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1351">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1351">Yes</span></span>|  
|<span data-ttu-id="37b16-1352">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1352">Remote computer</span></span>|<span data-ttu-id="37b16-1353">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1353">Yes</span></span>|  
|<span data-ttu-id="37b16-1354">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1354">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1355">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1355">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1356">В следующем примере кода извлекает списка очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1356">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1357">Значение параметра <paramref name="machineName" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="37b16-1357">The <paramref name="machineName" /> parameter is <see langword="null" /> or an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1358">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1358">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetPublicQueues">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-1359">Извлекает все общие очереди сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1359">Retrieves all the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues () As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues();" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : unit -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1360">Извлекает все общие очереди сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1360">Retrieves all the public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="37b16-1361">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1361">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1362">Используйте этот перегруженный метод, если требуется полный список всех общих очередях сети.</span><span class="sxs-lookup"><span data-stu-id="37b16-1362">Use this overload if you want a complete list of all the public queues on the network.</span></span> <span data-ttu-id="37b16-1363">Если вы хотите ограничить список по определенным критериям, такие как <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, или время последнего изменения использовать другую перегрузку этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1363">If you want to restrict the list by certain criteria, such as <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, or last modified time use another overload of this method.</span></span> <span data-ttu-id="37b16-1364">(Кроме того, можно использовать <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, или <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span><span class="sxs-lookup"><span data-stu-id="37b16-1364">(Alternatively, you can use <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span></span>  
  
 <span data-ttu-id="37b16-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="37b16-1366">Для взаимодействия с помощью динамического списка очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1366">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="37b16-1367">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1367">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1368">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1368">Workgroup mode</span></span>|<span data-ttu-id="37b16-1369">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1369">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1370">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1370">Local computer</span></span>|<span data-ttu-id="37b16-1371">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1371">No</span></span>|  
|<span data-ttu-id="37b16-1372">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1372">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1373">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1373">No</span></span>|  
|<span data-ttu-id="37b16-1374">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1374">Remote computer</span></span>|<span data-ttu-id="37b16-1375">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1375">No</span></span>|  
|<span data-ttu-id="37b16-1376">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1376">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1377">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1377">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1378">В следующем примере кода извлекает списка очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1378">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1379">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1379">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues (criteria As MessageQueueCriteria) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueues : System.Messaging.MessageQueueCriteria -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueues criteria" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="37b16-1380">Объект <see cref="T:System.Messaging.MessageQueueCriteria" />, содержащий критерии фильтрации очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1380">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the queues.</span></span></param>
        <summary><span data-ttu-id="37b16-1381">Извлекает все общие очереди сети, удовлетворяющие указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="37b16-1381">Retrieves all the public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="37b16-1382">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1382">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1383">Если вы хотите отфильтровать все общие очереди сети метки, категории или имя компьютера, <xref:System.Messaging.MessageQueue> класс содержит конкретные методы, которые предоставляют функциональные возможности (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, и <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, соответственно).</span><span class="sxs-lookup"><span data-stu-id="37b16-1383">If you want to filter all the public queues on the network by label, category, or computer name, the <xref:System.Messaging.MessageQueue> class contains specific methods that provide that functionality (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, and <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectively).</span></span> <span data-ttu-id="37b16-1384">Используйте этот перегруженный метод, чтобы получить список всех общих очередях сети, которые соответствуют более чем одному из этих критериев (например, если вы хотите указать метку и категории).</span><span class="sxs-lookup"><span data-stu-id="37b16-1384">Use this overload to get a list of all the public queues on the network that meet more than one of these criteria (for example, if you want to specify both a label and a category).</span></span> <span data-ttu-id="37b16-1385">Также можно фильтровать по критерию сообщения не <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, и <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1385">You can also filter by message criteria other than <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="37b16-1386">Например использовании этой перегрузки для фильтрации по времени последнего изменения очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1386">For example, you use this overload to filter by a queue's last-modified time.</span></span> <span data-ttu-id="37b16-1387">Просто создайте новый экземпляр класса <xref:System.Messaging.MessageQueueCriteria> , задайте соответствующие свойства в экземпляре и передайте экземпляр как `criteria` параметр.</span><span class="sxs-lookup"><span data-stu-id="37b16-1387">Simply create a new instance of the <xref:System.Messaging.MessageQueueCriteria> class, set the appropriate properties in the instance, and pass the instance as the `criteria` parameter.</span></span>  
  
 <span data-ttu-id="37b16-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="37b16-1389">Для взаимодействия с помощью динамического списка очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1389">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="37b16-1390">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1390">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1391">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1391">Workgroup mode</span></span>|<span data-ttu-id="37b16-1392">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1392">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1393">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1393">Local computer</span></span>|<span data-ttu-id="37b16-1394">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1394">No</span></span>|  
|<span data-ttu-id="37b16-1395">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1395">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1396">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1396">No</span></span>|  
|<span data-ttu-id="37b16-1397">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1397">Remote computer</span></span>|<span data-ttu-id="37b16-1398">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1398">No</span></span>|  
|<span data-ttu-id="37b16-1399">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1399">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1400">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1400">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1401">В следующем примере кода извлекает списка очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1401">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1402">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1402">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueCriteria" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByCategory">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByCategory (Guid category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByCategory(valuetype System.Guid category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByCategory(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByCategory (category As Guid) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByCategory(Guid category);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByCategory : Guid -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByCategory category" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="category" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="category"><span data-ttu-id="37b16-1403">Класс <see cref="T:System.Guid" />, который группирует набор очередей для извлечения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1403">A <see cref="T:System.Guid" /> that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="37b16-1404">Извлекает все общие очереди сети, принадлежащие к указанной категории.</span><span class="sxs-lookup"><span data-stu-id="37b16-1404">Retrieves all the public queues on the network that belong to the specified category.</span></span></summary>
        <returns><span data-ttu-id="37b16-1405">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1405">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1406">Этот метод позволяет фильтровать общие очереди по категориям.</span><span class="sxs-lookup"><span data-stu-id="37b16-1406">Use this method to filter the public queues by category.</span></span> <span data-ttu-id="37b16-1407"><xref:System.Messaging.MessageQueue.Category%2A> Свойство предоставляет доступ к очереди сообщений типа свойство ID (который является чтение и запись) определенной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1407">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing type ID property (which is read/write) of a particular queue.</span></span> <span data-ttu-id="37b16-1408">Несмотря на то, что можно использовать <xref:System.Guid.NewGuid%2A> для создания значения категории, которое является уникальным для всех <xref:System.Guid> значения, нет необходимости.</span><span class="sxs-lookup"><span data-stu-id="37b16-1408">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, it is not necessary.</span></span> <span data-ttu-id="37b16-1409">Значение категории должно отличаться только из других категорий, а не от всех других <xref:System.Guid> значения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1409">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="37b16-1410">Например, можно назначить {00000000-0000-0000-0000-000000000001} как <xref:System.Messaging.MessageQueue.Category%2A> для одного набора очередей и {00000000-0000-0000-0000-000000000002} как <xref:System.Messaging.MessageQueue.Category%2A> для другого набора.</span><span class="sxs-lookup"><span data-stu-id="37b16-1410">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="37b16-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="37b16-1412">Для взаимодействия с помощью динамического списка очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1412">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="37b16-1413">Можно указать категорию как часть <xref:System.Messaging.MessageQueueCriteria> передачи в метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-1413">You can specify the category as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="37b16-1414">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1414">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1415">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1415">Workgroup mode</span></span>|<span data-ttu-id="37b16-1416">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1416">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1417">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1417">Local computer</span></span>|<span data-ttu-id="37b16-1418">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1418">No</span></span>|  
|<span data-ttu-id="37b16-1419">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1419">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1420">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1420">No</span></span>|  
|<span data-ttu-id="37b16-1421">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1421">Remote computer</span></span>|<span data-ttu-id="37b16-1422">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1422">No</span></span>|  
|<span data-ttu-id="37b16-1423">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1423">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1424">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1424">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1425">В следующем примере кода извлекает списка очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1425">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1426">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByLabel">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByLabel (string label);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByLabel(string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByLabel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByLabel (label As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByLabel(System::String ^ label);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByLabel : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByLabel label" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="label"><span data-ttu-id="37b16-1427">Метка, которая группирует набор очередей для извлечения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1427">A label that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="37b16-1428">Извлекает все общие очереди сети с указанной меткой.</span><span class="sxs-lookup"><span data-stu-id="37b16-1428">Retrieves all the public queues on the network that carry the specified label.</span></span></summary>
        <returns><span data-ttu-id="37b16-1429">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1429">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1430">Используйте этот метод для фильтрации общих очередей по метке.</span><span class="sxs-lookup"><span data-stu-id="37b16-1430">Use this method to filter the public queues by label.</span></span>  
  
 <span data-ttu-id="37b16-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="37b16-1432">Для взаимодействия с помощью динамического списка очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1432">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="37b16-1433">Метки можно указать как часть <xref:System.Messaging.MessageQueueCriteria> передачи в метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-1433">You can specify the label as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="37b16-1434">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1434">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1435">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1435">Workgroup mode</span></span>|<span data-ttu-id="37b16-1436">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1436">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1437">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1437">Local computer</span></span>|<span data-ttu-id="37b16-1438">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1438">No</span></span>|  
|<span data-ttu-id="37b16-1439">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1439">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1440">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1440">No</span></span>|  
|<span data-ttu-id="37b16-1441">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1441">Remote computer</span></span>|<span data-ttu-id="37b16-1442">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1442">No</span></span>|  
|<span data-ttu-id="37b16-1443">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1443">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1444">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1444">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1445">В следующем примере кода извлекает списка очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1445">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1446">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1446">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1447">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1447">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByMachine(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetPublicQueuesByMachine : string -&gt; System.Messaging.MessageQueue[]" Usage="System.Messaging.MessageQueue.GetPublicQueuesByMachine machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="37b16-1448">Имя компьютера, на котором располагается набор извлекаемых общих очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1448">The name of the computer that contains the set of public queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="37b16-1449">Извлекает все общие очереди, находящиеся на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="37b16-1449">Retrieves all the public queues that reside on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="37b16-1450">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на общие очереди, находящиеся на компьютере.</span><span class="sxs-lookup"><span data-stu-id="37b16-1450">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the public queues on the computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1451">Этот метод используется для фильтрации общих очередей по компьютерам.</span><span class="sxs-lookup"><span data-stu-id="37b16-1451">Use this method to filter the public queues by computer.</span></span>  
  
 <span data-ttu-id="37b16-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="37b16-1453">Для взаимодействия с помощью динамического списка очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1453">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="37b16-1454">Можно указать имя компьютера как часть <xref:System.Messaging.MessageQueueCriteria> передачи в метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-1454">You can specify the computer name as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="37b16-1455">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1456">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1456">Workgroup mode</span></span>|<span data-ttu-id="37b16-1457">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1458">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1458">Local computer</span></span>|<span data-ttu-id="37b16-1459">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1459">No</span></span>|  
|<span data-ttu-id="37b16-1460">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1460">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1461">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1461">No</span></span>|  
|<span data-ttu-id="37b16-1462">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1462">Remote computer</span></span>|<span data-ttu-id="37b16-1463">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1463">No</span></span>|  
|<span data-ttu-id="37b16-1464">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1464">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1465">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1465">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1466">В следующем примере кода извлекает списка очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1466">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1467">Параметр <paramref name="machineName" /> имеет неверный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="37b16-1467">The <paramref name="machineName" /> parameter has incorrect syntax.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1468">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1468">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetSecurityContext">
      <MemberSignature Language="C#" Value="public static System.Messaging.SecurityContext GetSecurityContext ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.SecurityContext GetSecurityContext() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetSecurityContext" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetSecurityContext () As SecurityContext" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::SecurityContext ^ GetSecurityContext();" />
      <MemberSignature Language="F#" Value="static member GetSecurityContext : unit -&gt; System.Messaging.SecurityContext" Usage="System.Messaging.MessageQueue.GetSecurityContext " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.SecurityContext</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1469">Извлекает контекст безопасности, который служба MSMQ связывает с текущим пользователем (удостоверением потока) на момент этого вызова.</span><span class="sxs-lookup"><span data-stu-id="37b16-1469">Retrieves the security context that MSMQ associates with the current user (thread identity) at the time of this call.</span></span></summary>
        <returns><span data-ttu-id="37b16-1470">Объект <see cref="T:System.Messaging.SecurityContext" />, содержащий контекст безопасности.</span><span class="sxs-lookup"><span data-stu-id="37b16-1470">A <see cref="T:System.Messaging.SecurityContext" /> object that contains the security context.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="P:System.Messaging.Message.SecurityContext" />
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public Guid Id { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Id" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Id" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Id As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Id { Guid get(); };" />
      <MemberSignature Language="F#" Value="member this.Id : Guid" Usage="System.Messaging.MessageQueue.Id" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_GuidId")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1471">Получает уникальный идентификатор очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1471">Gets the unique Message Queuing identifier of the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-1472">Свойство <see cref="P:System.Messaging.MessageQueue.Id" />, представляющее идентификатор сообщения, создаваемый приложением очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1472">A <see cref="P:System.Messaging.MessageQueue.Id" /> that represents the message identifier generated by the Message Queuing application.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1473">Message Queuing присваивает <xref:System.Messaging.MessageQueue.Id%2A> свойства при создании очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1473">Message Queuing sets the <xref:System.Messaging.MessageQueue.Id%2A> property when it creates the queue.</span></span> <span data-ttu-id="37b16-1474">Это свойство доступно только для общих очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1474">This property is only available for public queues.</span></span>  
  
 <span data-ttu-id="37b16-1475">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1475">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1476">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1476">Workgroup mode</span></span>|<span data-ttu-id="37b16-1477">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1477">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1478">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1478">Local computer</span></span>|<span data-ttu-id="37b16-1479">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1479">Yes</span></span>|  
|<span data-ttu-id="37b16-1480">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1480">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1481">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1481">Yes</span></span>|  
|<span data-ttu-id="37b16-1482">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1482">Remote computer</span></span>|<span data-ttu-id="37b16-1483">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1483">No</span></span>|  
|<span data-ttu-id="37b16-1484">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1484">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1485">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1485">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1486">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.Id%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1486">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Id%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1487">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1487">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteQueueSize">
      <MemberSignature Language="C#" Value="public static readonly long InfiniteQueueSize;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly int64 InfiniteQueueSize" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteQueueSize As Long " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly long InfiniteQueueSize;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteQueueSize : int64" Usage="System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1488">Указывает, что для очереди нет ограничений по размеру.</span><span class="sxs-lookup"><span data-stu-id="37b16-1488">Specifies that no size restriction exists for a queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1489">Этот элемент часто используется при задании <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> или <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1489">This member is frequently used when setting <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> or <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1490">В следующем примере кода демонстрируется использование <xref:System.Messaging.MessageQueue.InfiniteQueueSize> член.</span><span class="sxs-lookup"><span data-stu-id="37b16-1490">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteQueueSize> member.</span></span>  
  
 [!code-csharp[MessageQueue#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="F#" Value=" staticval mutable InfiniteTimeout : TimeSpan" Usage="System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1491">Указывает, что для методов считывания и получения сообщений не существует тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="37b16-1491">Specifies that no time-out exists for methods that peek or receive messages.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1492"><xref:System.Messaging.MessageQueue> поддерживает два типа методов извлечения сообщений: синхронные и асинхронные.</span><span class="sxs-lookup"><span data-stu-id="37b16-1492"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="37b16-1493">Синхронные методы, <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.Receive%2A>, поток процесса ожидания указанный интервал времени для нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1493">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-1494">Если заданный интервал времени <xref:System.Messaging.MessageQueue.InfiniteTimeout>, поток процесса, пока заблокированных доступно новое сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1494">If the specified time interval is <xref:System.Messaging.MessageQueue.InfiniteTimeout>, the process thread remains blocked until a new message is available.</span></span> <span data-ttu-id="37b16-1495">С другой стороны <xref:System.Messaging.MessageQueue.BeginPeek%2A> и <xref:System.Messaging.MessageQueue.BeginReceive%2A> (асинхронных методов), разрешить основные задачи приложения продолжают выполняться в отдельном потоке, до получения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1495">On the other hand, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A> (the asynchronous methods), allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1496">В следующем примере кода демонстрируется использование <xref:System.Messaging.MessageQueue.InfiniteTimeout> член.</span><span class="sxs-lookup"><span data-stu-id="37b16-1496">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteTimeout> member.</span></span>  
  
 [!code-csharp[MessageQueue#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Label">
      <MemberSignature Language="C#" Value="public string Label { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Label" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Label" />
      <MemberSignature Language="VB.NET" Value="Public Property Label As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Label { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Label : string with get, set" Usage="System.Messaging.MessageQueue.Label" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Label")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1497">Получает или задает описание очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1497">Gets or sets the queue description.</span></span></summary>
        <value><span data-ttu-id="37b16-1498">Метка очереди сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1498">The label for the message queue.</span></span> <span data-ttu-id="37b16-1499">Значение по умолчанию — пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="37b16-1499">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1500">Максимальная длина метки очереди сообщений — 124 символа.</span><span class="sxs-lookup"><span data-stu-id="37b16-1500">The maximum length of a message queue label is 124 characters.</span></span>  
  
 <span data-ttu-id="37b16-1501"><xref:System.Messaging.MessageQueue.Label%2A> Свойство не должно быть уникальным для всех очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-1501">The <xref:System.Messaging.MessageQueue.Label%2A> property does not need to be unique across all queues.</span></span> <span data-ttu-id="37b16-1502">Тем не менее если несколько очередей одного и того же <xref:System.Messaging.MessageQueue.Label%2A>, нельзя использовать <xref:System.Messaging.MessageQueue.Send%28System.Object%29> метод для передачи сообщения к каждому из них.</span><span class="sxs-lookup"><span data-stu-id="37b16-1502">However, if multiple queues share the same <xref:System.Messaging.MessageQueue.Label%2A>, you cannot use the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method to broadcast a message to all of them.</span></span> <span data-ttu-id="37b16-1503">Если вы используете синтаксис метки для <xref:System.Messaging.MessageQueue.Path%2A> свойство при отправке сообщения, будет создано исключение при <xref:System.Messaging.MessageQueue.Label%2A> не является уникальным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1503">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="37b16-1504">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1504">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1505">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1505">Workgroup mode</span></span>|<span data-ttu-id="37b16-1506">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1506">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1507">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1507">Local computer</span></span>|<span data-ttu-id="37b16-1508">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1508">Yes</span></span>|  
|<span data-ttu-id="37b16-1509">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1509">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1510">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1510">Yes</span></span>|  
|<span data-ttu-id="37b16-1511">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1511">Remote computer</span></span>|<span data-ttu-id="37b16-1512">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1512">No</span></span>|  
|<span data-ttu-id="37b16-1513">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1513">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1514">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1514">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1515">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.Label%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1515">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Label%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1516">Для метки задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1516">The label was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1517">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="LastModifyTime">
      <MemberSignature Language="C#" Value="public DateTime LastModifyTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime LastModifyTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.LastModifyTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LastModifyTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime LastModifyTime { DateTime get(); };" />
      <MemberSignature Language="F#" Value="member this.LastModifyTime : DateTime" Usage="System.Messaging.MessageQueue.LastModifyTime" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_LastModifyTime")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1518">Получает время последнего изменения свойств очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1518">Gets the last time the properties of a queue were modified.</span></span></summary>
        <value><span data-ttu-id="37b16-1519">Объект <see cref="T:System.DateTime" />, который указывает, когда свойства очереди были изменены в последний раз.</span><span class="sxs-lookup"><span data-stu-id="37b16-1519">A <see cref="T:System.DateTime" /> that indicates when the queue properties were last modified.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1520">Время последнего изменения включает в себя при создании очереди, а также <xref:System.Messaging.MessageQueue> свойство, которое изменяет очередь Message Queuing, такие как <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1520">The last modification time includes when the queue was created and any <xref:System.Messaging.MessageQueue> property that modifies the Message Queuing queue, such as <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span></span> <span data-ttu-id="37b16-1521">Значение <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство представляет системное время на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="37b16-1521">The value of the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property represents the system time of the local computer.</span></span>  
  
 <span data-ttu-id="37b16-1522">Необходимо вызвать <xref:System.Messaging.MessageQueue.Refresh%2A> перед получением <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство; в противном случае время изменения, связанное с данным <xref:System.Messaging.MessageQueue> могут устареть.</span><span class="sxs-lookup"><span data-stu-id="37b16-1522">You must call <xref:System.Messaging.MessageQueue.Refresh%2A> before getting the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property; otherwise, the modification time associated with this <xref:System.Messaging.MessageQueue> might not be current.</span></span>  
  
 <span data-ttu-id="37b16-1523">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1523">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1524">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1524">Workgroup mode</span></span>|<span data-ttu-id="37b16-1525">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1525">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1526">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1526">Local computer</span></span>|<span data-ttu-id="37b16-1527">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1527">Yes</span></span>|  
|<span data-ttu-id="37b16-1528">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1528">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1529">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1529">Yes</span></span>|  
|<span data-ttu-id="37b16-1530">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1530">Remote computer</span></span>|<span data-ttu-id="37b16-1531">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1531">No</span></span>|  
|<span data-ttu-id="37b16-1532">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1532">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1533">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1533">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1534">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1534">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1535">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1535">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CreateTime" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Messaging.MessageQueue.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MachineName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1536">Получает или задает имя компьютера, на котором расположена очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-1536">Gets or sets the name of the computer where the Message Queuing queue is located.</span></span></summary>
        <value><span data-ttu-id="37b16-1537">Имя компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1537">The name of the computer where the queue is located.</span></span> <span data-ttu-id="37b16-1538">По умолчанию службой Message Queuing используется значение ".", т. е. локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-1538">The Message Queuing default is ".", the local computer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1539"><xref:System.Messaging.MessageQueue.MachineName%2A> — Это встроенный компонент синтаксиса понятное имя очереди <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1539">The <xref:System.Messaging.MessageQueue.MachineName%2A> is an integral component of the friendly name syntax of the queue <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="37b16-1540">Следующая таблица показывает синтаксис, который следует использовать для очереди заданного типа, когда нужно определить путь к очереди, используя его понятное имя.</span><span class="sxs-lookup"><span data-stu-id="37b16-1540">The following table shows the syntax you should use for a queue of a specified type when you want to identify the queue path using its friendly name.</span></span>  
  
|<span data-ttu-id="37b16-1541">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1541">Queue type</span></span>|<span data-ttu-id="37b16-1542">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-1542">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-1543">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1543">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-1544">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1544">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="37b16-1545">Очереди журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-1545">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="37b16-1546">Очереди журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-1546">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="37b16-1547">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-1547">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="37b16-1548">Транзакционная очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-1548">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="37b16-1549">Используйте «.» для локального компьютера, при указании <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1549">Use "." for the local computer when specifying the <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="37b16-1550">Только имя компьютера распознается для этого свойства, например, `Server0`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1550">Only the computer name is recognized for this property, for example, `Server0`.</span></span> <span data-ttu-id="37b16-1551"><xref:System.Messaging.MessageQueue.MachineName%2A> Свойство не поддерживает формат IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="37b16-1551">The <xref:System.Messaging.MessageQueue.MachineName%2A> property does not support the IP address format.</span></span>  
  
 <span data-ttu-id="37b16-1552">Если вы определяете <xref:System.Messaging.MessageQueue.Path%2A> на основе <xref:System.Messaging.MessageQueue.MachineName%2A>, приложение вызывает исключение при работе в автономном режиме, так как контроллер домена является обязательным для перевода пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-1552">If you define the <xref:System.Messaging.MessageQueue.Path%2A> in terms of the <xref:System.Messaging.MessageQueue.MachineName%2A>, the application throws an exception when working offline because the domain controller is required for path translation.</span></span> <span data-ttu-id="37b16-1553">Таким образом, необходимо использовать <xref:System.Messaging.MessageQueue.FormatName%2A> для <xref:System.Messaging.MessageQueue.Path%2A> синтаксис при работе в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="37b16-1553">Therefore, you must use the <xref:System.Messaging.MessageQueue.FormatName%2A> for the <xref:System.Messaging.MessageQueue.Path%2A> syntax when working offline.</span></span>  
  
 <span data-ttu-id="37b16-1554"><xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, И <xref:System.Messaging.MessageQueue.QueueName%2A> связанные свойства.</span><span class="sxs-lookup"><span data-stu-id="37b16-1554">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="37b16-1555">Изменение <xref:System.Messaging.MessageQueue.MachineName%2A> свойству <xref:System.Messaging.MessageQueue.Path%2A> изменяемое свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1555">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="37b16-1556">Он формируется на основе нового <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1556">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="37b16-1557">Изменение <xref:System.Messaging.MessageQueue.Path%2A> (например, чтобы использовать синтаксис имени формата) сбрасывает <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A> свойства для ссылки на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1557">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span> <span data-ttu-id="37b16-1558">Если <xref:System.Messaging.MessageQueue.QueueName%2A> свойство пусто, <xref:System.Messaging.MessageQueue.Path%2A> устанавливается в очередь журнала компьютера вами.</span><span class="sxs-lookup"><span data-stu-id="37b16-1558">If the <xref:System.Messaging.MessageQueue.QueueName%2A> property is empty, the <xref:System.Messaging.MessageQueue.Path%2A> is set to the Journal queue of the computer you specify.</span></span>  
  
 <span data-ttu-id="37b16-1559">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1559">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1560">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1560">Workgroup mode</span></span>|<span data-ttu-id="37b16-1561">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1561">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1562">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1562">Local computer</span></span>|<span data-ttu-id="37b16-1563">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1563">Yes</span></span>|  
|<span data-ttu-id="37b16-1564">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1564">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1565">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1565">Yes</span></span>|  
|<span data-ttu-id="37b16-1566">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1566">Remote computer</span></span>|<span data-ttu-id="37b16-1567">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1567">Yes</span></span>|  
|<span data-ttu-id="37b16-1568">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1568">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1569">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1569">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1570">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.MachineName%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1570">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MachineName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1571">Значение параметра <see cref="P:System.Messaging.MessageQueue.MachineName" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1571">The <see cref="P:System.Messaging.MessageQueue.MachineName" /> is <see langword="null" />.</span></span>        
<span data-ttu-id="37b16-1572">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-1572">-or-</span></span>

<span data-ttu-id="37b16-1573">Недопустимое имя компьютера. Причиной может быть неверный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="37b16-1573">The name of the computer is not valid, possibly because the syntax is incorrect.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1574">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1574">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="MaximumJournalSize">
      <MemberSignature Language="C#" Value="public long MaximumJournalSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumJournalSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumJournalSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumJournalSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumJournalSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumJournalSize")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1575">Получает или задает максимальный размер очереди журнала.</span><span class="sxs-lookup"><span data-stu-id="37b16-1575">Gets or sets the maximum size of the journal queue.</span></span></summary>
        <value><span data-ttu-id="37b16-1576">Максимальный размер очереди журнала в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="37b16-1576">The maximum size, in kilobytes, of the journal queue.</span></span> <span data-ttu-id="37b16-1577">По умолчанию службой Message Queuing не устанавливаются ограничения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1577">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1578"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> предоставляет доступ к ограничению в хранилища очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1578"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> provides access to the Message Queuing journal storage limit.</span></span> <span data-ttu-id="37b16-1579">Это значение, только если <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> является `true`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1579">It is relevant only when <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> is `true`.</span></span> <span data-ttu-id="37b16-1580">Задание этого свойства изменяет очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-1580">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="37b16-1581">Таким образом, любой другой <xref:System.Messaging.MessageQueue> экземпляры будут затронуты данным изменением</span><span class="sxs-lookup"><span data-stu-id="37b16-1581">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="37b16-1582">Если хранение сообщений в журнале или в очередь недоставленных сообщений, необходимо периодически очищать очередь сообщений, которые больше не нужны.</span><span class="sxs-lookup"><span data-stu-id="37b16-1582">If you store messages in a journal or dead-letter queue, you should periodically clear the queue to remove messages that are no longer needed.</span></span> <span data-ttu-id="37b16-1583">Сообщений в такой очереди учитываются квоты сообщений для компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1583">Messages in such a queue count toward the message quota for the computer where the queue resides.</span></span> <span data-ttu-id="37b16-1584">(Администратор устанавливает квота компьютера).</span><span class="sxs-lookup"><span data-stu-id="37b16-1584">(The administrator sets the computer quota.)</span></span>  
  
 <span data-ttu-id="37b16-1585">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1585">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1586">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1586">Workgroup mode</span></span>|<span data-ttu-id="37b16-1587">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1587">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1588">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1588">Local computer</span></span>|<span data-ttu-id="37b16-1589">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1589">Yes</span></span>|  
|<span data-ttu-id="37b16-1590">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1590">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1591">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1591">Yes</span></span>|  
|<span data-ttu-id="37b16-1592">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1592">Remote computer</span></span>|<span data-ttu-id="37b16-1593">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1593">No</span></span>|  
|<span data-ttu-id="37b16-1594">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1594">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1595">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1595">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1596">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1596">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1597">Для максимального размера очереди журнала установлено недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1597">The maximum journal queue size was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1598">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1598">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MaximumQueueSize">
      <MemberSignature Language="C#" Value="public long MaximumQueueSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumQueueSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumQueueSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumQueueSize { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumQueueSize : int64 with get, set" Usage="System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumQueueSize")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.SizeConverter))</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1599">Получает или задает максимальный размер очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1599">Gets or sets the maximum size of the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-1600">Максимальный размер очереди в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="37b16-1600">The maximum size, in kilobytes, of the queue.</span></span> <span data-ttu-id="37b16-1601">По умолчанию службой Message Queuing не устанавливаются ограничения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1601">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1602"><xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> Предоставляет доступ к очереди сообщений хранения ограничения на количество сообщений, которая отличается от квоты сообщений компьютера, который администратор определяет.</span><span class="sxs-lookup"><span data-stu-id="37b16-1602">The <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> provides access to the Message Queuing message storage limit, which is separate from the computer's message quota that the administrator defines.</span></span> <span data-ttu-id="37b16-1603">Дополнительные сведения о квоты сообщений, см. в разделе <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1603">For more information about the message quota, see <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span></span>  
  
 <span data-ttu-id="37b16-1604">Задание этого свойства изменяет очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-1604">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="37b16-1605">Таким образом, любой другой <xref:System.Messaging.MessageQueue> экземпляры будут затронуты данным изменением</span><span class="sxs-lookup"><span data-stu-id="37b16-1605">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="37b16-1606">Если попытка превышают максимальный размер очереди или квоты сообщений компьютера, сообщения могут быть утеряны.</span><span class="sxs-lookup"><span data-stu-id="37b16-1606">If an attempt is made to exceed either the maximum queue size or the computer message quota, messages might be lost.</span></span> <span data-ttu-id="37b16-1607">При достижении квоты очереди Message Queuing уведомляет очереди администрирования, отправляющего приложения, чтобы указать, что очередь заполнена, возвращая сообщение отрицательного подтверждения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1607">When the queue quota is reached, Message Queuing notifies the administration queue of the sending application to indicate that the queue is full, by returning a negative acknowledgment message.</span></span> <span data-ttu-id="37b16-1608">Служба очереди сообщений продолжит отправлять отрицательные подтверждения, пока общий размер сообщений в очереди не станет ниже ограничения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1608">Message Queuing continues to send negative acknowledgments until the total size of the messages in the queue drops below the limit.</span></span>  
  
 <span data-ttu-id="37b16-1609">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1609">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1610">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1610">Workgroup mode</span></span>|<span data-ttu-id="37b16-1611">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1611">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1612">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1612">Local computer</span></span>|<span data-ttu-id="37b16-1613">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1613">Yes</span></span>|  
|<span data-ttu-id="37b16-1614">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1614">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1615">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1615">Yes</span></span>|  
|<span data-ttu-id="37b16-1616">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1616">Remote computer</span></span>|<span data-ttu-id="37b16-1617">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1617">No</span></span>|  
|<span data-ttu-id="37b16-1618">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1618">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1619">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1619">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1620">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1620">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1621">Максимальный размер очереди содержит отрицательное значение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1621">The maximum queue size contains a negative value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1622">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1622">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MessageReadPropertyFilter">
      <MemberSignature Language="C#" Value="public System.Messaging.MessagePropertyFilter MessageReadPropertyFilter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.MessagePropertyFilter MessageReadPropertyFilter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageReadPropertyFilter As MessagePropertyFilter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::MessagePropertyFilter ^ MessageReadPropertyFilter { System::Messaging::MessagePropertyFilter ^ get(); void set(System::Messaging::MessagePropertyFilter ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MessageReadPropertyFilter : System.Messaging.MessagePropertyFilter with get, set" Usage="System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MessageReadPropertyFilter")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Content)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessagePropertyFilter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1623">Получает или задает фильтр свойств для получения и считывания сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1623">Gets or sets the property filter for receiving or peeking messages.</span></span></summary>
        <value><span data-ttu-id="37b16-1624">Объект <see cref="T:System.Messaging.MessagePropertyFilter" />, который очередь использует для фильтрации набора свойств, получаемого или считываемого ею для каждого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1624">The <see cref="T:System.Messaging.MessagePropertyFilter" /> used by the queue to filter the set of properties it receives or peeks for each message.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1625">Этот фильтр — это набор логических значений, ограничивающих свойства сообщения, <xref:System.Messaging.MessageQueue> получаемые или считываемые.</span><span class="sxs-lookup"><span data-stu-id="37b16-1625">This filter is a set of Boolean values restricting the message properties that the <xref:System.Messaging.MessageQueue> receives or peeks.</span></span> <span data-ttu-id="37b16-1626">Когда <xref:System.Messaging.MessageQueue> получаемые или считываемые сообщения из очереди сервера, он извлекает только те свойства, для которого <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> значение `true`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1626">When the <xref:System.Messaging.MessageQueue> receives or peeks a message from the server queue, it retrieves only those properties for which the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> value is `true`.</span></span>  
  
 <span data-ttu-id="37b16-1627">Ниже представлены исходные значения свойств для <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1627">The following shows initial property values for the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span> <span data-ttu-id="37b16-1628">Эти параметры аналогичны вызова <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> на <xref:System.Messaging.MessagePropertyFilter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1628">These settings are identical to calling <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> on a <xref:System.Messaging.MessagePropertyFilter>.</span></span>  
  
|<span data-ttu-id="37b16-1629">Свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1629">Property</span></span>|<span data-ttu-id="37b16-1630">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="37b16-1630">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessagePropertyFilter.Acknowledgment%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AcknowledgeType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AdministrationQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AppSpecific%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ArrivedTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AttachSenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Authenticated%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderName%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Body%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.ConnectorType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.CorrelationId%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultBodySize%2A>|<span data-ttu-id="37b16-1631">1024 байт</span><span class="sxs-lookup"><span data-stu-id="37b16-1631">1024 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultExtensionSize%2A>|<span data-ttu-id="37b16-1632">255 байт</span><span class="sxs-lookup"><span data-stu-id="37b16-1632">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultLabelSize%2A>|<span data-ttu-id="37b16-1633">255 байт</span><span class="sxs-lookup"><span data-stu-id="37b16-1633">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationSymmetricKey%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DigitalSignature%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.EncryptionAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Extension%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.HashAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Id%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.IsFirstInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.IsLastInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Label%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.MessageType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Priority%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Recoverable%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ResponseQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderCertificate%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderVersion%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SentTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SourceMachine%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToBeReceived%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToReachQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionStatusQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="37b16-1634">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1634">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1635">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1635">Workgroup mode</span></span>|<span data-ttu-id="37b16-1636">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1636">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1637">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1637">Local computer</span></span>|<span data-ttu-id="37b16-1638">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1638">Yes</span></span>|  
|<span data-ttu-id="37b16-1639">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1639">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1640">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1640">Yes</span></span>|  
|<span data-ttu-id="37b16-1641">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1641">Remote computer</span></span>|<span data-ttu-id="37b16-1642">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1642">Yes</span></span>|  
|<span data-ttu-id="37b16-1643">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1643">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1644">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1644">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1645">В следующем примере кода используется <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> для ограничения полученных свойств сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1645">The following code example uses the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> to restrict the message properties received.</span></span>  
  
 [!code-cpp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CPP/mqmessagereadpropertyfilter.cpp#1)]
 [!code-csharp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CS/mqmessagereadpropertyfilter.cs#1)]
 [!code-vb[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/VB/mqmessagereadpropertyfilter.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1646">Значение фильтра — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1646">The filter is <see langword="null" />.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="MulticastAddress">
      <MemberSignature Language="C#" Value="public string MulticastAddress { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MulticastAddress" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MulticastAddress" />
      <MemberSignature Language="VB.NET" Value="Public Property MulticastAddress As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MulticastAddress { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MulticastAddress : string with get, set" Usage="System.Messaging.MessageQueue.MulticastAddress" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_MulticastAddress")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1647">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1647">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-1648">Получает или задает адрес многоадресной рассылки, связанный с данной очередью.</span><span class="sxs-lookup"><span data-stu-id="37b16-1648">Gets or sets the multicast address associated with the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-1649">Объект <see cref="T:System.String" />, содержащий допустимый групповой адрес (в виде, показанном ниже) или значение <see langword="null" />, которое указывает, что очередь не связана с групповым адресом.</span><span class="sxs-lookup"><span data-stu-id="37b16-1649">A <see cref="T:System.String" /> that contains a valid multicast address (in the form shown below) or <see langword="null" />, which indicates that the queue is not associated with a multicast address.</span></span>  
  
```  
&lt;address&gt;:&lt;port&gt;  
```</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1650"><xref:System.Messaging.MessageQueue.MulticastAddress%2A> Свойство используется для сопоставления нетранзакционной очереди с адресом многоадресной рассылки, который может использоваться при отправке сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1650">The <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property is used to associate a non-transactional queue with a multicast address that can be used when sending messages.</span></span> <span data-ttu-id="37b16-1651">Невозможно связать транзакционной очереди с адресом многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="37b16-1651">You cannot associate a transactional queue with a multicast address.</span></span> <span data-ttu-id="37b16-1652">Если отправляющее приложение отправляет сообщения на адрес многоадресной рассылки, служба Message Queuing передает копию сообщения в каждую очередь, связанную с этим адресом.</span><span class="sxs-lookup"><span data-stu-id="37b16-1652">When the sending application sends messages to a multicast address, Message Queuing sends a copy of the message to every queue associated with that address.</span></span>  
  
 <span data-ttu-id="37b16-1653">Многоадресная IP-рассылка адреса должны быть в диапазоне класса D от 224.0.0.0 до 239.255.255.255, который соответствует установке первых четырех старших разрядов равными 1110.</span><span class="sxs-lookup"><span data-stu-id="37b16-1653">IP multicast addresses must be in the class D range from 224.0.0.0 to 239.255.255.255, which corresponds to setting the first four high-order bits equal to 1110.</span></span> <span data-ttu-id="37b16-1654">Однако только определенные диапазоны адресов в этом диапазоне будут зарезервированы и доступны для отправки сообщений многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="37b16-1654">However, only certain ranges of addresses in this range are unreserved and available for sending multicast messages.</span></span> <span data-ttu-id="37b16-1655">Обновленный список зарезервированных адресов многоадресной рассылки, см. в разделе [номер центра IANA (Internet Assigned) адресов многоадресной рассылки](https://go.microsoft.com/fwlink/?linkid=3859) веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1655">For the latest list of reserved multicast addresses, see the [Internet Assigned Number Authority (IANA) Internet Multicast Addresses](https://go.microsoft.com/fwlink/?linkid=3859) Web page.</span></span> <span data-ttu-id="37b16-1656">Существуют ограничения на номер порта.</span><span class="sxs-lookup"><span data-stu-id="37b16-1656">There are no restrictions on the port number.</span></span>  
  
 <span data-ttu-id="37b16-1657">Если несколько исходные компьютеры отправляют сообщения многоадресной рассылки, и вы хотите определенной очереди для получения сообщений из только с одного компьютера, каждого исходного компьютера необходимо отправлять сообщения на разные комбинации IP-адрес и порт номер.</span><span class="sxs-lookup"><span data-stu-id="37b16-1657">If several source computers are sending multicast messages and you want a specific queue to receive messages from only one source computer, each source computer must send messages to a different combination of IP address and port number.</span></span>  
  
 <span data-ttu-id="37b16-1658">Чтобы отменить связь очереди с адресом многоадресной рассылки, задайте <xref:System.Messaging.MessageQueue.MulticastAddress%2A> строку нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="37b16-1658">To dissociate a queue from a multicast address, set the <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property to a zero-length string.</span></span> <span data-ttu-id="37b16-1659">Не задавайте его `null`, так как это вызовет <xref:System.ArgumentNullException>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1659">Do not set it to `null`, as this will result in a <xref:System.ArgumentNullException>.</span></span>  
  
 <span data-ttu-id="37b16-1660">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1660">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1661">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1661">Workgroup mode</span></span>|<span data-ttu-id="37b16-1662">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1662">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1663">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1663">Local computer</span></span>|<span data-ttu-id="37b16-1664">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1664">Yes</span></span>|  
|<span data-ttu-id="37b16-1665">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1665">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1666">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1666">Yes</span></span>|  
|<span data-ttu-id="37b16-1667">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1667">Remote computer</span></span>|<span data-ttu-id="37b16-1668">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1668">No</span></span>|  
|<span data-ttu-id="37b16-1669">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1669">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1670">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1670">No</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="37b16-1671">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-1671">MSMQ 3.0 is not installed.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Path">
      <MemberSignature Language="C#" Value="public string Path { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Path" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Path" />
      <MemberSignature Language="VB.NET" Value="Public Property Path As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Path { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Path : string with get, set" Usage="System.Messaging.MessageQueue.Path" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Path")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.RefreshProperties(System.ComponentModel.RefreshProperties.All)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1672">Получает или задает путь очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1672">Gets or sets the queue's path.</span></span> <span data-ttu-id="37b16-1673">После задания свойства <see cref="P:System.Messaging.MessageQueue.Path" /> объект <see cref="T:System.Messaging.MessageQueue" /> будет указывать на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1673">Setting the <see cref="P:System.Messaging.MessageQueue.Path" /> causes the <see cref="T:System.Messaging.MessageQueue" /> to point to a new queue.</span></span></summary>
        <value><span data-ttu-id="37b16-1674">Очередь, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1674">The queue that is referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-1675">Значение по умолчанию зависит от того, какой используется конструктор <see cref="M:System.Messaging.MessageQueue.#ctor" />. Значение равно либо <see langword="null" />, либо задается параметром <paramref name="path" /> конструктора.</span><span class="sxs-lookup"><span data-stu-id="37b16-1675">The default depends on which <see cref="M:System.Messaging.MessageQueue.#ctor" /> constructor you use; it is either <see langword="null" /> or is specified by the constructor's <paramref name="path" /> parameter.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1676">Синтаксис <xref:System.Messaging.MessageQueue.Path%2A> свойство зависит от типа очереди его точки to, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-1676">The syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue it points to, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-1677">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1677">Queue type</span></span>|<span data-ttu-id="37b16-1678">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-1678">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-1679">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1679">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-1680">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-1680">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="37b16-1681">Очереди журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-1681">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="37b16-1682">Очереди журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-1682">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="37b16-1683">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-1683">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="37b16-1684">Транзакционная очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="37b16-1684">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="37b16-1685">Используйте «.» для представления локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="37b16-1685">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="37b16-1686"><xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, И <xref:System.Messaging.MessageQueue.QueueName%2A> связанные свойства.</span><span class="sxs-lookup"><span data-stu-id="37b16-1686">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="37b16-1687">Изменение <xref:System.Messaging.MessageQueue.MachineName%2A> свойству <xref:System.Messaging.MessageQueue.Path%2A> изменяемое свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1687">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="37b16-1688">Он формируется на основе нового <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1688">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="37b16-1689">Изменение <xref:System.Messaging.MessageQueue.Path%2A> (например, чтобы использовать синтаксис имени формата) сбрасывает <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A> свойства для ссылки на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1689">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span>  
  
 <span data-ttu-id="37b16-1690">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-1690">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-1691">Ссылка</span><span class="sxs-lookup"><span data-stu-id="37b16-1691">Reference</span></span>|<span data-ttu-id="37b16-1692">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-1692">Syntax</span></span>|<span data-ttu-id="37b16-1693">Пример</span><span class="sxs-lookup"><span data-stu-id="37b16-1693">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="37b16-1694">Название формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1694">Format name</span></span>|<span data-ttu-id="37b16-1695">`FormatName:` [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-1695">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="37b16-1696">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="37b16-1696">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span>|  
|<span data-ttu-id="37b16-1697">Метка</span><span class="sxs-lookup"><span data-stu-id="37b16-1697">Label</span></span>|<span data-ttu-id="37b16-1698">`Label:` [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="37b16-1698">`Label:` [ *label* ]</span></span>|<span data-ttu-id="37b16-1699">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="37b16-1699">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="37b16-1700">Если вы используете синтаксис метки для <xref:System.Messaging.MessageQueue.Path%2A> свойство при отправке сообщения, будет создано исключение при <xref:System.Messaging.MessageQueue.Label%2A> не является уникальным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1700">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="37b16-1701">Чтобы работать в автономном режиме, необходимо использовать синтаксис имени формата, а не синтаксис понятное имя в первой таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-1701">To work offline, you must use the format name syntax, rather than the friendly name syntax in the first table.</span></span> <span data-ttu-id="37b16-1702">В противном случае создается исключение, поскольку основного контроллера домена (на котором установлена Active Directory) не поддерживается для разрешения пути в имя формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-1702">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="37b16-1703">После задания нового пути очередь сообщений будет закрыта и все дескрипторы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1703">Setting a new path closes the message queue and releases all handles.</span></span>  
  
 <span data-ttu-id="37b16-1704">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1704">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1705">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1705">Workgroup mode</span></span>|<span data-ttu-id="37b16-1706">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1706">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1707">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1707">Local computer</span></span>|<span data-ttu-id="37b16-1708">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1708">Yes</span></span>|  
|<span data-ttu-id="37b16-1709">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1709">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1710">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1710">Yes</span></span>|  
|<span data-ttu-id="37b16-1711">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1711">Remote computer</span></span>|<span data-ttu-id="37b16-1712">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1712">Yes</span></span>|  
|<span data-ttu-id="37b16-1713">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1713">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1714">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1714">Yes</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="37b16-1715">В режиме рабочей группы можно использовать только частные очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1715">In workgroup mode you can only use private queues.</span></span> <span data-ttu-id="37b16-1716">Укажите путь, используя синтаксис частную очередь `MachineName` \\ `Private$` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="37b16-1716">You specify the path using the private queue syntax `MachineName`\\`Private$`\\`QueueName`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1717">В следующем примере кода создает новые <xref:System.Messaging.MessageQueue> объекты с различными типами синтаксис имени пути.</span><span class="sxs-lookup"><span data-stu-id="37b16-1717">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="37b16-1718">В каждом случае он отправляет сообщение в очередь, чей путь, определенный в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="37b16-1718">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1719">Недопустимый путь. Возможно из-за неправильного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="37b16-1719">The path is not valid, possibly because the syntax is not valid.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Peek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="37b16-1720">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1720">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="37b16-1721">Возвращает копию первого сообщения в очереди, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1721">Returns a copy of the first message in the queue without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek();" />
      <MemberSignature Language="F#" Value="member this.Peek : unit -&gt; System.Messaging.Message" Usage="messageQueue.Peek " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1722">Возвращает, не удаляя (считывает), первое сообщение в очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1722">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-1723">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1723">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available.</span></span></summary>
        <returns><span data-ttu-id="37b16-1724">Объект <see cref="T:System.Messaging.Message" />, представляющий первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1724">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1725">Используйте эту перегрузку для считывания очереди или ожидания поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1725">Use this overload to peek a queue, or to wait until a message exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1726"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет из очереди первое сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1726">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="37b16-1727">Таким образом, повторные вызовы <xref:System.Messaging.MessageQueue.Peek%2A> возвращать то же сообщение, в том случае, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1727">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-1728"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, считывает и удаляет из очереди первое сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1728">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="37b16-1729">Повторные вызовы <xref:System.Messaging.MessageQueue.Receive%2A>, поэтому возвращать различные сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1729">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="37b16-1730">Служба Message Queuing упорядочивает сообщения в очереди в соответствии с приоритетом и временем поступления.</span><span class="sxs-lookup"><span data-stu-id="37b16-1730">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="37b16-1731">Новое сообщение помещается перед более старым, только в том случае, если он имеет более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="37b16-1731">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="37b16-1732">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1732">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-1733">Так как эта перегрузка не указывает время ожидания, приложение может ожидать неопределенное время.</span><span class="sxs-lookup"><span data-stu-id="37b16-1733">Because this overload does not specify a time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="37b16-1734">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1734">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span> <span data-ttu-id="37b16-1735">Кроме того, можно указать время ожидания для поступления сообщения в очереди с помощью перегрузки <xref:System.Messaging.MessageQueue.Peek%2A> , указывающий время ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-1735">Alternatively, you can specify a time-out for a message to arrive in the queue by using the overload of <xref:System.Messaging.MessageQueue.Peek%2A> that specifies a time-out.</span></span>  
  
 <span data-ttu-id="37b16-1736">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1736">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1737">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1737">Workgroup mode</span></span>|<span data-ttu-id="37b16-1738">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1738">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1739">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1739">Local computer</span></span>|<span data-ttu-id="37b16-1740">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1740">Yes</span></span>|  
|<span data-ttu-id="37b16-1741">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1741">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1742">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1742">Yes</span></span>|  
|<span data-ttu-id="37b16-1743">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1743">Remote computer</span></span>|<span data-ttu-id="37b16-1744">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1744">No</span></span>|  
|<span data-ttu-id="37b16-1745">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1745">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1746">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1746">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1747">В следующих примерах используется <xref:System.Messaging.MessageQueue.Peek%2A> метод в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1747">The following examples use the <xref:System.Messaging.MessageQueue.Peek%2A> method on a queue.</span></span>  
  
 <span data-ttu-id="37b16-1748">В первом примере приложение ожидает, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1748">In the first example, the application waits until a message becomes available in the queue.</span></span> <span data-ttu-id="37b16-1749">Обратите внимание, что первый пример не осуществляет доступ к сообщение, поступающее; он просто приостанавливает обработку до получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1749">Note that the first example does not access the message that arrives; it merely pauses processing until a message arrives.</span></span> <span data-ttu-id="37b16-1750">Если сообщение уже существует в очереди, то возвращается немедленно.</span><span class="sxs-lookup"><span data-stu-id="37b16-1750">If a message already exists in the queue, it will return immediately.</span></span>  
  
 <span data-ttu-id="37b16-1751">Во втором примере, сообщение, содержащее определяемые приложением `Order` класс отправляются в очередь и затем считывается из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1751">In the second example, a message that contains an application-defined `Order` class is sent to the queue, and then peeked from the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CPP/mqpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Peek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CS/mqpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.Peek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_noparms/VB/mqpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1752">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1752">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-1753">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1753">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Peek timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-1754">Объект <see cref="T:System.TimeSpan" />, показывающий максимальное время ожидания появления первого сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1754">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <summary><span data-ttu-id="37b16-1755">Возвращает, не удаляя (считывает), первое сообщение в очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1755">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-1756">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным или пока не истечет заданный тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-1756">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-1757">Объект <see cref="T:System.Messaging.Message" />, представляющий первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1757">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1758">Используйте эту перегрузку для считывания очереди или ожидания в указанный период времени поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1758">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="37b16-1759">Метод возвращает немедленно, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1759">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1760"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет из очереди первое сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1760">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="37b16-1761">Таким образом, повторные вызовы <xref:System.Messaging.MessageQueue.Peek%2A> возвращать то же сообщение, в том случае, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1761">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-1762"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, считывает и удаляет из очереди первое сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1762">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="37b16-1763">Повторные вызовы <xref:System.Messaging.MessageQueue.Receive%2A>, поэтому возвращать различные сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1763">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="37b16-1764">Служба Message Queuing упорядочивает сообщения в очереди в соответствии с приоритетом и временем поступления.</span><span class="sxs-lookup"><span data-stu-id="37b16-1764">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="37b16-1765">Новое сообщение помещается перед более старым, только в том случае, если он имеет более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="37b16-1765">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="37b16-1766">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1766">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-1767">Поток будет заблокирован в течение указанного периода времени, или не ограничено, если вы говорите о рассчитанном <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1767">The thread will be blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="37b16-1768">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1768">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-1769">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1769">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1770">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1770">Workgroup mode</span></span>|<span data-ttu-id="37b16-1771">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1771">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1772">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1772">Local computer</span></span>|<span data-ttu-id="37b16-1773">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1773">Yes</span></span>|  
|<span data-ttu-id="37b16-1774">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1774">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1775">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1775">Yes</span></span>|  
|<span data-ttu-id="37b16-1776">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1776">Remote computer</span></span>|<span data-ttu-id="37b16-1777">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1777">No</span></span>|  
|<span data-ttu-id="37b16-1778">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1778">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1779">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1779">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1780">В следующем примере кода используется <xref:System.Messaging.MessageQueue.Peek%2A> метод с таймаут, равный нулю, чтобы проверить, пуста ли очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1780">The following code example uses the <xref:System.Messaging.MessageQueue.Peek%2A> method with a time-out of zero to check whether the queue is empty.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CPP/mqpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Peek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CS/mqpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.Peek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_timeout/VB/mqpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1781">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1781">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1782">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1782">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-1783">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1783">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action);" />
      <MemberSignature Language="F#" Value="member this.Peek : TimeSpan * System.Messaging.Cursor * System.Messaging.PeekAction -&gt; System.Messaging.Message" Usage="messageQueue.Peek (timeout, cursor, action)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-1784">Объект <see cref="T:System.TimeSpan" />, показывающий максимальное время ожидания появления первого сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1784">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <param name="cursor"><span data-ttu-id="37b16-1785">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-1785">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="37b16-1786">Одно из значений <see cref="T:System.Messaging.PeekAction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1786">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="37b16-1787">Указывает, следует ли считывать текущее сообщение в очереди или следующее сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1787">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <summary><span data-ttu-id="37b16-1788">Возвращает, не удаляя (считывает), текущее или следующее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="37b16-1788">Returns without removing (peeks) the current or next message in the queue, using the specified cursor.</span></span> <span data-ttu-id="37b16-1789">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным или пока не истечет заданный тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-1789">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-1790">Объект <see cref="T:System.Messaging.Message" />, представляющий сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1790">A <see cref="T:System.Messaging.Message" /> that represents a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1791">Используйте эту перегрузку для считывания очереди или ожидания в указанный период времени поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1791">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="37b16-1792">Метод возвращает немедленно, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1792">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1793"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1793">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, a message from the queue.</span></span> <span data-ttu-id="37b16-1794"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, считывает и удаляет сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1794">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes a message from the queue.</span></span>  
  
 <span data-ttu-id="37b16-1795">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1795">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-1796">Поток блокируется вплоть до указанного периода времени, или не ограничено, если вы говорите о рассчитанном <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1796">The thread is blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="37b16-1797">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1797">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-1798">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1798">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1799">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1799">Workgroup mode</span></span>|<span data-ttu-id="37b16-1800">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1800">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1801">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1801">Local computer</span></span>|<span data-ttu-id="37b16-1802">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1802">Yes</span></span>|  
|<span data-ttu-id="37b16-1803">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1803">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1804">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1804">Yes</span></span>|  
|<span data-ttu-id="37b16-1805">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1805">Remote computer</span></span>|<span data-ttu-id="37b16-1806">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1806">No</span></span>|  
|<span data-ttu-id="37b16-1807">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1807">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1808">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1808">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="37b16-1809">Для параметра <paramref name="action" /> было задано значение, отличное от <see langword="PeekAction.Current" /> или <see langword="PeekAction.Next" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1809">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1810">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1810">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1811">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-1811">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="37b16-1812">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1812">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1813">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1813">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-1814">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-1814">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.PeekAction" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-1815">Считывает сообщение, которое соответствует заданному идентификатору корреляции.</span><span class="sxs-lookup"><span data-stu-id="37b16-1815">Peeks a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-1816">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1816">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="37b16-1817">Считывает сообщение, которое соответствует заданному идентификатору корреляции, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="37b16-1817">Peeks the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-1818">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1818">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1819">Этот метод ищет в очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1819">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-1820">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1820">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-1821"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1821">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-1822">Два других метода позволяют просматривать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1822">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="37b16-1823"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-1823">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-1824">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1824">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1825">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1825">Workgroup mode</span></span>|<span data-ttu-id="37b16-1826">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1826">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1827">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1827">Local computer</span></span>|<span data-ttu-id="37b16-1828">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1828">Yes</span></span>|  
|<span data-ttu-id="37b16-1829">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1829">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1830">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1830">Yes</span></span>|  
|<span data-ttu-id="37b16-1831">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1831">Remote computer</span></span>|<span data-ttu-id="37b16-1832">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1832">No</span></span>|  
|<span data-ttu-id="37b16-1833">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1833">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1834">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1834">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1835">В следующем примере кода отправляет и получает сообщение, содержащее заказ в и из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1835">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="37b16-1836">Он специально запрашивает положительного подтверждения в случае, когда исходное сообщение достигает или извлечено из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1836">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1837">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1837">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1838">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1838">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1839">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1839">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-1840">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1840">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-1841">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-1841">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="37b16-1842">Считывает сообщение, которое соответствует заданному идентификатору корреляции и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-1842">Peeks the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-1843">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1843">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1844">Этот метод ищет в очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1844">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-1845">Если сообщение не найдено, соответствующий `correlationID` параметра и новое сообщение прибывает в очереди в течение периода, указанного `timeout` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1845">If no message is found that matches the `correlationID` parameter, and no new message arrives in the queue within the period specified by the `timeout` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-1846">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1846">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-1847">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1847">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-1848">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, соответствует ли `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1848">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="37b16-1849">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1849">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-1850">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1850">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-1851"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-1851">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-1852">Два других метода позволяют просматривать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1852">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="37b16-1853"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-1853">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-1854">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1854">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1855">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1855">Workgroup mode</span></span>|<span data-ttu-id="37b16-1856">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1856">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1857">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1857">Local computer</span></span>|<span data-ttu-id="37b16-1858">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1858">Yes</span></span>|  
|<span data-ttu-id="37b16-1859">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1859">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1860">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1860">Yes</span></span>|  
|<span data-ttu-id="37b16-1861">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1861">Remote computer</span></span>|<span data-ttu-id="37b16-1862">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1862">No</span></span>|  
|<span data-ttu-id="37b16-1863">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1863">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1864">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1864">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1865">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1865">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#5](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#5)]
 [!code-csharp[MessageQueue2#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1866">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1866">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1867">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1867">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1868">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="37b16-1868">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1869">Сообщений до истечения тайм-аута не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-1869">A message did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-1870">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-1870">-or-</span></span> 
<span data-ttu-id="37b16-1871">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1871">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-1872">Возвращает копию сообщения с указанным идентификатором сообщения, не удаляя это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1872">Returns a copy of the message that has the specified message identifier without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string -&gt; System.Messaging.Message" Usage="messageQueue.PeekById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-1873">Свойство <see cref="P:System.Messaging.Message.Id" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1873">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="37b16-1874">Считывает сообщение, идентификатор которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1874">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span></summary>
        <returns><span data-ttu-id="37b16-1875">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1875">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1876">Используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> для чтения, не удаляя его из очереди, сообщение со свойством с известным идентификатором сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1876">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="37b16-1877">Идентификатор сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1877">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="37b16-1878">Эта перегрузка создает исключение, если в настоящий момент очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1878">This overload throws an exception if the queue does not currently contain the message.</span></span>  
  
 <span data-ttu-id="37b16-1879">Два дополнительных метода позволяют просматривать сообщения в очереди: <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1879">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="37b16-1880"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> возвращает подтверждение, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1880">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-1881">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1881">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1882">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1882">Workgroup mode</span></span>|<span data-ttu-id="37b16-1883">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1883">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1884">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1884">Local computer</span></span>|<span data-ttu-id="37b16-1885">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1885">Yes</span></span>|  
|<span data-ttu-id="37b16-1886">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1886">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1887">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1887">Yes</span></span>|  
|<span data-ttu-id="37b16-1888">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1888">Remote computer</span></span>|<span data-ttu-id="37b16-1889">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1889">No</span></span>|  
|<span data-ttu-id="37b16-1890">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1890">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1891">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1891">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1892">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1892">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#6](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#6)]
 [!code-csharp[MessageQueue2#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1893">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1893">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1894">Нет сообщения с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1894">No message with the specified <paramref name="id" /> exists.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1895">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1895">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.PeekById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.PeekById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-1896">Свойство <see cref="P:System.Messaging.Message.Id" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1896">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-1897">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-1897">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="37b16-1898">Считывает сообщение, идентификатор которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1898">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span> <span data-ttu-id="37b16-1899">Ожидает, пока сообщение не появится в очереди, или не возникнет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-1899">Waits until the message appears in the queue or a time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="37b16-1900">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1900">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1901">Используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> для чтения, не удаляя его из очереди, сообщение со свойством с известным идентификатором сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1901">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="37b16-1902">Идентификатор сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1902">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="37b16-1903">Эта перегрузка создает исключение, если в настоящий момент очереди нет сообщения, а новое сообщение не поступило до истечения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="37b16-1903">This overload throws an exception if the queue does not currently contain the message and a new message does not arrive before the time-out occurs.</span></span>  
  
 <span data-ttu-id="37b16-1904">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-1904">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-1905">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1905">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-1906">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, соответствует ли `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1906">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="37b16-1907">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1907">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-1908">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1908">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-1909">Два дополнительных метода позволяют просматривать сообщения в очереди: <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1909">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="37b16-1910"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> возвращает подтверждение, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-1910">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-1911">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1911">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1912">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1912">Workgroup mode</span></span>|<span data-ttu-id="37b16-1913">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1913">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1914">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1914">Local computer</span></span>|<span data-ttu-id="37b16-1915">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1915">Yes</span></span>|  
|<span data-ttu-id="37b16-1916">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1916">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1917">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1917">Yes</span></span>|  
|<span data-ttu-id="37b16-1918">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1918">Remote computer</span></span>|<span data-ttu-id="37b16-1919">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1919">No</span></span>|  
|<span data-ttu-id="37b16-1920">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1920">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1921">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1921">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1922">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-1922">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#7](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#7)]
 [!code-csharp[MessageQueue2#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-1923">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1923">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-1924">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1924">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1925">Сообщение с заданным параметром <paramref name="id" /> не существует в очереди и не поступило до истечения периода времени, установленного параметром <paramref name="timeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1925">The message with the specified <paramref name="id" /> does not exist in the queue and did not arrive before the period specified by the <paramref name="timeout" /> parameter expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1926">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1926">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-1927">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1927">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-1928">Считывает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1928">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="37b16-1929">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1929">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="37b16-1930">Свойство <see cref="P:System.Messaging.Message.LookupId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1930">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at.</span></span></param>
        <summary><span data-ttu-id="37b16-1931">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1931">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-1932">Считывает сообщение, соответствующее заданному идентификатору просмотра, из нетранзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1932">Peeks at the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-1933">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.LookupId" /> которого соответствует переданному в объект параметру <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1933">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1934">Этот метод можно используйте для чтения сообщения с известным кодом просмотра, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1934">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="37b16-1935">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1935">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1936"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди где находится сообщение, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1936">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-1937">Для чтения сообщения с указанным кодом просмотра и удалите его из очереди, используйте <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-1937">To read a message with a specified lookup identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-1938">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1938">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1939">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1939">Workgroup mode</span></span>|<span data-ttu-id="37b16-1940">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1940">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1941">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1941">Local computer</span></span>|<span data-ttu-id="37b16-1942">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1942">Yes</span></span>|  
|<span data-ttu-id="37b16-1943">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1943">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1944">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1944">Yes</span></span>|  
|<span data-ttu-id="37b16-1945">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1945">Remote computer</span></span>|<span data-ttu-id="37b16-1946">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1946">No</span></span>|  
|<span data-ttu-id="37b16-1947">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1947">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1948">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1948">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="37b16-1949">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-1949">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1950">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1950">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1951">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1951">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (System.Messaging.MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Messaging.MessageLookupAction,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (action As MessageLookupAction, lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(System::Messaging::MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="F#" Value="member this.PeekByLookupId : System.Messaging.MessageLookupAction * int64 -&gt; System.Messaging.Message" Usage="messageQueue.PeekByLookupId (action, lookupId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="37b16-1952">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1952">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="37b16-1953">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="37b16-1953">Specify one of the following:</span></span> 
 <span data-ttu-id="37b16-1954"><see langword="MessageLookupAction.Current" />: считывает сообщение, заданное параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1954"><see langword="MessageLookupAction.Current" />: Peeks at the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="37b16-1955"><see langword="MessageLookupAction.Next" />: считывает сообщение, следующее за сообщением, заданным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1955"><see langword="MessageLookupAction.Next" />: Peeks at the message following the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="37b16-1956"><see langword="MessageLookupAction.Previous" />: считывает сообщение, предшествующее сообщению, заданному параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1956"><see langword="MessageLookupAction.Previous" />: Peeks at the message preceding the message specified by <paramref name="lookupId" />.</span></span>  
  
 <span data-ttu-id="37b16-1957"><see langword="MessageLookupAction.First" />: считывает первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1957"><see langword="MessageLookupAction.First" />: Peeks at the first message in the queue.</span></span> <span data-ttu-id="37b16-1958">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1958">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="37b16-1959"><see langword="MessageLookupAction.Last" />: считывает последнее сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1959"><see langword="MessageLookupAction.Last" />: Peeks at the last message in the queue.</span></span> <span data-ttu-id="37b16-1960">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1960">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="37b16-1961">Свойство <see cref="P:System.Messaging.Message.LookupId" /> считываемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1961">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at, or 0.</span></span> <span data-ttu-id="37b16-1962">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1962">0 is used when accessing the first or last message in the queue.</span></span></param>
        <summary><span data-ttu-id="37b16-1963">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-1963">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-1964">Считывает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1964">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="37b16-1965">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1965">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-1966">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="action" /> и <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1966">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1967">Этот метод можно используйте для чтения сообщения с известным кодом просмотра, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1967">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="37b16-1968">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-1968">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1969"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди где находится сообщение, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-1969">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-1970">Чтобы прочитать сообщение с указанным идентификатором и удалите его из очереди, используйте <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-1970">To read a message with a specified identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-1971">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-1971">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-1972">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-1972">Workgroup mode</span></span>|<span data-ttu-id="37b16-1973">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-1973">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-1974">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1974">Local computer</span></span>|<span data-ttu-id="37b16-1975">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1975">Yes</span></span>|  
|<span data-ttu-id="37b16-1976">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1976">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-1977">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1977">Yes</span></span>|  
|<span data-ttu-id="37b16-1978">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-1978">Remote computer</span></span>|<span data-ttu-id="37b16-1979">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-1979">No</span></span>|  
|<span data-ttu-id="37b16-1980">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-1980">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-1981">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-1981">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="37b16-1982">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-1982">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-1983">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1983">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-1984">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-1984">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-1985">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1985">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.PeekCompletedEventHandler PeekCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.PeekCompletedEventHandler PeekCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.PeekCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event PeekCompleted As PeekCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::PeekCompletedEventHandler ^ PeekCompleted;" />
      <MemberSignature Language="F#" Value="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " Usage="member this.PeekCompleted : System.Messaging.PeekCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_PeekCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.PeekCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-1986">Происходит, когда сообщение читается без удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1986">Occurs when a message is read without being removed from the queue.</span></span> <span data-ttu-id="37b16-1987">Это результат асинхронной операции — <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-1987">This is a result of the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1988"><xref:System.Messaging.MessageQueue.BeginPeek%2A> используется при асинхронной обработке, чтобы вызвать <xref:System.Messaging.MessageQueue.PeekCompleted> событие, когда сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1988"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="37b16-1989"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> используется для завершения операции, инициированной вызовом <xref:System.Messaging.MessageQueue.BeginPeek%2A> и просмотра сообщения при <xref:System.Messaging.MessageQueue.PeekCompleted> события.</span><span class="sxs-lookup"><span data-stu-id="37b16-1989"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> and peek the message when the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="37b16-1990">При создании делегата <xref:System.Messaging.PeekCompletedEventHandler> необходимо указать метод, обрабатывающий событие.</span><span class="sxs-lookup"><span data-stu-id="37b16-1990">When you create a <xref:System.Messaging.PeekCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="37b16-1991">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="37b16-1991">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="37b16-1992">Обработчик событий вызывается всякий раз, когда происходит событие, если делегат не удален.</span><span class="sxs-lookup"><span data-stu-id="37b16-1992">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="37b16-1993">Дополнительные сведения о делегатов обработчиков событий, см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="37b16-1993">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="37b16-1994">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginPeek%2A> инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="37b16-1994">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="37b16-1995">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события, в примере считывает сообщение и выводит его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-1995">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="37b16-1996">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать асинхронную операцию просмотра</span><span class="sxs-lookup"><span data-stu-id="37b16-1996">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Purge">
      <MemberSignature Language="C#" Value="public void Purge ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Purge() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Purge" />
      <MemberSignature Language="VB.NET" Value="Public Sub Purge ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Purge();" />
      <MemberSignature Language="F#" Value="member this.Purge : unit -&gt; unit" Usage="messageQueue.Purge " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-1997">Удаляет все сообщения, содержащиеся в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-1997">Deletes all the messages contained in the queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-1998">Очистка очереди приводит к очереди сообщений задать флаг изменения очереди, который влияет на <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-1998">Purging the queue causes Message Queuing to set the queue modification flag, which affects the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span> <span data-ttu-id="37b16-1999">Сообщения, удаленные из очереди будут утеряны; они отправляются в очередь недоставленных сообщений или в очередь журнала.</span><span class="sxs-lookup"><span data-stu-id="37b16-1999">Messages that are purged from the queue are lost; they are not sent to the dead-letter queue or the journal queue.</span></span>  
  
 <span data-ttu-id="37b16-2000">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2000">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2001">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2001">Workgroup mode</span></span>|<span data-ttu-id="37b16-2002">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2002">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2003">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2003">Local computer</span></span>|<span data-ttu-id="37b16-2004">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2004">Yes</span></span>|  
|<span data-ttu-id="37b16-2005">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2005">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2006">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2006">Yes</span></span>|  
|<span data-ttu-id="37b16-2007">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2007">Remote computer</span></span>|<span data-ttu-id="37b16-2008">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2008">No</span></span>|  
|<span data-ttu-id="37b16-2009">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2009">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2010">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2010">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2011">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Purge%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2011">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Purge%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#29](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#29)]
 [!code-csharp[MessageQueue2#29](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#29)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2012">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2012">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="M:System.Messaging.MessageQueue.Refresh" />
      </Docs>
    </Member>
    <Member MemberName="QueueName">
      <MemberSignature Language="C#" Value="public string QueueName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string QueueName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.QueueName" />
      <MemberSignature Language="VB.NET" Value="Public Property QueueName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ QueueName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.QueueName : string with get, set" Usage="System.Messaging.MessageQueue.QueueName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_QueueName")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-2013">Получает или задает понятное имя, определяющее очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2013">Gets or sets the friendly name that identifies the queue.</span></span></summary>
        <value><span data-ttu-id="37b16-2014">Имя, определяющее очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2014">The name that identifies the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-2015">Значение <see langword="null" /> недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-2015">The value cannot be <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2016">Вы можете объединить <xref:System.Messaging.MessageQueue.QueueName%2A> с <xref:System.Messaging.MessageQueue.MachineName%2A> создать понятное <xref:System.Messaging.MessageQueue.Path%2A> имя для очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2016">You can combine the <xref:System.Messaging.MessageQueue.QueueName%2A> with the <xref:System.Messaging.MessageQueue.MachineName%2A> to create a friendly <xref:System.Messaging.MessageQueue.Path%2A> name for the queue.</span></span> <span data-ttu-id="37b16-2017">Синтаксис понятное имя разновидность <xref:System.Messaging.MessageQueue.Path%2A> свойство зависит от типа очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="37b16-2017">The syntax for the friendly name variation of the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="37b16-2018">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-2018">Queue type</span></span>|<span data-ttu-id="37b16-2019">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="37b16-2019">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="37b16-2020">Общей очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-2020">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="37b16-2021">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-2021">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="37b16-2022">Очереди журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-2022">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
  
 <span data-ttu-id="37b16-2023">Используйте «.» для представления локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="37b16-2023">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="37b16-2024">Изменение <xref:System.Messaging.MessageQueue.QueueName%2A> свойство влияет на <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-2024">Changing the <xref:System.Messaging.MessageQueue.QueueName%2A> property affects the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="37b16-2025">Если задать <xref:System.Messaging.MessageQueue.QueueName%2A> без параметра <xref:System.Messaging.MessageQueue.MachineName%2A> свойство, <xref:System.Messaging.MessageQueue.Path%2A> свойство становится.\\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="37b16-2025">If you set the <xref:System.Messaging.MessageQueue.QueueName%2A> without setting the <xref:System.Messaging.MessageQueue.MachineName%2A> property, the <xref:System.Messaging.MessageQueue.Path%2A> property becomes .\\`QueueName`.</span></span> <span data-ttu-id="37b16-2026">В противном случае <xref:System.Messaging.MessageQueue.Path%2A> становится `MachineName` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="37b16-2026">Otherwise, the <xref:System.Messaging.MessageQueue.Path%2A> becomes `MachineName`\\`QueueName`.</span></span>  
  
 <span data-ttu-id="37b16-2027">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2027">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2028">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2028">Workgroup mode</span></span>|<span data-ttu-id="37b16-2029">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2029">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2030">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2030">Local computer</span></span>|<span data-ttu-id="37b16-2031">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2031">Yes</span></span>|  
|<span data-ttu-id="37b16-2032">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2032">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2033">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2033">Yes</span></span>|  
|<span data-ttu-id="37b16-2034">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2034">Remote computer</span></span>|<span data-ttu-id="37b16-2035">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2035">Yes</span></span>|  
|<span data-ttu-id="37b16-2036">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2036">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2037">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2037">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2038">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.QueueName%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-2038">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.QueueName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2039">Значение имени очереди — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2039">The queue name is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="ReadHandle">
      <MemberSignature Language="C#" Value="public IntPtr ReadHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int ReadHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.ReadHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ReadHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr ReadHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.ReadHandle : nativeint" Usage="System.Messaging.MessageQueue.ReadHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReadHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-2040">Получает собственный дескриптор, предназначенный для чтения сообщений из очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-2040">Gets the native handle used to read messages from the message queue.</span></span></summary>
        <value><span data-ttu-id="37b16-2041">Дескриптор собственного объекта очереди, который используется для считывания и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2041">A handle to the native queue object that you use for peeking and receiving messages from the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2042"><xref:System.Messaging.MessageQueue.ReadHandle%2A> Предоставляет собственный дескриптор Windows для объекта очереди сообщений, который используется для просмотра и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2042">The <xref:System.Messaging.MessageQueue.ReadHandle%2A> provides a native Windows handle to the message queue object that is used for peeking and receiving messages from the queue.</span></span> <span data-ttu-id="37b16-2043">Если вы измените путь к очереди, маркер закрыть и открыть с новым значением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2043">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="37b16-2044">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2044">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2045">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2045">Workgroup mode</span></span>|<span data-ttu-id="37b16-2046">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2046">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2047">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2047">Local computer</span></span>|<span data-ttu-id="37b16-2048">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2048">Yes</span></span>|  
|<span data-ttu-id="37b16-2049">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2049">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2050">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2050">Yes</span></span>|  
|<span data-ttu-id="37b16-2051">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2051">Remote computer</span></span>|<span data-ttu-id="37b16-2052">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2052">No</span></span>|  
|<span data-ttu-id="37b16-2053">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2053">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2054">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2054">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2055">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2055">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Receive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="37b16-2056">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2056">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="37b16-2057">Получает первое сообщение в очереди, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2057">Receives the first message in the queue, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive();" />
      <MemberSignature Language="F#" Value="member this.Receive : unit -&gt; System.Messaging.Message" Usage="messageQueue.Receive " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-2058">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2058">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-2059">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2059">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="37b16-2060">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2060">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2061">Используйте эту перегрузку для получения сообщения из очереди или подождать, пока в очереди есть сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2061">Use this overload to receive a message from a queue, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2062"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2062">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2063">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди, или новые сообщения с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="37b16-2063">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="37b16-2064">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2064">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2065"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2065">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2066">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2066">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2067">Поскольку данная перегруженная версия <xref:System.Messaging.MessageQueue.Receive%2A> метод задает неограниченное время ожидания, приложение может ожидать неопределенное время.</span><span class="sxs-lookup"><span data-stu-id="37b16-2067">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="37b16-2068">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2068">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2069">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2069">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2070">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2070">Workgroup mode</span></span>|<span data-ttu-id="37b16-2071">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2071">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2072">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2072">Local computer</span></span>|<span data-ttu-id="37b16-2073">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2073">Yes</span></span>|  
|<span data-ttu-id="37b16-2074">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2074">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2075">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2075">Yes</span></span>|  
|<span data-ttu-id="37b16-2076">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2076">Remote computer</span></span>|<span data-ttu-id="37b16-2077">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2077">No</span></span>|  
|<span data-ttu-id="37b16-2078">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2078">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2079">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2079">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2080">В следующем примере кода получает сообщение из очереди и выводит сведения о сообщении на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-2080">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2081">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2081">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive transaction" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="transaction"><span data-ttu-id="37b16-2082">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2082">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2083">Получает первое доступное в транзакционной очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2083">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-2084">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2084">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="37b16-2085">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2085">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2086">Используйте этот перегруженный метод для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` параметр или подождите, пока в очереди есть сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2086">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2087"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2087">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2088">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2088">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2089">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2089">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2090">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2090">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2091">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2091">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2092"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2092">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2093">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2093">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="37b16-2094">Так как <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует откат путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2094">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2095">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2095">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2096">Поскольку данная перегруженная версия <xref:System.Messaging.MessageQueue.Receive%2A> метод задает неограниченное время ожидания, приложение может ожидать неопределенное время.</span><span class="sxs-lookup"><span data-stu-id="37b16-2096">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="37b16-2097">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2097">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2098">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2098">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2099">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2099">Workgroup mode</span></span>|<span data-ttu-id="37b16-2100">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2100">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2101">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2101">Local computer</span></span>|<span data-ttu-id="37b16-2102">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2102">Yes</span></span>|  
|<span data-ttu-id="37b16-2103">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2103">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2104">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2104">Yes</span></span>|  
|<span data-ttu-id="37b16-2105">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2105">Remote computer</span></span>|<span data-ttu-id="37b16-2106">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2106">No</span></span>|  
|<span data-ttu-id="37b16-2107">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2107">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2108">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2108">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2109">В следующем примере кода подключается к транзакционной очереди на локальном компьютере и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2109">The following code example connects to a transactional queue on the local computer and sends a message to the queue.</span></span> <span data-ttu-id="37b16-2110">Затем он получает сообщение, содержащее заказ.</span><span class="sxs-lookup"><span data-stu-id="37b16-2110">It then receives the message that contains an order.</span></span> <span data-ttu-id="37b16-2111">При обнаружении нетранзакционную очередь, вызовет исключение и производится откат транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2111">If it encounters a non-transactional queue, it will throw and exception and rollback the transaction.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_transaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CPP/mqreceive_transaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_transaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CS/mqreceive_transaction.cs#1)]
 [!code-vb[MessageQueue.Receive_transaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_transaction/VB/mqreceive_transaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2112">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2112">An error occurred when accessing a Message Queuing method.</span></span>  
  
<span data-ttu-id="37b16-2113">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2113">-or-</span></span> 
<span data-ttu-id="37b16-2114">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2114">The queue is non-transactional.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2115">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2115">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive transactionType" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="transactionType"><span data-ttu-id="37b16-2116">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2116">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2117">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2117">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-2118">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2118">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="37b16-2119">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2119">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2120">Используйте этот перегруженный метод для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` параметр или подождите, пока в очереди есть сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2120">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2121">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2121">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2122">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2122">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2123">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2123">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2124"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2124">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2125">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2125">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2126">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2126">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2127">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2127">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2128">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2128">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2129"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2129">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2130">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2130">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="37b16-2131">Так как <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует откат путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2131">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2132">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2132">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2133">Поскольку данная перегруженная версия <xref:System.Messaging.MessageQueue.Receive%2A> метод задает неограниченное время ожидания, приложение может ожидать неопределенное время.</span><span class="sxs-lookup"><span data-stu-id="37b16-2133">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="37b16-2134">Если обработка приложения должна продолжаться без ожидания сообщения, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2134">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2135">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2135">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2136">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2136">Workgroup mode</span></span>|<span data-ttu-id="37b16-2137">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2137">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2138">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2138">Local computer</span></span>|<span data-ttu-id="37b16-2139">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2139">Yes</span></span>|  
|<span data-ttu-id="37b16-2140">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2140">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2141">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2141">Yes</span></span>|  
|<span data-ttu-id="37b16-2142">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2142">Remote computer</span></span>|<span data-ttu-id="37b16-2143">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2143">No</span></span>|  
|<span data-ttu-id="37b16-2144">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2144">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2145">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2145">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2146">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2146">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#9](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#9)]
 [!code-csharp[MessageQueue2#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2147">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2147">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2148">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2148">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2149">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2149">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.Receive timeout" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-2150">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2150">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="37b16-2151">Получает первое сообщение, доступное в очереди, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />, и ожидает пока в очереди не появится сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2151">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2152">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2152">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2153">Используйте эту перегрузку для получения сообщений и их возврата в течение указанного срока, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-2153">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2154"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2154">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, removing it from the queue.</span></span> <span data-ttu-id="37b16-2155">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди, или новые сообщения с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="37b16-2155">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="37b16-2156">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2156">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2157"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2157">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2158">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2158">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2159">Поток будет заблокирован на указанный период времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2159">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2160">Если обработка приложения должна продолжаться без ожидания сообщение, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2160">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2161">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2161">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2162">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2162">Workgroup mode</span></span>|<span data-ttu-id="37b16-2163">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2163">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2164">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2164">Local computer</span></span>|<span data-ttu-id="37b16-2165">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2165">Yes</span></span>|  
|<span data-ttu-id="37b16-2166">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2166">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2167">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2167">Yes</span></span>|  
|<span data-ttu-id="37b16-2168">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2168">Remote computer</span></span>|<span data-ttu-id="37b16-2169">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2169">No</span></span>|  
|<span data-ttu-id="37b16-2170">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2170">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2171">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2171">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2172">В следующем примере кода получает сообщение из очереди и выводит сведения о сообщении на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-2172">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span> <span data-ttu-id="37b16-2173">В примере приостанавливается выполнение до пяти секунд при ожидании поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2173">The example pauses execution for up to five seconds while waiting for a message to arrive in the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CPP/mqreceive_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Receive_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CS/mqreceive_timeout.cs#1)]
 [!code-vb[MessageQueue.Receive_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_timeout/VB/mqreceive_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2174">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2174">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2175">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2175">A message did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2176">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2176">-or-</span></span> 
<span data-ttu-id="37b16-2177">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2177">An error occurred when accessing a Message Queuing method</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2178">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2178">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-2179">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2179">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="37b16-2180">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-2180">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <summary><span data-ttu-id="37b16-2181">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2181">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="37b16-2182">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2182">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2183">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2183">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2184">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2184">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2185">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2185">A message did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2186">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2186">-or-</span></span> 
<span data-ttu-id="37b16-2187">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2187">An error occurred when accessing a Message Queuing method</span></span> 
<span data-ttu-id="37b16-2188">Используйте эту перегрузку для получения сообщений и их возврата в течение указанного срока, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-2188">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2189">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2189">The method is not thread safe.</span></span></threadsafe>
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-2190">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2190">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2191">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2191">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2192">Получает первое сообщение, доступное в транзакционной очереди, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />, и ожидает, пока в очереди не появится сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2192">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2193">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2193">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2194">Используйте этот перегруженный метод для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` и возврата в определенный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2194">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2195"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2195">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2196">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2196">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2197">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2197">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2198">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2198">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2199">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2199">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2200"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2200">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2201">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2201">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="37b16-2202">Так как <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует откат путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2202">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2203">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2203">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2204">Поток будет заблокирован на указанный период времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2204">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2205">Если обработка приложения должна продолжаться без ожидания сообщение, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2205">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2206">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2206">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2207">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2207">Workgroup mode</span></span>|<span data-ttu-id="37b16-2208">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2208">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2209">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2209">Local computer</span></span>|<span data-ttu-id="37b16-2210">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2210">Yes</span></span>|  
|<span data-ttu-id="37b16-2211">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2211">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2212">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2212">Yes</span></span>|  
|<span data-ttu-id="37b16-2213">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2213">Remote computer</span></span>|<span data-ttu-id="37b16-2214">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2214">No</span></span>|  
|<span data-ttu-id="37b16-2215">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2215">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2216">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2216">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2217">В следующем примере кода показано использование этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2217">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CPP/mqreceive_timeouttransaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CS/mqreceive_timeouttransaction.cs#1)]
 [!code-vb[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/VB/mqreceive_timeouttransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2218">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2218">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2219">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2219">A message did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2220">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2220">-or-</span></span> 
<span data-ttu-id="37b16-2221">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2221">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="37b16-2222">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2222">-or-</span></span> 
<span data-ttu-id="37b16-2223">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2223">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2224">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2224">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-2225">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2225">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2226">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2226">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2227">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2227">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="37b16-2228">Данный вызов является синхронным, и он ожидает, пока в очереди не появится сообщение, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2228">This call is synchronous, and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2229">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2229">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2230">Используйте этот перегруженный метод для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` и возврата в указанный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2230">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2231">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2231">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2232">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2232">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2233">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2233">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2234"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2234">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2235">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2235">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2236">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2236">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2237">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2237">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2238">Чтобы прочитать первое сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2238">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2239"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2239">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2240">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2240">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="37b16-2241">Так как <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует откат путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2241">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2242">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2242">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2243">Поток будет заблокирован на указанный период времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2243">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2244">Если обработка приложения должна продолжаться без ожидания сообщение, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2244">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2245">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2245">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2246">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2246">Workgroup mode</span></span>|<span data-ttu-id="37b16-2247">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2247">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2248">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2248">Local computer</span></span>|<span data-ttu-id="37b16-2249">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2249">Yes</span></span>|  
|<span data-ttu-id="37b16-2250">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2250">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2251">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2251">Yes</span></span>|  
|<span data-ttu-id="37b16-2252">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2252">Remote computer</span></span>|<span data-ttu-id="37b16-2253">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2253">No</span></span>|  
|<span data-ttu-id="37b16-2254">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2254">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2255">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2255">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2256">В следующем примере кода показано использование этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2256">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue2#8](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#8)]
 [!code-csharp[MessageQueue2#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2257">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2257">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2258">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2258">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2259">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2259">A message did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2260">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2260">-or-</span></span> 
<span data-ttu-id="37b16-2261">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2261">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2262">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2262">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-2263">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2263">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="37b16-2264">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-2264">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2265">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2265">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2266">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2266">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="37b16-2267">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2267">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2268">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2268">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2269">Используйте этот перегруженный метод для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` и возврата в определенный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2269">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2270"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2270">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2271">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращать сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2271">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2272">Так как этот метод вызывается в транзакционной очереди, полученное сообщение возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2272">Because this method is called on a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2273">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2273">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2274">Чтобы прочитать сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2274">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2275">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2275">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="37b16-2276">Так как <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, нет ничего для отката путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2276">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2277">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2277">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2278">Поток блокируется за указанный период времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2278">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2279">Если обработка приложения должна продолжаться без ожидания сообщение, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2279">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2280">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2280">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2281">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2281">Workgroup mode</span></span>|<span data-ttu-id="37b16-2282">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2282">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2283">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2283">Local computer</span></span>|<span data-ttu-id="37b16-2284">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2284">Yes</span></span>|  
|<span data-ttu-id="37b16-2285">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2285">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2286">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2286">Yes</span></span>|  
|<span data-ttu-id="37b16-2287">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2287">Remote computer</span></span>|<span data-ttu-id="37b16-2288">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2288">No</span></span>|  
|<span data-ttu-id="37b16-2289">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2289">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2290">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2290">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2291">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2291">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="37b16-2292">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2292">-or-</span></span> 
<span data-ttu-id="37b16-2293">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2293">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2294">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-2294">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="37b16-2295">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2295">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2296">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2296">A message did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2297">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2297">-or-</span></span> 
<span data-ttu-id="37b16-2298">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2298">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="37b16-2299">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2299">-or-</span></span> 
<span data-ttu-id="37b16-2300">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2300">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2301">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2301">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Receive : TimeSpan * System.Messaging.Cursor * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.Receive (timeout, cursor, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="37b16-2302">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2302">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="37b16-2303">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-2303">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2304">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2304">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values that describes the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2305">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2305">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="37b16-2306">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2306">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2307">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2307">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2308">Используйте этот перегруженный метод для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` и возврата в указанный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2308">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2309">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2309">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2310">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2310">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2311">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2311">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2312"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет синхронное чтение сообщения, тем самым убирая его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2312">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="37b16-2313">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращать сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2313">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2314">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2314">If this method is called to receive a message from a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2315">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2315">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2316">Чтобы прочитать сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2316">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="37b16-2317">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2317">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="37b16-2318">Так как <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, нет ничего для отката путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2318">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2319">Вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2319">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2320">Поток блокируется за указанный период времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2320">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2321">Если обработка приложения должна продолжаться без ожидания сообщение, рассмотрите возможность использования асинхронного метода, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2321">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="37b16-2322">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2322">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2323">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2323">Workgroup mode</span></span>|<span data-ttu-id="37b16-2324">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2324">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2325">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2325">Local computer</span></span>|<span data-ttu-id="37b16-2326">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2326">Yes</span></span>|  
|<span data-ttu-id="37b16-2327">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2327">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2328">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2328">Yes</span></span>|  
|<span data-ttu-id="37b16-2329">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2329">Remote computer</span></span>|<span data-ttu-id="37b16-2330">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2330">No</span></span>|  
|<span data-ttu-id="37b16-2331">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2331">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2332">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2332">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2333">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2333">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2334">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="37b16-2334">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="37b16-2335">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2335">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2336">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2336">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2337">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2337">A message did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2338">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2338">-or-</span></span> 
<span data-ttu-id="37b16-2339">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="37b16-2340">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="37b16-2340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-2341">Получает сообщение, которое соответствует заданному идентификатору корреляции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2341">Receives a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId correlationId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-2342">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2342">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="37b16-2343">Получает сообщение, которое соответствует заданному идентификатору корреляции (из нетранзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2343">Receives the message that matches the given correlation identifier (from a non-transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2344">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2344">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2345">Этот метод ищет в нетранзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2345">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2346">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2346">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="37b16-2347">В противном случае сообщение удаляется из очереди и возвращаются в приложение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2347">Otherwise, the message is removed from the queue and returned to the application.</span></span>  
  
 <span data-ttu-id="37b16-2348"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2348">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-2349">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2349">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2350"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод получает сообщение, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2350">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method retrieves a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-2351">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2351">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2352"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2352">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2353">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2353">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2354">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2354">Workgroup mode</span></span>|<span data-ttu-id="37b16-2355">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2355">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2356">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2356">Local computer</span></span>|<span data-ttu-id="37b16-2357">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2357">Yes</span></span>|  
|<span data-ttu-id="37b16-2358">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2358">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2359">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2359">Yes</span></span>|  
|<span data-ttu-id="37b16-2360">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2360">Remote computer</span></span>|<span data-ttu-id="37b16-2361">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2361">No</span></span>|  
|<span data-ttu-id="37b16-2362">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2362">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2363">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2363">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2364">В следующем примере кода отправляет и получает сообщение, содержащее заказ в и из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2364">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="37b16-2365">Он специально запрашивает положительного подтверждения в случае, когда исходное сообщение достигает или извлечено из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2365">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2366">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2366">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2367">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2367">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2368">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2368">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-2369">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2369">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2370">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2370">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2371">Получает сообщение, которое соответствует заданному идентификатору корреляции (из транзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2371">Receives the message that matches the given correlation identifier (from a transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2372">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2372">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2373">Этот метод ищет в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2373">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2374">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2374">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="37b16-2375">В противном случае сообщение удаляется из очереди и возвращается в приложение с помощью контекста внутренней транзакции, определенного `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2375">Otherwise, the message is removed from the queue and returned to the application using the internal transaction context defined by the `transaction` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2376">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2376">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2377">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2377">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2378"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2378">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-2379">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2379">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2380"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2380">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-2381">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2381">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2382"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2382">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2383">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2383">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="37b16-2384">Так как <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2384">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2385">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2385">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2386">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2386">Workgroup mode</span></span>|<span data-ttu-id="37b16-2387">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2387">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2388">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2388">Local computer</span></span>|<span data-ttu-id="37b16-2389">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2389">Yes</span></span>|  
|<span data-ttu-id="37b16-2390">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2390">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2391">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2391">Yes</span></span>|  
|<span data-ttu-id="37b16-2392">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2392">Remote computer</span></span>|<span data-ttu-id="37b16-2393">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2393">No</span></span>|  
|<span data-ttu-id="37b16-2394">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2394">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2395">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2395">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2396">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2396">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#14](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#14)]
 [!code-csharp[MessageQueue2#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2397">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2397">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="37b16-2398">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2398">-or-</span></span> 
<span data-ttu-id="37b16-2399">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2399">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2400">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2400">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2401">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2401">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="37b16-2402">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2402">-or-</span></span> 
<span data-ttu-id="37b16-2403">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2403">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-2404">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2404">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2405">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2405">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2406">Получает сообщение, которое соответствует заданному идентификатору корреляции, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2406">Receives the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2407">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2407">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2408">Этот метод ищет в очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2408">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2409">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2409">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="37b16-2410">В противном случае сообщение удаляется из очереди и возвращается в приложение с помощью контекста транзакции, определенного `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2410">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2411">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2411">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2412">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2412">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2413">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2413">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2414">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2414">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2415">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2415">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2416"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2416">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-2417">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2417">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2418"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2418">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-2419">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2419">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2420"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2420">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2421">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2421">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="37b16-2422">Так как <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2422">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2423">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2423">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2424">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2424">Workgroup mode</span></span>|<span data-ttu-id="37b16-2425">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2425">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2426">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2426">Local computer</span></span>|<span data-ttu-id="37b16-2427">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2427">Yes</span></span>|  
|<span data-ttu-id="37b16-2428">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2428">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2429">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2429">Yes</span></span>|  
|<span data-ttu-id="37b16-2430">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2430">Remote computer</span></span>|<span data-ttu-id="37b16-2431">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2431">No</span></span>|  
|<span data-ttu-id="37b16-2432">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2432">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2433">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2433">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2434">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2434">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#11](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#11)]
 [!code-csharp[MessageQueue2#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2435">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2435">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2436">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2436">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2437">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2437">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2438">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2438">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-2439">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2439">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-2440">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2440">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="37b16-2441">Получает сообщение, которое соответствует заданному идентификатору корреляции (из нетранзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2441">Receives the message that matches the given correlation identifier (from a non-transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2442">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2442">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2443">Этот метод ищет в нетранзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2443">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2444">Этот метод возвращает немедленно, если сообщение с идентификатором корреляции, указанным `correlationId` параметр находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2444">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue.</span></span> <span data-ttu-id="37b16-2445">В противном случае метод ожидает в течение заданного периода времени прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2445">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="37b16-2446">Если новое сообщение не поступило до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2446">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-2447">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2447">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-2448">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2448">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2449">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, соответствует ли `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2449">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2450">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2450">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-2451">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2451">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2452"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2452">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-2453">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2453">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2454"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2454">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-2455">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2455">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2456"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2456">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2457">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2457">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2458">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2458">Workgroup mode</span></span>|<span data-ttu-id="37b16-2459">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2459">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2460">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2460">Local computer</span></span>|<span data-ttu-id="37b16-2461">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2461">Yes</span></span>|  
|<span data-ttu-id="37b16-2462">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2462">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2463">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2463">Yes</span></span>|  
|<span data-ttu-id="37b16-2464">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2464">Remote computer</span></span>|<span data-ttu-id="37b16-2465">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2465">No</span></span>|  
|<span data-ttu-id="37b16-2466">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2466">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2467">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2467">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2468">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2468">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#10](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#10)]
 [!code-csharp[MessageQueue2#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2469">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2469">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2470">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2470">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2471">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="37b16-2471">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2472">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2472">-or-</span></span> 
<span data-ttu-id="37b16-2473">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2473">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-2474">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2474">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-2475">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2475">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2476">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2476">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2477">Получает сообщение, которое соответствует заданному идентификатору корреляции (из транзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2477">Receives the message that matches the given correlation identifier (from a transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2478">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2478">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2479">Этот метод ищет в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2479">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2480">Этот метод возвращает немедленно, если сообщение с идентификатором корреляции, указанным `correlationId` параметр находится в очереди, используя внутреннюю транзакцию контексте, определенном `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2480">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="37b16-2481">В противном случае метод ожидает в течение заданного периода времени прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2481">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="37b16-2482">Если новое сообщение не поступило до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2482">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-2483">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2483">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-2484">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2484">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2485">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, соответствует ли `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2485">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2486">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2486">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-2487">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2487">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2488">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2488">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2489">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2489">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2490"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2490">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-2491">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2491">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2492"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2492">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-2493">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2493">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2494"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2494">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2495">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2495">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="37b16-2496">Так как <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2496">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2497">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2497">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2498">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2498">Workgroup mode</span></span>|<span data-ttu-id="37b16-2499">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2499">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2500">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2500">Local computer</span></span>|<span data-ttu-id="37b16-2501">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2501">Yes</span></span>|  
|<span data-ttu-id="37b16-2502">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2502">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2503">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2503">Yes</span></span>|  
|<span data-ttu-id="37b16-2504">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2504">Remote computer</span></span>|<span data-ttu-id="37b16-2505">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2505">No</span></span>|  
|<span data-ttu-id="37b16-2506">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2506">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2507">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2507">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2508">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2508">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#13](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#13)]
 [!code-csharp[MessageQueue2#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2509">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2509">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="37b16-2510">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2510">-or-</span></span> 
<span data-ttu-id="37b16-2511">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2511">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2512">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2512">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2513">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="37b16-2513">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2514">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2514">-or-</span></span> 
<span data-ttu-id="37b16-2515">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2515">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="37b16-2516">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2516">-or-</span></span> 
<span data-ttu-id="37b16-2517">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByCorrelationId : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByCorrelationId (correlationId, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="37b16-2518">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2518">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-2519">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2519">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2520">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2520">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2521">Получает сообщение, которое соответствует заданному идентификатору корреляции и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2521">Receives the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2522">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2522">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2523">Этот метод ищет в очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2523">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2524">Этот метод возвращает немедленно, если сообщение с идентификатором корреляции, указанным `correlationId` параметр находится в очереди, используя контекст транзакции, определяемый `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2524">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="37b16-2525">В противном случае метод ожидает в течение заданного периода времени прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2525">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="37b16-2526">Если новое сообщение не поступило до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2526">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-2527">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2527">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-2528">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2528">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2529">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, соответствует ли `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2529">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2530">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2530">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-2531">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2531">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span> <span data-ttu-id="37b16-2532">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2532">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2533">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2533">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2534">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2534">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2535">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2535">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2536">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2536">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2537"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь, чтобы связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2537">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="37b16-2538">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2538">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2539"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для получения сообщения, указав свой уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="37b16-2539">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="37b16-2540">Чтобы прочитать сообщение с указанным идентификатором корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2540">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2541"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2541">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2542">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2542">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="37b16-2543">Так как <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2543">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2544">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2544">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2545">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2545">Workgroup mode</span></span>|<span data-ttu-id="37b16-2546">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2546">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2547">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2547">Local computer</span></span>|<span data-ttu-id="37b16-2548">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2548">Yes</span></span>|  
|<span data-ttu-id="37b16-2549">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2549">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2550">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2550">Yes</span></span>|  
|<span data-ttu-id="37b16-2551">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2551">Remote computer</span></span>|<span data-ttu-id="37b16-2552">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2552">No</span></span>|  
|<span data-ttu-id="37b16-2553">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2553">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2554">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2554">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2555">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2555">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#12](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#12)]
 [!code-csharp[MessageQueue2#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2556">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2556">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2557">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2557">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2558">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2558">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2559">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2559">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2560">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="37b16-2560">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2561">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2561">-or-</span></span> 
<span data-ttu-id="37b16-2562">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2562">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-2563">Получает сообщение, которое соответствует заданному идентификатору, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2563">Receives the message that matches the given identifier, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById id" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-2564">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2564">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="37b16-2565">Получает из нетранзакционной очереди сообщение, которое соответствует заданному идентификатору, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="37b16-2565">Receives the message that matches the given identifier from a non-transactional queue and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2566">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2566">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2567">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2567">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="37b16-2568">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2568">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2569"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2569">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2570">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2570">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2571"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для извлечения подтверждения, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2571">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2572">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2572">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2573"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2573">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2574">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2574">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2575">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2575">Workgroup mode</span></span>|<span data-ttu-id="37b16-2576">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2576">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2577">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2577">Local computer</span></span>|<span data-ttu-id="37b16-2578">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2578">Yes</span></span>|  
|<span data-ttu-id="37b16-2579">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2579">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2580">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2580">Yes</span></span>|  
|<span data-ttu-id="37b16-2581">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2581">Remote computer</span></span>|<span data-ttu-id="37b16-2582">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2582">No</span></span>|  
|<span data-ttu-id="37b16-2583">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2583">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2584">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2584">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2585">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2585">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#16](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#16)]
 [!code-csharp[MessageQueue2#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2586">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2586">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2587">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2587">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2588">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2588">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-2589">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2589">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2590">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2590">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2591">Получает сообщение, которое соответствует заданному идентификатору (из транзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="37b16-2591">Receives the message that matches the given identifier (from a transactional queue) and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2592">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2592">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2593">Используйте этот метод для чтения сообщения с известным идентификатором и удаляет его из очереди, используя внутреннюю транзакцию контексте, определенном `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2593">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="37b16-2594">Этот метод создает исключение сразу в очереди нет сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-2594">This method throws an exception immediately if the message is not in the queue</span></span>  
  
 <span data-ttu-id="37b16-2595"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2595">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2596">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2596">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2597">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2597">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2598">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2598">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2599"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для извлечения подтверждения, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2599">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2600">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2600">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2601"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2601">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2602">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2602">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="37b16-2603">Так как <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2603">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2604">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2604">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2605">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2605">Workgroup mode</span></span>|<span data-ttu-id="37b16-2606">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2606">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2607">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2607">Local computer</span></span>|<span data-ttu-id="37b16-2608">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2608">Yes</span></span>|  
|<span data-ttu-id="37b16-2609">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2609">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2610">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2610">Yes</span></span>|  
|<span data-ttu-id="37b16-2611">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2611">Remote computer</span></span>|<span data-ttu-id="37b16-2612">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2612">No</span></span>|  
|<span data-ttu-id="37b16-2613">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2613">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2614">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2614">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2615">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2615">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#17](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#17)]
 [!code-csharp[MessageQueue2#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2616">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2616">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="37b16-2617">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2617">-or-</span></span> 
<span data-ttu-id="37b16-2618">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2618">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2619">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2619">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2620">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2620">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="37b16-2621">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2621">-or-</span></span> 
<span data-ttu-id="37b16-2622">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2622">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-2623">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2623">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2624">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2624">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2625">Получает сообщение, которое соответствует заданному идентификатору, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="37b16-2625">Receives the message that matches the given identifier and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2626">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2626">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2627">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2627">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="37b16-2628">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2628">This method throws an exception immediately if the message is not in the queue.</span></span> <span data-ttu-id="37b16-2629">В противном случае сообщение удаляется из очереди и возвращается в приложение с помощью контекста транзакции, определенного `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2629">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2630">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2630">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2631">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2631">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2632">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2632">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2633"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2633">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="37b16-2634">Если сообщение с указанным идентификатором находится в очереди, не связанную с данным <xref:System.Messaging.MessageQueue> экземпляра, сообщение не будет найден.</span><span class="sxs-lookup"><span data-stu-id="37b16-2634">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="37b16-2635">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2635">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2636">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2636">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2637">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2637">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2638"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для извлечения подтверждения, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2638">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2639">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2639">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2640"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2640">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2641">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2641">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="37b16-2642">Так как <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2642">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2643">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2643">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2644">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2644">Workgroup mode</span></span>|<span data-ttu-id="37b16-2645">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2645">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2646">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2646">Local computer</span></span>|<span data-ttu-id="37b16-2647">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2647">Yes</span></span>|  
|<span data-ttu-id="37b16-2648">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2648">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2649">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2649">Yes</span></span>|  
|<span data-ttu-id="37b16-2650">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2650">Remote computer</span></span>|<span data-ttu-id="37b16-2651">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2651">No</span></span>|  
|<span data-ttu-id="37b16-2652">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2652">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2653">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2653">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2654">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2654">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#15](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#15)]
 [!code-csharp[MessageQueue2#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2655">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2655">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2656">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2656">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2657">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2657">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2658">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2658">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-2659">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2659">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-2660">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2660">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="37b16-2661">Получает сообщение, которое соответствует заданному идентификатору (из нетранзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2661">Receives the message that matches the given identifier (from a non-transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2662">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2662">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2663">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2663">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="37b16-2664">Этот метод возвращает немедленно, если сообщение с идентификатором, указанным `id` параметр находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2664">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="37b16-2665">В противном случае метод ожидает в течение заданного периода времени прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2665">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="37b16-2666">Если новое сообщение не поступило до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2666">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-2667">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2667">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-2668">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2668">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2669">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, соответствует ли `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2669">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="37b16-2670">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2670">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-2671">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2671">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2672"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2672">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2673">Используйте эту перегрузку <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> при это допустимо для текущего потока блокируются до тех пор, пока новый сообщения продолжают поступать в очереди до истечения времени ожидания, заданные `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2673">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2674">Поток будет заблокирован для по крайней мере заданного периода времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра, или если новые сообщения продолжают поступать в очереди в течение периода времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="37b16-2674">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2675">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2675">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2676"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для извлечения подтверждения, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2676">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2677">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2677">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2678"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2678">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2679">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2679">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2680">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2680">Workgroup mode</span></span>|<span data-ttu-id="37b16-2681">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2681">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2682">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2682">Local computer</span></span>|<span data-ttu-id="37b16-2683">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2683">Yes</span></span>|  
|<span data-ttu-id="37b16-2684">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2684">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2685">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2685">Yes</span></span>|  
|<span data-ttu-id="37b16-2686">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2686">Remote computer</span></span>|<span data-ttu-id="37b16-2687">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2687">No</span></span>|  
|<span data-ttu-id="37b16-2688">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2688">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2689">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2689">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2690">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2690">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#20](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#20)]
 [!code-csharp[MessageQueue2#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2691">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2691">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2692">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2692">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2693">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2693">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2694">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2694">-or-</span></span> 
<span data-ttu-id="37b16-2695">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2695">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-2696">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2696">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-2697">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2697">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2698">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2698">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2699">Получает сообщение, которое соответствует заданному идентификатору (из транзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2699">Receives the message that matches the given identifier (from a transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2700">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2700">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2701">Используйте этот метод для чтения сообщения с известным идентификатором и удаляет его из очереди, используя внутреннюю транзакцию контексте, определенном `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2701">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="37b16-2702">Этот метод возвращает немедленно, если сообщение с идентификатором, указанным `id` параметр находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2702">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="37b16-2703">В противном случае метод ожидает в течение заданного периода времени прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2703">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="37b16-2704">Если новое сообщение не поступило до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2704">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-2705">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2705">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-2706">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2706">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2707">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, соответствует ли `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2707">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="37b16-2708">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2708">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-2709">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2709">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2710"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2710">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2711">Используйте эту перегрузку <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> при это допустимо для текущего потока блокируются до тех пор, пока новый сообщения продолжают поступать в очереди до истечения времени ожидания, заданные `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2711">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2712">Поток будет заблокирован для по крайней мере заданного периода времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра, или если новые сообщения продолжают поступать в очереди в течение указанного периода времени ожидания `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="37b16-2712">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the timeout period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2713">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2713">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2714">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2714">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2715">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2715">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2716"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для извлечения подтверждения, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2716">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2717">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2717">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2718"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается одно и то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2718">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2719">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2719">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="37b16-2720">Так как <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2720">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2721">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2721">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2722">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2722">Workgroup mode</span></span>|<span data-ttu-id="37b16-2723">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2723">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2724">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2724">Local computer</span></span>|<span data-ttu-id="37b16-2725">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2725">Yes</span></span>|  
|<span data-ttu-id="37b16-2726">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2726">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2727">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2727">Yes</span></span>|  
|<span data-ttu-id="37b16-2728">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2728">Remote computer</span></span>|<span data-ttu-id="37b16-2729">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2729">No</span></span>|  
|<span data-ttu-id="37b16-2730">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2730">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2731">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2731">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2732">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2732">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#18](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#18)]
 [!code-csharp[MessageQueue2#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2733">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2733">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="37b16-2734">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2734">-or-</span></span> 
<span data-ttu-id="37b16-2735">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2735">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2736">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2736">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2737">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2737">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2738">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2738">-or-</span></span> 
<span data-ttu-id="37b16-2739">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2739">The queue is non-transactional.</span></span>  
  
<span data-ttu-id="37b16-2740">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2740">-or-</span></span> 
<span data-ttu-id="37b16-2741">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2741">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveById : string * TimeSpan * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveById (id, timeout, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="37b16-2742">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2742">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="37b16-2743">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="37b16-2743">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2744">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2744">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2745">Получает сообщение, которое соответствует заданному идентификатору, и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="37b16-2745">Receives the message that matches the given identifier and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="37b16-2746">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2746">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2747">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2747">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="37b16-2748">Этот метод возвращает немедленно, если сообщение с идентификатором, указанным `id` параметр находится в очереди, используя контекст транзакции, определяемый `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2748">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="37b16-2749">В противном случае метод ожидает в течение заданного периода времени прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2749">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="37b16-2750">Если новое сообщение не поступило до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="37b16-2750">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="37b16-2751">`timeout` Параметр задает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="37b16-2751">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="37b16-2752">Вместо этого он задает время ожидания нового сообщения поступление в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2752">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="37b16-2753">Каждый раз при поступлении нового сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, соответствует ли `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2753">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="37b16-2754">В противном случае этот метод запускает ожидания через и ожидает прихода нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2754">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="37b16-2755">Таким образом, если новые сообщения продолжают поступать до истечения времени ожидания, существует возможность продолжать выполняться неопределенно долго, пока не истечет период ожидания без либо новых сообщений или до получения сообщения, этот метод <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2755">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2756">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2756">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2757">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2757">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2758">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2758">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2759"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным на предприятии очереди сообщений, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2759">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="37b16-2760">Если сообщение с указанным идентификатором находится в очереди, не связанную с данным <xref:System.Messaging.MessageQueue> экземпляра, сообщение не будет найден.</span><span class="sxs-lookup"><span data-stu-id="37b16-2760">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="37b16-2761">Используйте эту перегрузку <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> при это допустимо для текущего потока блокируются до тех пор, пока новый сообщения продолжают поступать в очереди до истечения времени ожидания, заданные `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2761">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="37b16-2762">Поток будет заблокирован для по крайней мере заданного периода времени, или не ограничено, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра, или если новые сообщения продолжают поступать в очереди в течение периода времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="37b16-2762">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2763">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2763">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2764">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2764">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2765">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2765">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="37b16-2766"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для извлечения подтверждения, отчета или сообщение ответа, генерируемые приложением, которое был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2766">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2767">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2767">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="37b16-2768"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2768">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="37b16-2769">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2769">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="37b16-2770">Так как <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2770">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2771">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2771">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2772">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2772">Workgroup mode</span></span>|<span data-ttu-id="37b16-2773">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2773">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2774">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2774">Local computer</span></span>|<span data-ttu-id="37b16-2775">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2775">Yes</span></span>|  
|<span data-ttu-id="37b16-2776">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2776">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2777">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2777">Yes</span></span>|  
|<span data-ttu-id="37b16-2778">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2778">Remote computer</span></span>|<span data-ttu-id="37b16-2779">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2779">No</span></span>|  
|<span data-ttu-id="37b16-2780">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2780">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2781">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2781">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2782">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2782">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#19](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#19)]
 [!code-csharp[MessageQueue2#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-2783">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2783">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-2784">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2784">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2785">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="37b16-2785">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
<span data-ttu-id="37b16-2786">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2786">-or-</span></span> 
<span data-ttu-id="37b16-2787">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2787">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2788">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2788">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-2789">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2789">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-2790">Получает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2790">Receives a specific message from the queue.</span></span> <span data-ttu-id="37b16-2791">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2791">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(long lookupId);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : int64 -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId lookupId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="37b16-2792">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2792">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="37b16-2793">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2793">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-2794">Получает сообщение, соответствующее заданному идентификатору просмотра, из нетранзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2794">Receives the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2795">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.LookupId" /> которого соответствует переданному в объект параметру <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2795">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2796">Используйте этот метод для чтения сообщения с известным кодом просмотра и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2796">Use this method to read a message with a known lookup identifier and remove it from the queue.</span></span> <span data-ttu-id="37b16-2797">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2797">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2798"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди где находится сообщение, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2798">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2799">Чтобы прочитать сообщение с указанным кодом просмотра, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2799">To read a message with a specified lookup identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="37b16-2800">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2800">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2801">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2801">Workgroup mode</span></span>|<span data-ttu-id="37b16-2802">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2802">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2803">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2803">Local computer</span></span>|<span data-ttu-id="37b16-2804">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2804">Yes</span></span>|  
|<span data-ttu-id="37b16-2805">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2805">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2806">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2806">Yes</span></span>|  
|<span data-ttu-id="37b16-2807">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2807">Remote computer</span></span>|<span data-ttu-id="37b16-2808">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2808">No</span></span>|  
|<span data-ttu-id="37b16-2809">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2809">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2810">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2810">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="37b16-2811">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-2811">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2812">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2812">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2813">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2813">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransaction -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="37b16-2814">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2814">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="37b16-2815">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="37b16-2815">Specify one of the following:</span></span> 
 <span data-ttu-id="37b16-2816"><see langword="MessageLookupAction.Current" />: получает сообщение, заданное параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2816"><see langword="MessageLookupAction.Current" />: Receives the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="37b16-2817"><see langword="MessageLookupAction.Next" />: получает сообщение, следующее за сообщением, заданным параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2817"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="37b16-2818"><see langword="MessageLookupAction.Previous" />: получает сообщение, предшествующее сообщению, заданному параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2818"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="37b16-2819"><see langword="MessageLookupAction.First" />: получает первое сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2819"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="37b16-2820">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2820">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="37b16-2821"><see langword="MessageLookupAction.Last" />: получает последнее сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2821"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="37b16-2822">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2822">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="37b16-2823">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2823">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="37b16-2824">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2824">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2825">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2825">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2826">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2826">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-2827">Получает конкретное сообщение из транзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2827">Receives a specific message from a transactional queue.</span></span> <span data-ttu-id="37b16-2828">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2828">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2829">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="lookupId" /> и <paramref name="action" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2829">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="lookupId" /> and <paramref name="action" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2830">Используйте этот метод для чтения сообщения с известным кодом просмотра и удаляет его из очереди, используя контекст транзакции, определяемый `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2830">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="37b16-2831">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2831">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2832"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди где находится сообщение, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2832">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2833">Так как этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2833">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2834">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2834">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2835">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2835">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="37b16-2836">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2836">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="37b16-2837">Так как <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2837">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2838">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2838">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2839">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2839">Workgroup mode</span></span>|<span data-ttu-id="37b16-2840">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2840">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2841">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2841">Local computer</span></span>|<span data-ttu-id="37b16-2842">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2842">Yes</span></span>|  
|<span data-ttu-id="37b16-2843">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2843">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2844">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2844">Yes</span></span>|  
|<span data-ttu-id="37b16-2845">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2845">Remote computer</span></span>|<span data-ttu-id="37b16-2846">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2846">No</span></span>|  
|<span data-ttu-id="37b16-2847">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2847">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2848">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2848">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="37b16-2849">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-2849">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2850">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2850">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2851">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2851">An error occurred when accessing a Message Queuing method.</span></span>  
  
<span data-ttu-id="37b16-2852">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2852">-or-</span></span> 
<span data-ttu-id="37b16-2853">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="37b16-2853">The queue is non-transactional.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2854">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2854">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.ReceiveByLookupId : System.Messaging.MessageLookupAction * int64 * System.Messaging.MessageQueueTransactionType -&gt; System.Messaging.Message" Usage="messageQueue.ReceiveByLookupId (action, lookupId, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="lookupId" Type="System.Int64" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="37b16-2855">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2855">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="37b16-2856">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="37b16-2856">Specify one of the following:</span></span> 
 <span data-ttu-id="37b16-2857"><see langword="MessageLookupAction.Current" />: получает сообщение, заданное параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2857"><see langword="MessageLookupAction.Current" />: Receives the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="37b16-2858"><see langword="MessageLookupAction.Next" />: получает сообщение, следующее за сообщением, заданным параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2858"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="37b16-2859"><see langword="MessageLookupAction.Previous" />: получает сообщение, предшествующее сообщению, заданному параметром <paramref name="lookupId" />, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2859"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <paramref name="lookupId" /> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="37b16-2860"><see langword="MessageLookupAction.First" />: получает первое сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2860"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="37b16-2861">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2861">The <paramref name="lookupId" /> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="37b16-2862"><see langword="MessageLookupAction.Last" />: получает последнее сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2862"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="37b16-2863">Параметр <paramref name="lookupId" /> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2863">The <paramref name="lookupId" /> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="37b16-2864">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2864">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="37b16-2865">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2865">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-2866">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-2866">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-2867">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="37b16-2867">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="37b16-2868">Получает из очереди определенное сообщение, используя заданный контекст транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2868">Receives a specific message from the queue, using the specified transaction context.</span></span> <span data-ttu-id="37b16-2869">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2869">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="37b16-2870">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="action" /> и <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2870">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2871">Используйте этот метод для чтения сообщения с известным кодом просмотра и удаляет его из очереди, используя контекст транзакции, определяемый `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2871">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="37b16-2872">Этот метод немедленно создает исключение, если в очереди нет сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2872">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2873"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди где находится сообщение, поэтому будет существовать не более одного сообщения в очереди, которое соответствует заданной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2873">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="37b16-2874">Чтобы прочитать сообщение с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="37b16-2874">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="37b16-2875">Контекст отсутствует транзакции, связанные с сообщением, возвращенный вызовом к <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2875">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="37b16-2876">Так как <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> удаляет сообщения из очереди, отсутствует необходимость отменять обратно в том случае, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="37b16-2876">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="37b16-2877">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2877">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="37b16-2878">Укажите `Single` Если вы хотите получать сообщения в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2878">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-2879">Можно указать `None` Если вы хотите получить сообщение из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-2879">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="37b16-2880">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращаться в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="37b16-2880">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="37b16-2881">Сообщение не удаляется без возможности восстановления из очереди, пока транзакция фиксируется.</span><span class="sxs-lookup"><span data-stu-id="37b16-2881">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="37b16-2882">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2882">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2883">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2883">Workgroup mode</span></span>|<span data-ttu-id="37b16-2884">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2884">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2885">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2885">Local computer</span></span>|<span data-ttu-id="37b16-2886">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2886">Yes</span></span>|  
|<span data-ttu-id="37b16-2887">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2887">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2888">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2888">Yes</span></span>|  
|<span data-ttu-id="37b16-2889">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2889">Remote computer</span></span>|<span data-ttu-id="37b16-2890">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2890">No</span></span>|  
|<span data-ttu-id="37b16-2891">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2891">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2892">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2892">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="37b16-2893">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-2893">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="37b16-2894">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2894">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2895">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2895">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-2896">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2896">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span>  
  
<span data-ttu-id="37b16-2897">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2897">-or-</span></span> 
<span data-ttu-id="37b16-2898">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2898">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ReceiveCompleted As ReceiveCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::ReceiveCompletedEventHandler ^ ReceiveCompleted;" />
      <MemberSignature Language="F#" Value="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " Usage="member this.ReceiveCompleted : System.Messaging.ReceiveCompletedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReceiveCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.ReceiveCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-2899">Происходит, если сообщение было удалено из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2899">Occurs when a message has been removed from the queue.</span></span> <span data-ttu-id="37b16-2900">Это событие инициируется асинхронной операцией, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2900">This event is raised by the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2901"><xref:System.Messaging.MessageQueue.BeginReceive%2A> используется при асинхронной обработке, чтобы вызвать <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2901"><xref:System.Messaging.MessageQueue.BeginReceive%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="37b16-2902"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> используется для завершения операции, инициированной вызовом <xref:System.Messaging.MessageQueue.BeginReceive%2A> и просмотра сообщения при <xref:System.Messaging.MessageQueue.ReceiveCompleted> события.</span><span class="sxs-lookup"><span data-stu-id="37b16-2902"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> and peek the message when the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="37b16-2903">При создании делегата <xref:System.Messaging.ReceiveCompletedEventHandler> необходимо указать метод, обрабатывающий событие.</span><span class="sxs-lookup"><span data-stu-id="37b16-2903">When you create a <xref:System.Messaging.ReceiveCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="37b16-2904">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="37b16-2904">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="37b16-2905">Обработчик событий вызывается всякий раз, когда происходит событие, если делегат не удален.</span><span class="sxs-lookup"><span data-stu-id="37b16-2905">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="37b16-2906">Дополнительные сведения о делегатов обработчиков событий, см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="37b16-2906">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2907">В следующем примере кода создается обработчик событий с именем `MyReceiveCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.ReceiveCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginReceive%2A> инициировать асинхронную операцию получения для очереди, находится по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="37b16-2907">The following code example creates an event handler named `MyReceiveCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> to initiate an asynchronous receive operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="37b16-2908">Когда <xref:System.Messaging.MessageQueue.ReceiveCompleted> события, получает сообщение в примере и выводит его текст на экран.</span><span class="sxs-lookup"><span data-stu-id="37b16-2908">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the example receives the message and writes its body to the screen.</span></span> <span data-ttu-id="37b16-2909">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginReceive%2A> еще раз, чтобы начать новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2909">The example then calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> again to initiate a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CPP/mqreceivecompletedeventhandler.cpp#1)]
 [!code-csharp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CS/mqreceivecompletedeventhandler.cs#1)]
 [!code-vb[MessageQueue.ReceiveCompleted#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/VB/mqreceivecompletedeventhandler.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Refresh">
      <MemberSignature Language="C#" Value="public void Refresh ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Refresh() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Refresh" />
      <MemberSignature Language="VB.NET" Value="Public Sub Refresh ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Refresh();" />
      <MemberSignature Language="F#" Value="member this.Refresh : unit -&gt; unit" Usage="messageQueue.Refresh " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-2910">Обновляет свойства, представленные объектом <see cref="T:System.Messaging.MessageQueue" /> для отражения текущего состояния ресурса.</span><span class="sxs-lookup"><span data-stu-id="37b16-2910">Refreshes the properties presented by the <see cref="T:System.Messaging.MessageQueue" /> to reflect the current state of the resource.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2911"><xref:System.Messaging.MessageQueue.Refresh%2A> синхронизирует свойства <xref:System.Messaging.MessageQueue> с его связанный ресурс очереди сообщений сервера.</span><span class="sxs-lookup"><span data-stu-id="37b16-2911"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronizes the properties of a <xref:System.Messaging.MessageQueue> with its associated Message Queuing server resource.</span></span> <span data-ttu-id="37b16-2912">Если любое свойство, такие как <xref:System.Messaging.MessageQueue.Label%2A> или <xref:System.Messaging.MessageQueue.Category%2A>, был изменен на сервере с момента отправки <xref:System.Messaging.MessageQueue> был создан, <xref:System.Messaging.MessageQueue.Refresh%2A> обновления <xref:System.Messaging.MessageQueue> новыми данными.</span><span class="sxs-lookup"><span data-stu-id="37b16-2912">If any property, such as <xref:System.Messaging.MessageQueue.Label%2A> or <xref:System.Messaging.MessageQueue.Category%2A>, has changed on the server since the time the <xref:System.Messaging.MessageQueue> was created, <xref:System.Messaging.MessageQueue.Refresh%2A> updates the <xref:System.Messaging.MessageQueue> with the new information.</span></span>  
  
 <span data-ttu-id="37b16-2913">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2913">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2914">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2914">Workgroup mode</span></span>|<span data-ttu-id="37b16-2915">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2915">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2916">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2916">Local computer</span></span>|<span data-ttu-id="37b16-2917">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2917">Yes</span></span>|  
|<span data-ttu-id="37b16-2918">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2918">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2919">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2919">Yes</span></span>|  
|<span data-ttu-id="37b16-2920">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2920">Remote computer</span></span>|<span data-ttu-id="37b16-2921">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2921">No</span></span>|  
|<span data-ttu-id="37b16-2922">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2922">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2923">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2923">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2924">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Refresh%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2924">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Refresh%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#28](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#28)]
 [!code-csharp[MessageQueue2#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ResetPermissions">
      <MemberSignature Language="C#" Value="public void ResetPermissions ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetPermissions() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ResetPermissions" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetPermissions ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetPermissions();" />
      <MemberSignature Language="F#" Value="member this.ResetPermissions : unit -&gt; unit" Usage="messageQueue.ResetPermissions " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="37b16-2925">Присваивает списку разрешений значения по умолчанию операционной системы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2925">Resets the permission list to the operating system's default values.</span></span> <span data-ttu-id="37b16-2926">Удаляет все разрешения очередей, добавленные в список по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="37b16-2926">Removes any queue permissions you have appended to the default list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2927">При вызове <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, вернуть в список разрешений значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="37b16-2927">When you call <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, you return the permission list to its default values.</span></span> <span data-ttu-id="37b16-2928">Как правило, это предоставляет создатель очереди все разрешения и позволяет группе всем пользователям следующие права:</span><span class="sxs-lookup"><span data-stu-id="37b16-2928">Generally, this grants the queue creator all permissions, and gives the group Everyone the following rights:</span></span>  
  
-   <span data-ttu-id="37b16-2929">Получение свойств очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2929">Get the properties of the queue.</span></span>  
  
-   <span data-ttu-id="37b16-2930">Получение разрешений очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2930">Get queue permissions.</span></span>  
  
-   <span data-ttu-id="37b16-2931">Запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2931">Write to the queue.</span></span>  
  
 <span data-ttu-id="37b16-2932">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2932">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2933">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2933">Workgroup mode</span></span>|<span data-ttu-id="37b16-2934">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2934">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2935">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2935">Local computer</span></span>|<span data-ttu-id="37b16-2936">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2936">Yes</span></span>|  
|<span data-ttu-id="37b16-2937">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2937">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2938">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2938">Yes</span></span>|  
|<span data-ttu-id="37b16-2939">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2939">Remote computer</span></span>|<span data-ttu-id="37b16-2940">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2940">No</span></span>|  
|<span data-ttu-id="37b16-2941">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2941">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2942">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2942">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2943">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2943">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#27](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#27)]
 [!code-csharp[MessageQueue2#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2944">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2944">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Send">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-2945">Отправляет объект в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2945">Sends an object to a queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj);" />
      <MemberSignature Language="F#" Value="member this.Send : obj -&gt; unit" Usage="messageQueue.Send obj" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="37b16-2946">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2946">The object to send to the queue.</span></span></param>
        <summary><span data-ttu-id="37b16-2947">Отправляет объект в нетранзакционную очередь, на которую ссылается этот класс <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2947">Sends an object to non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2948">Используйте этот перегруженный метод для отправки сообщения, которое содержит `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2948">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-2949">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="37b16-2949">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="37b16-2950">Если отправлять любые объекты, отличные от <xref:System.Messaging.Message>, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2950">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="37b16-2951">Если эта перегрузка используется для отправки сообщения в транзакционную очередь, сообщение будет отправлено в очередь недоставленных.</span><span class="sxs-lookup"><span data-stu-id="37b16-2951">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="37b16-2952">Сообщение как часть транзакции, содержащей другие сообщения, используйте перегрузку, принимающую <xref:System.Messaging.MessageQueueTransaction> или <xref:System.Messaging.MessageQueueTransactionType> как параметр.</span><span class="sxs-lookup"><span data-stu-id="37b16-2952">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="37b16-2953">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2953">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="37b16-2954"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любому объекту, отличное от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2954">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="37b16-2955">Если указать, например, метку или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются к любое сообщение, содержащее объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2955">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="37b16-2956">При отправке <xref:System.Messaging.Message>, значения свойства, заданные для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-2956">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="37b16-2957">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2957">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2958">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2958">Workgroup mode</span></span>|<span data-ttu-id="37b16-2959">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2959">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2960">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2960">Local computer</span></span>|<span data-ttu-id="37b16-2961">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2961">Yes</span></span>|  
|<span data-ttu-id="37b16-2962">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2962">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2963">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2963">Yes</span></span>|  
|<span data-ttu-id="37b16-2964">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2964">Remote computer</span></span>|<span data-ttu-id="37b16-2965">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2965">No</span></span>|  
|<span data-ttu-id="37b16-2966">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2966">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2967">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2967">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2968">В следующем примере кода подключается к очереди сообщений и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2968">The following code example connects to a message queue and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_obj#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_obj/CPP/mqsend_generic.cpp#1)]
 [!code-csharp[MessageQueue.Send_obj#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_obj/CS/mqsend_generic.cs#1)]
 [!code-vb[MessageQueue.Send_obj#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_obj/VB/mqsend_generic.vb#1)]  
  
 <span data-ttu-id="37b16-2969">В следующем примере кода отправляет, определяемые приложением `Order` класса в очередь, а затем получает сообщения из этой очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2969">The following code example sends an application-defined `Order` class to a queue and then receives a message from that queue.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-2970">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-2970">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="37b16-2971">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-2971">-or-</span></span> 
<span data-ttu-id="37b16-2972">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-2972">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="37b16-2973">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2973">The object to send to the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-2974">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2974">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-2975">Отправляет объект в транзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-2975">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-2976">Используйте этот перегруженный метод для отправки сообщения, которое содержит `obj` параметр в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста внутренней транзакции определяется `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-2976">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="37b16-2977">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="37b16-2977">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="37b16-2978">Если отправлять любые объекты, отличные от <xref:System.Messaging.Message>, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2978">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="37b16-2979">Если эта перегрузка используется для отправки сообщения в нетранзакционную очередь, сообщения могут быть отправлены в очередь недоставленных сообщений-без создания исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-2979">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="37b16-2980">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2980">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="37b16-2981"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любому объекту, отличное от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2981">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="37b16-2982">Если указать, например, метку или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются к любое сообщение, содержащее объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-2982">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="37b16-2983">При отправке <xref:System.Messaging.Message>, значения свойства, заданные для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-2983">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="37b16-2984"><xref:System.Messaging.MessageQueueTransaction> такое потоковая обработка с поддержкой, поэтому, если состояние апартамента — `STA`, нельзя использовать транзакции в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="37b16-2984"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="37b16-2985">Visual Basic устанавливает состояние основного потока для `STA`, поэтому необходимо применить <xref:System.MTAThreadAttribute> в `Main` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2985">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="37b16-2986">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="37b16-2986">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="37b16-2987">Можно применить <xref:System.MTAThreadAttribute> , используя следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="37b16-2987">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="37b16-2988">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-2988">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-2989">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-2989">Workgroup mode</span></span>|<span data-ttu-id="37b16-2990">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-2990">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-2991">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2991">Local computer</span></span>|<span data-ttu-id="37b16-2992">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2992">Yes</span></span>|  
|<span data-ttu-id="37b16-2993">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2993">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-2994">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2994">Yes</span></span>|  
|<span data-ttu-id="37b16-2995">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-2995">Remote computer</span></span>|<span data-ttu-id="37b16-2996">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-2996">No</span></span>|  
|<span data-ttu-id="37b16-2997">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-2997">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-2998">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-2998">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-2999">В следующем примере кода отправляет строку в транзакционную очередь, а затем получает сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-2999">The following code example sends a string to a transactional queue and then receives a message from that queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CPP/mqsend_objtransaction.cpp#1)]
 [!code-csharp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CS/mqsend_objtransaction.cs#1)]
 [!code-vb[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/VB/mqsend_objtransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-3000">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3000">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3001">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-3001">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="37b16-3002">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3002">-or-</span></span> 
<span data-ttu-id="37b16-3003">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-3003">The Message Queuing application indicated an incorrect transaction use.</span></span>  
  
<span data-ttu-id="37b16-3004">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3004">-or-</span></span> 
<span data-ttu-id="37b16-3005">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3005">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="37b16-3006">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3006">The object to send to the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-3007">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-3007">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-3008">Отправляет объект в очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3008">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3009">Используйте этот перегруженный метод для отправки сообщения, которое содержит `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста транзакции, определенного `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3009">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="37b16-3010">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3010">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="37b16-3011">Укажите `Single` Если вы хотите отправить сообщение как одна внутренняя транзакция.</span><span class="sxs-lookup"><span data-stu-id="37b16-3011">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-3012">Можно указать `None` Чтобы отправить транзакционное сообщение в нетранзакционный поток.</span><span class="sxs-lookup"><span data-stu-id="37b16-3012">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="37b16-3013">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="37b16-3013">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="37b16-3014">Если отправлять любые объекты, отличные от <xref:System.Messaging.Message>, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3014">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="37b16-3015">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3015">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="37b16-3016"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любому объекту, отличное от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3016">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="37b16-3017">Если указать, например, метку или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются к любое сообщение, содержащее объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3017">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="37b16-3018">При отправке <xref:System.Messaging.Message>, значения свойства, заданные для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-3018">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="37b16-3019">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3019">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3020">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3020">Workgroup mode</span></span>|<span data-ttu-id="37b16-3021">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3021">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3022">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3022">Local computer</span></span>|<span data-ttu-id="37b16-3023">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3023">Yes</span></span>|  
|<span data-ttu-id="37b16-3024">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3024">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3025">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3025">Yes</span></span>|  
|<span data-ttu-id="37b16-3026">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3026">Remote computer</span></span>|<span data-ttu-id="37b16-3027">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3027">No</span></span>|  
|<span data-ttu-id="37b16-3028">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3028">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3029">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3029">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3030">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3030">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#2)]
 [!code-csharp[MessageQueue2#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-3031">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3031">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3032">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-3032">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="37b16-3033">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3033">-or-</span></span> 
<span data-ttu-id="37b16-3034">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3034">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string -&gt; unit" Usage="messageQueue.Send (obj, label)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="37b16-3035">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3035">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="37b16-3036">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3036">The label of the message.</span></span></param>
        <summary><span data-ttu-id="37b16-3037">Отправляет объект в нетранзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3037">Sends an object to the non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3038">Используйте этот перегруженный метод для отправки сообщения, которое содержит `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3038">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="37b16-3039">С помощью этой перегрузки можно указать строку метки, которое обозначает сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-3039">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="37b16-3040">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message>, структура, объект данных или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="37b16-3040">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="37b16-3041">Если отправлять любые объекты, отличные от <xref:System.Messaging.Message>, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3041">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="37b16-3042">Метка сообщения отличается от метки очереди сообщений, но оба зависят от приложения и не имеют внутреннего смысла для Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-3042">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="37b16-3043">Если эта перегрузка используется для отправки сообщения в транзакционную очередь, сообщение будет отправлено в очередь недоставленных.</span><span class="sxs-lookup"><span data-stu-id="37b16-3043">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="37b16-3044">Сообщение как часть транзакции, содержащей другие сообщения, используйте перегрузку, принимающую <xref:System.Messaging.MessageQueueTransaction> или <xref:System.Messaging.MessageQueueTransactionType> как параметр.</span><span class="sxs-lookup"><span data-stu-id="37b16-3044">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="37b16-3045"><xref:System.Messaging.MessageQueue.Path%2A> Свойство для данного <xref:System.Messaging.MessageQueue> должен указываться перед отправкой сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3045">The <xref:System.Messaging.MessageQueue.Path%2A> property for this <xref:System.Messaging.MessageQueue> instance must be specified before you send the message.</span></span> <span data-ttu-id="37b16-3046">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3046">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="37b16-3047"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любому объекту, отличное от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3047">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="37b16-3048">Если указать, например, метку или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются к любое сообщение, содержащее объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3048">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="37b16-3049">При отправке <xref:System.Messaging.Message>, значения свойства, заданные для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-3049">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="37b16-3050">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3050">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3051">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3051">Workgroup mode</span></span>|<span data-ttu-id="37b16-3052">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3052">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3053">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3053">Local computer</span></span>|<span data-ttu-id="37b16-3054">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3054">Yes</span></span>|  
|<span data-ttu-id="37b16-3055">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3055">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3056">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3056">Yes</span></span>|  
|<span data-ttu-id="37b16-3057">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3057">Remote computer</span></span>|<span data-ttu-id="37b16-3058">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3058">No</span></span>|  
|<span data-ttu-id="37b16-3059">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3059">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3060">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3060">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3061">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3061">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue2#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-3062">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3062">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3063">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-3063">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="37b16-3064">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3064">-or-</span></span> 
<span data-ttu-id="37b16-3065">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3065">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransaction -&gt; unit" Usage="messageQueue.Send (obj, label, transaction)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="37b16-3066">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3066">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="37b16-3067">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3067">The label of the message.</span></span></param>
        <param name="transaction"><span data-ttu-id="37b16-3068">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3068">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="37b16-3069">Отправляет объект в транзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3069">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3070">Используйте этот перегруженный метод для отправки сообщения, которое содержит `obj` параметр в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста внутренней транзакции определяется `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3070">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="37b16-3071">С помощью этой перегрузки можно указать строку метки, которое обозначает сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-3071">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="37b16-3072">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message>, структура, объект данных или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="37b16-3072">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="37b16-3073">Если отправлять любые объекты, отличные от <xref:System.Messaging.Message>, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3073">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="37b16-3074">Метка сообщения отличается от метки очереди сообщений, но оба зависят от приложения и не имеют внутреннего смысла для Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-3074">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="37b16-3075">Если эта перегрузка используется для отправки сообщения в нетранзакционную очередь, сообщения могут быть отправлены в очередь недоставленных сообщений-без создания исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3075">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="37b16-3076">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3076">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="37b16-3077"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любому объекту, отличное от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3077">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="37b16-3078">Если указать, например, метку или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются к любое сообщение, содержащее объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3078">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="37b16-3079">При отправке <xref:System.Messaging.Message>, значения свойства, заданные для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство</span><span class="sxs-lookup"><span data-stu-id="37b16-3079">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property</span></span>  
  
 <span data-ttu-id="37b16-3080"><xref:System.Messaging.MessageQueueTransaction> такое потоковая обработка с поддержкой, поэтому, если состояние апартамента — `STA`, нельзя использовать транзакции в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="37b16-3080"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="37b16-3081">Visual Basic устанавливает состояние основного потока для `STA`, поэтому необходимо применить <xref:System.MTAThreadAttribute> в `Main` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3081">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="37b16-3082">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3082">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="37b16-3083">Можно применить <xref:System.MTAThreadAttribute> , используя следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="37b16-3083">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="37b16-3084">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3084">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3085">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3085">Workgroup mode</span></span>|<span data-ttu-id="37b16-3086">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3086">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3087">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3087">Local computer</span></span>|<span data-ttu-id="37b16-3088">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3088">Yes</span></span>|  
|<span data-ttu-id="37b16-3089">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3089">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3090">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3090">Yes</span></span>|  
|<span data-ttu-id="37b16-3091">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3091">Remote computer</span></span>|<span data-ttu-id="37b16-3092">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3092">No</span></span>|  
|<span data-ttu-id="37b16-3093">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3093">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3094">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3094">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3095">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3095">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#4](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#4)]
 [!code-csharp[MessageQueue2#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-3096">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3096">The <paramref name="label" /> parameter is <see langword="null" />.</span></span>  
  
<span data-ttu-id="37b16-3097">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3097">-or-</span></span> 
<span data-ttu-id="37b16-3098">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3098">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3099">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-3099">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="37b16-3100">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3100">-or-</span></span> 
<span data-ttu-id="37b16-3101">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-3101">The Message Queuing application indicated an incorrect transaction usage.</span></span>  
  
<span data-ttu-id="37b16-3102">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3102">-or-</span></span> 
<span data-ttu-id="37b16-3103">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3103">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="F#" Value="member this.Send : obj * string * System.Messaging.MessageQueueTransactionType -&gt; unit" Usage="messageQueue.Send (obj, label, transactionType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="37b16-3104">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3104">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="37b16-3105">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3105">The label of the message.</span></span></param>
        <param name="transactionType"><span data-ttu-id="37b16-3106">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="37b16-3106">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="37b16-3107">Отправляет объект в очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3107">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3108">Используйте этот перегруженный метод для отправки сообщения, которое содержит `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста транзакции, определенного `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3108">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="37b16-3109">Укажите `Automatic` для `transactionType` параметра, если уже имеется контекст внешней транзакции, присоединенный к потоку, который вы хотите использовать для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3109">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="37b16-3110">Укажите `Single` Если вы хотите отправить сообщение как одна внутренняя транзакция.</span><span class="sxs-lookup"><span data-stu-id="37b16-3110">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="37b16-3111">Можно указать `None` Чтобы отправить транзакционное сообщение в нетранзакционный поток.</span><span class="sxs-lookup"><span data-stu-id="37b16-3111">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="37b16-3112">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="37b16-3112">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="37b16-3113">Если отправлять любые объекты, отличные от <xref:System.Messaging.Message>, объект сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3113">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span> <span data-ttu-id="37b16-3114">С помощью этой перегрузки можно указать строку метки, которое обозначает сообщение.</span><span class="sxs-lookup"><span data-stu-id="37b16-3114">With this overload, you can specify the string label that identifies the message.</span></span>  
  
 <span data-ttu-id="37b16-3115">Метка сообщения отличается от метки очереди сообщений, но оба зависят от приложения и не имеют внутреннего смысла для Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-3115">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="37b16-3116">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3116">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="37b16-3117"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любому объекту, отличное от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3117">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="37b16-3118">Если указать, например, метку или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются к любое сообщение, содержащее объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3118">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="37b16-3119">При отправке <xref:System.Messaging.Message>, значения свойства, заданные для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>и сообщения <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойство имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-3119">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="37b16-3120">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3120">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3121">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3121">Workgroup mode</span></span>|<span data-ttu-id="37b16-3122">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3122">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3123">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3123">Local computer</span></span>|<span data-ttu-id="37b16-3124">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3124">Yes</span></span>|  
|<span data-ttu-id="37b16-3125">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3125">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3126">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3126">Yes</span></span>|  
|<span data-ttu-id="37b16-3127">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3127">Remote computer</span></span>|<span data-ttu-id="37b16-3128">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3128">No</span></span>|  
|<span data-ttu-id="37b16-3129">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3129">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3130">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3130">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3131">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3131">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#3](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#3)]
 [!code-csharp[MessageQueue2#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="37b16-3132">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3132">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueTransaction"><span data-ttu-id="37b16-3133">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-3133">The Message Queuing application indicated an incorrect transaction usage.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="37b16-3134">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3134">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3135">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="37b16-3135">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
<span data-ttu-id="37b16-3136">-или-</span><span class="sxs-lookup"><span data-stu-id="37b16-3136">-or-</span></span> 
<span data-ttu-id="37b16-3137">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3137">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetPermissions">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="37b16-3138">Добавляет разрешения в текущий набор.</span><span class="sxs-lookup"><span data-stu-id="37b16-3138">Adds permissions to the current set.</span></span> <span data-ttu-id="37b16-3139">Это позволяет контролировать, кто имеет права доступа к свойствам очереди и сообщениям в очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-3139">This controls who has access rights to queue properties and messages in the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.AccessControlList dacl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.AccessControlList dacl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.AccessControlList)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (dacl As AccessControlList)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::AccessControlList ^ dacl);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.AccessControlList -&gt; unit" Usage="messageQueue.SetPermissions dacl" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dacl" Type="System.Messaging.AccessControlList" />
      </Parameters>
      <Docs>
        <param name="dacl"><span data-ttu-id="37b16-3140">Объект <see cref="T:System.Messaging.AccessControlList" />, содержащий не менее одного элемента управления доступом, в которых указаны доверенные лица и предоставляемые разрешения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3140">A <see cref="T:System.Messaging.AccessControlList" /> that contains one or more access control entries that specify the trustees and the permissions to grant.</span></span></param>
        <summary><span data-ttu-id="37b16-3141">Назначает права доступа к очереди на основе содержимого списка управления доступом.</span><span class="sxs-lookup"><span data-stu-id="37b16-3141">Assigns access rights to the queue based on the contents of an access control list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3142">Используйте этот перегруженный метод для предоставления, запрета или отмены права с помощью коллекции элементов управления доступом для указания доверенного лица и сведения о разрешениях.</span><span class="sxs-lookup"><span data-stu-id="37b16-3142">Use this overload to grant, deny, or revoke rights by using a collection of access control entries to specify trustee and permissions information.</span></span> <span data-ttu-id="37b16-3143">Это используется, например, для предоставления разрешений нескольким пользователям одновременно.</span><span class="sxs-lookup"><span data-stu-id="37b16-3143">This is used, for example, to grant permissions to multiple users at the same time.</span></span>  
  
 <span data-ttu-id="37b16-3144">Данное доверенное лицо, указывается при создании `ace` параметр может быть отдельного пользователя, группы пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3144">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="37b16-3145">Если данное доверенное лицо — это человек, используйте формат `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="37b16-3145">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="37b16-3146">Можно указать «.» для доверенного лица указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3146">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="37b16-3147">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="37b16-3147">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="37b16-3148">По умолчанию создатель общей или частной очереди имеет полный доступ, и группы домена, у всех есть разрешение на получение свойств очереди и получите разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3148">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="37b16-3149">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3149">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="37b16-3150">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="37b16-3150">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="37b16-3151">Запись запрещения доступа <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="37b16-3151">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="37b16-3152">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потоке явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-3152">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="37b16-3153">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="37b16-3153">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="37b16-3154">При построении `dacl` добавить параметр, <xref:System.Messaging.AccessControlEntry> экземпляры вашего <xref:System.Messaging.AccessControlList> коллекции.</span><span class="sxs-lookup"><span data-stu-id="37b16-3154">When you construct the `dacl` parameter, you add <xref:System.Messaging.AccessControlEntry> instances to your <xref:System.Messaging.AccessControlList> collection.</span></span> <span data-ttu-id="37b16-3155">При создании каждой записи управления доступом, можно указать универсальный и стандартные права доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-3155">When you construct each access control entry, you can specify generic or standard access rights.</span></span> <span data-ttu-id="37b16-3156">Права на очередь может быть любое сочетание следующих:</span><span class="sxs-lookup"><span data-stu-id="37b16-3156">The rights to a queue can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="37b16-3157">Удаление</span><span class="sxs-lookup"><span data-stu-id="37b16-3157">Delete</span></span>  
  
-   <span data-ttu-id="37b16-3158">Чтение параметров безопасности</span><span class="sxs-lookup"><span data-stu-id="37b16-3158">Read Security</span></span>  
  
-   <span data-ttu-id="37b16-3159">Записи безопасности</span><span class="sxs-lookup"><span data-stu-id="37b16-3159">Write Security</span></span>  
  
-   <span data-ttu-id="37b16-3160">Синхронизация</span><span class="sxs-lookup"><span data-stu-id="37b16-3160">Synchronize</span></span>  
  
-   <span data-ttu-id="37b16-3161">Изменить владельца</span><span class="sxs-lookup"><span data-stu-id="37b16-3161">Modify Owner</span></span>  
  
-   <span data-ttu-id="37b16-3162">Чтение</span><span class="sxs-lookup"><span data-stu-id="37b16-3162">Read</span></span>  
  
-   <span data-ttu-id="37b16-3163">Write</span><span class="sxs-lookup"><span data-stu-id="37b16-3163">Write</span></span>  
  
-   <span data-ttu-id="37b16-3164">Выполнение</span><span class="sxs-lookup"><span data-stu-id="37b16-3164">Execute</span></span>  
  
-   <span data-ttu-id="37b16-3165">Обязательно</span><span class="sxs-lookup"><span data-stu-id="37b16-3165">Required</span></span>  
  
-   <span data-ttu-id="37b16-3166">Все</span><span class="sxs-lookup"><span data-stu-id="37b16-3166">All</span></span>  
  
-   <span data-ttu-id="37b16-3167">None</span><span class="sxs-lookup"><span data-stu-id="37b16-3167">None</span></span>  
  
 <span data-ttu-id="37b16-3168">Эти права представляют собой набор битовых флагов, которые можно комбинировать с помощью побитового оператора OR.</span><span class="sxs-lookup"><span data-stu-id="37b16-3168">These rights are a set of bit flags that you can combine using the OR bitwise operator.</span></span>  
  
-   <span data-ttu-id="37b16-3169">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="37b16-3169">Full Control</span></span>  
  
-   <span data-ttu-id="37b16-3170">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="37b16-3170">Delete Message</span></span>  
  
-   <span data-ttu-id="37b16-3171">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="37b16-3171">Receive Message</span></span>  
  
-   <span data-ttu-id="37b16-3172">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3172">Peek Message</span></span>  
  
-   <span data-ttu-id="37b16-3173">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-3173">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="37b16-3174">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3174">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3175">Задание свойств очередей</span><span class="sxs-lookup"><span data-stu-id="37b16-3175">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3176">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3176">Get Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3177">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3177">Set Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3178">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3178">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="37b16-3179">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3179">Write Message</span></span>  
  
 <span data-ttu-id="37b16-3180">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3180">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3181">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3181">Workgroup mode</span></span>|<span data-ttu-id="37b16-3182">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3182">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3183">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3183">Local computer</span></span>|<span data-ttu-id="37b16-3184">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3184">Yes</span></span>|  
|<span data-ttu-id="37b16-3185">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3185">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3186">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3186">Yes</span></span>|  
|<span data-ttu-id="37b16-3187">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3187">Remote computer</span></span>|<span data-ttu-id="37b16-3188">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3188">No</span></span>|  
|<span data-ttu-id="37b16-3189">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3189">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3190">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3190">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3191">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3191">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span></span>      
  
 [!code-cpp[MessageQueue2#26](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#26)]
 [!code-csharp[MessageQueue2#26](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#26)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3192">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3192">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.AccessControlList" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.MessageQueueAccessControlEntry ace);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.MessageQueueAccessControlEntry ace) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.MessageQueueAccessControlEntry)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (ace As MessageQueueAccessControlEntry)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::MessageQueueAccessControlEntry ^ ace);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : System.Messaging.MessageQueueAccessControlEntry -&gt; unit" Usage="messageQueue.SetPermissions ace" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ace" Type="System.Messaging.MessageQueueAccessControlEntry" />
      </Parameters>
      <Docs>
        <param name="ace"><span data-ttu-id="37b16-3193">Объект <see cref="T:System.Messaging.MessageQueueAccessControlEntry" />, который указывает пользователя, тип доступа и тип разрешения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3193">A <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> that specifies a user, an access type, and a permission type.</span></span></param>
        <summary><span data-ttu-id="37b16-3194">Назначает права доступа к очереди на основе содержимого элемента управления доступом.</span><span class="sxs-lookup"><span data-stu-id="37b16-3194">Assigns access rights to the queue based on the contents of an access control entry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3195">Используйте этот перегруженный метод для предоставления, запрета или отмены права с помощью записи управления доступом для указания доверенного лица и сведения о правах.</span><span class="sxs-lookup"><span data-stu-id="37b16-3195">Use this overload to grant, deny, or revoke rights by using an access control entry to specify trustee and rights information.</span></span>  
  
 <span data-ttu-id="37b16-3196">Данное доверенное лицо, указывается при создании `ace` параметр может быть отдельного пользователя, группы пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3196">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="37b16-3197">Если данное доверенное лицо — это человек, используйте формат `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="37b16-3197">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="37b16-3198">Можно указать «.» для доверенного лица указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3198">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="37b16-3199">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="37b16-3199">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="37b16-3200">По умолчанию создатель общей или частной очереди имеет полный доступ, и группы домена, у всех есть разрешение на получение свойств очереди и получите разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3200">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="37b16-3201">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3201">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="37b16-3202">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="37b16-3202">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="37b16-3203">Запись запрещения доступа <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="37b16-3203">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="37b16-3204">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потоке явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-3204">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="37b16-3205">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="37b16-3205">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="37b16-3206">Права на очередь, которая задается в `rights` при построении вашего <xref:System.Messaging.MessageQueueAccessControlEntry>, может быть любым сочетанием следующих:</span><span class="sxs-lookup"><span data-stu-id="37b16-3206">The rights to a queue, which you specify in the `rights` parameter when you construct your <xref:System.Messaging.MessageQueueAccessControlEntry>, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="37b16-3207">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="37b16-3207">Full Control</span></span>  
  
-   <span data-ttu-id="37b16-3208">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="37b16-3208">Delete Message</span></span>  
  
-   <span data-ttu-id="37b16-3209">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="37b16-3209">Receive Message</span></span>  
  
-   <span data-ttu-id="37b16-3210">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3210">Peek Message</span></span>  
  
-   <span data-ttu-id="37b16-3211">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-3211">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="37b16-3212">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3212">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3213">Задание свойств очередей</span><span class="sxs-lookup"><span data-stu-id="37b16-3213">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3214">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3214">Get Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3215">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3215">Set Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3216">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3216">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="37b16-3217">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3217">Write Message</span></span>  
  
 <span data-ttu-id="37b16-3218">`rights` Параметр, укажите в конструкторе для `ace` параметр является флагом <xref:System.Messaging.MessageQueueAccessRights> перечисления.</span><span class="sxs-lookup"><span data-stu-id="37b16-3218">The `rights` parameter you specify in the constructor for the `ace` parameter is a flag of the <xref:System.Messaging.MessageQueueAccessRights> enumeration.</span></span> <span data-ttu-id="37b16-3219">Он представляет набор битовых флагов, которые можно комбинировать с помощью битового оператора или при построении `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3219">It represents a set of bit flags that you can combine using the bitwise operator OR when you build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="37b16-3220">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3220">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3221">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3221">Workgroup mode</span></span>|<span data-ttu-id="37b16-3222">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3222">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3223">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3223">Local computer</span></span>|<span data-ttu-id="37b16-3224">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3224">Yes</span></span>|  
|<span data-ttu-id="37b16-3225">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3225">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3226">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3226">Yes</span></span>|  
|<span data-ttu-id="37b16-3227">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3227">Remote computer</span></span>|<span data-ttu-id="37b16-3228">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3228">No</span></span>|  
|<span data-ttu-id="37b16-3229">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3229">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3230">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3230">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3231">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3231">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#24](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#24)]
 [!code-csharp[MessageQueue2#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3232">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3232">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.MessageQueueAccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights -&gt; unit" Usage="messageQueue.SetPermissions (user, rights)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="37b16-3233">Отдельный пользователь, группа или компьютер, которые получают дополнительные права на работу с очередью.</span><span class="sxs-lookup"><span data-stu-id="37b16-3233">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="37b16-3234">Объект <see cref="T:System.Messaging.MessageQueueAccessRights" />, который показывает набор прав на работу с очередью, которые назначаются службой очереди сообщений параметру <paramref name="user" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3234">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <paramref name="user" /> passed in.</span></span></param>
        <summary><span data-ttu-id="37b16-3235">Предоставляет компьютеру, группе или пользователю указанные права доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-3235">Gives a computer, group, or user the specified access rights.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3236">Используйте этот перегруженный метод, чтобы предоставить указанные права для отдельных пользователей.</span><span class="sxs-lookup"><span data-stu-id="37b16-3236">Use this overload to grant specified rights to an individual user.</span></span> <span data-ttu-id="37b16-3237">Это может быть любой допустимый доверенного лица, который включает в себя отдельных пользователей, групп пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3237">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="37b16-3238">Если пользователь — это человек, используйте формат `DOMAIN` \\ `user` для `user` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3238">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="37b16-3239">Можно указать «.» для `user` параметр, чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3239">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="37b16-3240">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="37b16-3240">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="37b16-3241">По умолчанию создатель общей или частной очереди имеет полный доступ, и группы домена, у всех есть разрешение на получение свойств очереди и получите разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3241">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="37b16-3242">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3242">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="37b16-3243">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="37b16-3243">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="37b16-3244">Запись запрещения доступа <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="37b16-3244">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="37b16-3245">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потоке явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-3245">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="37b16-3246">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="37b16-3246">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="37b16-3247">Права на очереди, указанные в `rights` параметр, может быть любое сочетание следующих:</span><span class="sxs-lookup"><span data-stu-id="37b16-3247">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="37b16-3248">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="37b16-3248">Full Control</span></span>  
  
-   <span data-ttu-id="37b16-3249">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="37b16-3249">Delete Message</span></span>  
  
-   <span data-ttu-id="37b16-3250">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="37b16-3250">Receive Message</span></span>  
  
-   <span data-ttu-id="37b16-3251">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3251">Peek Message</span></span>  
  
-   <span data-ttu-id="37b16-3252">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-3252">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="37b16-3253">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3253">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3254">Задание свойств очередей</span><span class="sxs-lookup"><span data-stu-id="37b16-3254">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3255">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3255">Get Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3256">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3256">Set Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3257">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3257">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="37b16-3258">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3258">Write Message</span></span>  
  
 <span data-ttu-id="37b16-3259"><xref:System.Messaging.MessageQueueAccessRights> Перечисление представляет набор битовых флагов, которые можно комбинировать с помощью битового оператора или для создания `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3259">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="37b16-3260">Эта перегрузка может предоставлять разрешения только; не удается отменить или запретить их.</span><span class="sxs-lookup"><span data-stu-id="37b16-3260">With this overload, you can only grant permissions; you cannot revoke or deny them.</span></span> <span data-ttu-id="37b16-3261">Необходимо использовать другую перегрузку явно предоставлять любые <xref:System.Messaging.AccessControlEntryType> отличное от `Allow`.</span><span class="sxs-lookup"><span data-stu-id="37b16-3261">You must use a different overload to explicitly grant any <xref:System.Messaging.AccessControlEntryType> other than `Allow`.</span></span>  
  
 <span data-ttu-id="37b16-3262">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3262">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3263">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3263">Workgroup mode</span></span>|<span data-ttu-id="37b16-3264">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3264">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3265">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3265">Local computer</span></span>|<span data-ttu-id="37b16-3266">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3266">Yes</span></span>|  
|<span data-ttu-id="37b16-3267">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3267">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3268">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3268">Yes</span></span>|  
|<span data-ttu-id="37b16-3269">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3269">Remote computer</span></span>|<span data-ttu-id="37b16-3270">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3270">No</span></span>|  
|<span data-ttu-id="37b16-3271">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3271">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3272">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3272">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3273">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3273">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#23](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#23)]
 [!code-csharp[MessageQueue2#23](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="37b16-3274">Значение параметра <paramref name="user" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3274">The <paramref name="user" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3275">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3275">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights, System.Messaging.AccessControlEntryType entryType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights, valuetype System.Messaging.AccessControlEntryType entryType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights,System.Messaging.AccessControlEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights, entryType As AccessControlEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights, System::Messaging::AccessControlEntryType entryType);" />
      <MemberSignature Language="F#" Value="member this.SetPermissions : string * System.Messaging.MessageQueueAccessRights * System.Messaging.AccessControlEntryType -&gt; unit" Usage="messageQueue.SetPermissions (user, rights, entryType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
        <Parameter Name="entryType" Type="System.Messaging.AccessControlEntryType" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="37b16-3276">Отдельный пользователь, группа или компьютер, которые получают дополнительные права на работу с очередью.</span><span class="sxs-lookup"><span data-stu-id="37b16-3276">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="37b16-3277">Объект <see cref="T:System.Messaging.MessageQueueAccessRights" />, который показывает набор прав на работу с очередью, которые назначаются службой очереди сообщений параметру <paramref name="user" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3277">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <paramref name="user" /> passed in.</span></span></param>
        <param name="entryType"><span data-ttu-id="37b16-3278">Объект <see cref="T:System.Messaging.AccessControlEntryType" />, который указывает, нужно ли предоставить разрешения, отказать в предоставлении разрешений или отозвать разрешения, задаваемые параметром <paramref name="rights" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3278">A <see cref="T:System.Messaging.AccessControlEntryType" /> that specifies whether to grant, deny, or revoke the permissions specified by the <paramref name="rights" /> parameter.</span></span></param>
        <summary><span data-ttu-id="37b16-3279">Предоставляет компьютеру, группе или пользователю указанные права доступа указанного типа управления доступом (разрешить, отказать, отозвать или задать).</span><span class="sxs-lookup"><span data-stu-id="37b16-3279">Gives a computer, group, or user the specified access rights, with the specified access control type (allow, deny, revoke, or set).</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3280">Используйте этот перегруженный метод для предоставления, запрещения или отозвать указанные права для отдельного пользователя.</span><span class="sxs-lookup"><span data-stu-id="37b16-3280">Use this overload to grant, deny, or revoke specified rights for an individual user.</span></span> <span data-ttu-id="37b16-3281">Это может быть любой допустимый доверенного лица, который включает в себя отдельных пользователей, групп пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3281">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="37b16-3282">Если пользователь — это человек, используйте формат `DOMAIN` \\ `user` для `user` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3282">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="37b16-3283">Можно указать «.» для `user` параметр, чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="37b16-3283">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="37b16-3284">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="37b16-3284">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="37b16-3285">По умолчанию создатель общей или частной очереди имеет полный доступ, и группы домена, у всех есть разрешение на получение свойств очереди и получите разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3285">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="37b16-3286">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3286">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="37b16-3287">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="37b16-3287">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="37b16-3288">Запись запрещения доступа <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="37b16-3288">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="37b16-3289">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потоке явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="37b16-3289">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="37b16-3290">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены, и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="37b16-3290">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="37b16-3291">Права на очереди, указанные в `rights` параметр, может быть любое сочетание следующих:</span><span class="sxs-lookup"><span data-stu-id="37b16-3291">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="37b16-3292">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="37b16-3292">Full Control</span></span>  
  
-   <span data-ttu-id="37b16-3293">Удалить сообщение</span><span class="sxs-lookup"><span data-stu-id="37b16-3293">Delete Message</span></span>  
  
-   <span data-ttu-id="37b16-3294">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="37b16-3294">Receive Message</span></span>  
  
-   <span data-ttu-id="37b16-3295">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3295">Peek Message</span></span>  
  
-   <span data-ttu-id="37b16-3296">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="37b16-3296">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="37b16-3297">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3297">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3298">Задание свойств очередей</span><span class="sxs-lookup"><span data-stu-id="37b16-3298">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="37b16-3299">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3299">Get Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3300">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="37b16-3300">Set Permissions</span></span>  
  
-   <span data-ttu-id="37b16-3301">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="37b16-3301">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="37b16-3302">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="37b16-3302">Write Message</span></span>  
  
 <span data-ttu-id="37b16-3303"><xref:System.Messaging.MessageQueueAccessRights> Перечисление представляет набор битовых флагов, которые можно комбинировать с помощью битового оператора или для создания `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="37b16-3303">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="37b16-3304">Следующая таблица показывает, доступен ли этот метод в режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3304">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3305">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3305">Workgroup mode</span></span>|<span data-ttu-id="37b16-3306">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3306">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3307">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3307">Local computer</span></span>|<span data-ttu-id="37b16-3308">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3308">Yes</span></span>|  
|<span data-ttu-id="37b16-3309">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3309">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3310">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3310">Yes</span></span>|  
|<span data-ttu-id="37b16-3311">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3311">Remote computer</span></span>|<span data-ttu-id="37b16-3312">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3312">No</span></span>|  
|<span data-ttu-id="37b16-3313">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3313">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3314">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3314">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3315">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3315">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#25](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#25)]
 [!code-csharp[MessageQueue2#25](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#25)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3316">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3316">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.AccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_SynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-3317">Получает или задает объект, который используется для маршалинга вызовов обработчика событий, возникающих в результате наступления события <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> или события <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3317">Gets or sets the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span></summary>
        <value><span data-ttu-id="37b16-3318">Объект <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, представляющий объект, который выполняет маршалинг вызова обработчика событий, причиной которого стало событие <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> или <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3318">A <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, which represents the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span> <span data-ttu-id="37b16-3319">Значение по умолчанию — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3319">The default is <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3320">Объект <xref:System.Messaging.MessageQueue.ReceiveCompleted> или <xref:System.Messaging.MessageQueue.PeekCompleted> событий полученный в результате <xref:System.Messaging.MessageQueue.BeginReceive%2A> или <xref:System.Messaging.MessageQueue.BeginPeek%2A> , запросив, соответственно, для определенного потока.</span><span class="sxs-lookup"><span data-stu-id="37b16-3320">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> or <xref:System.Messaging.MessageQueue.PeekCompleted> event results from a <xref:System.Messaging.MessageQueue.BeginReceive%2A> or <xref:System.Messaging.MessageQueue.BeginPeek%2A> request, respectively, to a specific thread.</span></span> <span data-ttu-id="37b16-3321">Как правило <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> задается при его связанный компонент помещается внутри элемента управления или формы, так как эти компоненты привязаны к определенному потоку.</span><span class="sxs-lookup"><span data-stu-id="37b16-3321">Typically, the <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> is set when its related component is placed inside a control or a form, because those components are bound to a specific thread.</span></span>  
  
 <span data-ttu-id="37b16-3322">Как правило синхронизирующий объект маршалирует вызов метода в один поток.</span><span class="sxs-lookup"><span data-stu-id="37b16-3322">Typically, the synchronizing object marshals a method call into a single thread.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Transactional">
      <MemberSignature Language="C#" Value="public bool Transactional { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Transactional" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Transactional" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transactional As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Transactional { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.Transactional : bool" Usage="System.Messaging.MessageQueue.Transactional" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_Transactional")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-3323">Получает значение, указывающее, принимает ли очередь только транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-3323">Gets a value that indicates whether the queue accepts only transactions.</span></span></summary>
        <value><span data-ttu-id="37b16-3324">Значение <see langword="true" />, если очередь принимает только сообщения, отправляемые как часть транзакции; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3324"><see langword="true" /> if the queue accepts only messages sent as part of a transaction; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3325">Обмен транзакционными сообщениями относится к объединению нескольких связанных сообщений в одну транзакцию.</span><span class="sxs-lookup"><span data-stu-id="37b16-3325">Transactional messaging refers to the coupling of several related messages into a single transaction.</span></span> <span data-ttu-id="37b16-3326">Отправка сообщений как часть транзакции гарантирует доставку сообщений в порядке, только один раз и успешно извлечено из очереди назначения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3326">Sending messages as part of a transaction ensures that the messages are delivered in order, delivered only once, and successfully retrieved from their destination queue.</span></span>  
  
 <span data-ttu-id="37b16-3327">Если очередь является транзакционной, он принимает только сообщения, отправляемые как часть транзакции.</span><span class="sxs-lookup"><span data-stu-id="37b16-3327">If a queue is transactional, it accepts only messages that are sent as part of a transaction.</span></span> <span data-ttu-id="37b16-3328">Тем не менее, отправлено или получено из очереди локальной транзакции без явным образом с помощью транзакций нетранзакционное сообщение <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, и <xref:System.Messaging.MessageQueueTransaction.Abort%2A> синтаксис.</span><span class="sxs-lookup"><span data-stu-id="37b16-3328">However, a non-transactional message can be sent or received from a local transaction queue without explicitly using transactional <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, and <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntax.</span></span> <span data-ttu-id="37b16-3329">Если нетранзакционное сообщение отправляется в транзакционную очередь, этот компонент создаст транзакцию одного сообщения для него, за исключением в случае обращение к очереди на удаленном компьютере, с помощью непосредственного имени формата.</span><span class="sxs-lookup"><span data-stu-id="37b16-3329">If a non-transactional message is sent to a transactional queue, this component creates a single-message transaction for it, except in the case of referencing a queue on a remote computer using a direct format name.</span></span> <span data-ttu-id="37b16-3330">В этом случае если вы не укажете контекст транзакции при отправке сообщения, он не создается автоматически, и это сообщение будет отправлено в очередь недоставленных.</span><span class="sxs-lookup"><span data-stu-id="37b16-3330">In this situation, if you do not specify a transaction context when sending a message, one is not created for you and the message will be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="37b16-3331">При отправке нетранзакционное сообщение в транзакционную очередь, вы не сможете откатить сообщение в случае возникновения исключения.</span><span class="sxs-lookup"><span data-stu-id="37b16-3331">If you send a non-transactional message to a transactional queue, you will not be able to roll back the message in the event of an exception.</span></span>  
  
 <span data-ttu-id="37b16-3332"><xref:System.Messaging.MessageQueueTransaction> такое потоковая обработка с поддержкой, поэтому, если состояние апартамента — `STA`, нельзя использовать транзакции в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="37b16-3332"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="37b16-3333">Visual Basic устанавливает состояние основного потока для `STA`, поэтому необходимо применить <xref:System.MTAThreadAttribute> в `Main` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3333">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="37b16-3334">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="37b16-3334">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="37b16-3335">Можно применить <xref:System.MTAThreadAttribute> , используя следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="37b16-3335">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="37b16-3336">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3336">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3337">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3337">Workgroup mode</span></span>|<span data-ttu-id="37b16-3338">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3338">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3339">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3339">Local computer</span></span>|<span data-ttu-id="37b16-3340">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3340">Yes</span></span>|  
|<span data-ttu-id="37b16-3341">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3341">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3342">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3342">Yes</span></span>|  
|<span data-ttu-id="37b16-3343">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3343">Remote computer</span></span>|<span data-ttu-id="37b16-3344">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3344">No</span></span>|  
|<span data-ttu-id="37b16-3345">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3345">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3346">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3346">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3347">В следующем примере кода отображает значение очередь сообщений <xref:System.Messaging.MessageQueue.Transactional%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-3347">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Transactional%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3348">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3348">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Begin" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Commit" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Abort" />
        <altmember cref="P:System.Messaging.Message.TransactionId" />
        <altmember cref="P:System.Messaging.Message.IsFirstInTransaction" />
        <altmember cref="P:System.Messaging.Message.IsLastInTransaction" />
      </Docs>
    </Member>
    <Member MemberName="UseJournalQueue">
      <MemberSignature Language="C#" Value="public bool UseJournalQueue { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool UseJournalQueue" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberSignature Language="VB.NET" Value="Public Property UseJournalQueue As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool UseJournalQueue { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.UseJournalQueue : bool with get, set" Usage="System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_UseJournalQueue")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-3349">Получает или задает значение, указывающее, должны ли полученные сообщения копироваться в очередь журнала.</span><span class="sxs-lookup"><span data-stu-id="37b16-3349">Gets or sets a value that indicates whether received messages are copied to the journal queue.</span></span></summary>
        <value><span data-ttu-id="37b16-3350">Значение <see langword="true" />, если сообщения, полученные из очереди, копируются в очередь журнала; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="37b16-3350"><see langword="true" /> if messages received from the queue are copied to its journal queue; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3351">Когда приложение Message Queuing создает новую очередь приложения, автоматически создает связанную очередь журнала в одном расположении.</span><span class="sxs-lookup"><span data-stu-id="37b16-3351">When the Message Queuing application creates a new application queue, it automatically creates an associated journal queue in the same location.</span></span> <span data-ttu-id="37b16-3352">В очередь журнала используется для отслеживания сообщений, удаленных из очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-3352">The journal queue is used to track the messages removed from a queue.</span></span> <span data-ttu-id="37b16-3353">Задание этого свойства изменяет очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="37b16-3353">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="37b16-3354">Таким образом, любой другой <xref:System.Messaging.MessageQueue> экземпляры будут затронуты данным изменением.</span><span class="sxs-lookup"><span data-stu-id="37b16-3354">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="37b16-3355">В очередь журнала не отслеживает сообщений, удаленных из очереди, так как время получения истечения, а также сообщения, удаленные из очереди с помощью службы каталогов очереди сообщений (Store сведения или Active Directory).</span><span class="sxs-lookup"><span data-stu-id="37b16-3355">The journal queue does not track messages removed from the queue because their time-to-be-received timer expired, nor does it track messages purged from the queue by using a Message Queuing directory service (Information Store or Active Directory).</span></span>  
  
 <span data-ttu-id="37b16-3356">Приложения не могут отправлять сообщения в очереди журнала; они ограничены доступ только для чтения этих очередей.</span><span class="sxs-lookup"><span data-stu-id="37b16-3356">Applications cannot send messages to journal queues; they are limited to read-only access of these queues.</span></span> <span data-ttu-id="37b16-3357">Кроме того Message Queuing никогда не удаляет сообщения из очереди журнала.</span><span class="sxs-lookup"><span data-stu-id="37b16-3357">Furthermore, Message Queuing never removes messages from journal queues.</span></span> <span data-ttu-id="37b16-3358">Приложение, использующее очередь необходимо очистить эти сообщения, их получения или очистка очереди.</span><span class="sxs-lookup"><span data-stu-id="37b16-3358">The application using the queue must clear these messages either by receiving them or by purging the queue.</span></span>  
  
 <span data-ttu-id="37b16-3359">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3359">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3360">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3360">Workgroup mode</span></span>|<span data-ttu-id="37b16-3361">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3361">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3362">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3362">Local computer</span></span>|<span data-ttu-id="37b16-3363">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3363">Yes</span></span>|  
|<span data-ttu-id="37b16-3364">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3364">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3365">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3365">Yes</span></span>|  
|<span data-ttu-id="37b16-3366">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3366">Remote computer</span></span>|<span data-ttu-id="37b16-3367">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3367">No</span></span>|  
|<span data-ttu-id="37b16-3368">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3368">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3369">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3369">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="37b16-3370">В следующем примере кода возвращает и задает значение очередь сообщений <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="37b16-3370">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3371">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="37b16-3371">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      </Docs>
    </Member>
    <Member MemberName="WriteHandle">
      <MemberSignature Language="C#" Value="public IntPtr WriteHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int WriteHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.WriteHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property WriteHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr WriteHandle { IntPtr get(); };" />
      <MemberSignature Language="F#" Value="member this.WriteHandle : nativeint" Usage="System.Messaging.MessageQueue.WriteHandle" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0;netframework-4.8">
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="37b16-3372">Получает собственный дескриптор, который используется для отправки сообщений в очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="37b16-3372">Gets the native handle used to send messages to the message queue.</span></span></summary>
        <value><span data-ttu-id="37b16-3373">Дескриптор собственного объекта очереди, который используется для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3373">A handle to the native queue object that you use for sending messages to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="37b16-3374"><xref:System.Messaging.MessageQueue.WriteHandle%2A> Предоставляет собственный дескриптор Windows для объекта очереди сообщений, который используется для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="37b16-3374">The <xref:System.Messaging.MessageQueue.WriteHandle%2A> provides a native Windows handle to the message queue object that is used for sending messages to the queue.</span></span> <span data-ttu-id="37b16-3375">Если вы измените путь к очереди, маркер закрыть и открыть с новым значением.</span><span class="sxs-lookup"><span data-stu-id="37b16-3375">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="37b16-3376">Следующая таблица показывает ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="37b16-3376">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="37b16-3377">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="37b16-3377">Workgroup mode</span></span>|<span data-ttu-id="37b16-3378">Доступно</span><span class="sxs-lookup"><span data-stu-id="37b16-3378">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="37b16-3379">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3379">Local computer</span></span>|<span data-ttu-id="37b16-3380">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3380">Yes</span></span>|  
|<span data-ttu-id="37b16-3381">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3381">Local computer and direct format name</span></span>|<span data-ttu-id="37b16-3382">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3382">Yes</span></span>|  
|<span data-ttu-id="37b16-3383">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="37b16-3383">Remote computer</span></span>|<span data-ttu-id="37b16-3384">Нет</span><span class="sxs-lookup"><span data-stu-id="37b16-3384">No</span></span>|  
|<span data-ttu-id="37b16-3385">Удаленный компьютер и непосредственное имя формата</span><span class="sxs-lookup"><span data-stu-id="37b16-3385">Remote computer and direct format name</span></span>|<span data-ttu-id="37b16-3386">Да</span><span class="sxs-lookup"><span data-stu-id="37b16-3386">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="37b16-3387">Очередь сообщений недоступна для записи.</span><span class="sxs-lookup"><span data-stu-id="37b16-3387">The message queue is not available for writing.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
  </Members>
</Type>